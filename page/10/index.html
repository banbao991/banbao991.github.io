<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/10/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-csharp/tds/04" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/07/csharp/tds/04/" class="article-date">
  <time class="dt-published" datetime="2021-10-07T14:26:08.000Z" itemprop="datePublished">2021-10-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/csharp-tds/">csharp.tds</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/10/07/csharp/tds/04/">C#程序设计.唐大仕.04.C#高级语言特性</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ul>
<li><a target="_blank" rel="noopener" href="https://www.icourse163.org/learn/PKU-1001663016">中国大学慕课</a></li>
</ul>
<h1 id="C-高级语言特性"><a href="#C-高级语言特性" class="headerlink" title="C#高级语言特性"></a>C#高级语言特性</h1><h2 id="1-委托"><a href="#1-委托" class="headerlink" title="1. 委托"></a>1. 委托</h2><ul>
<li>delegate</li>
<li>大致上：委托 $\approx$ 函数指针</li>
</ul>
<h3 id="委托是对函数原型的包装"><a href="#委托是对函数原型的包装" class="headerlink" title="委托是对函数原型的包装"></a>委托是对函数原型的包装</h3><ul>
<li>委托的声明</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">delegate</span> <span class="built_in">double</span> <span class="title">MyDelegate</span>(<span class="params"><span class="built_in">double</span> x</span>)</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>委托的实例化</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 可以是对象的某个方法, 也可以是类的某个静态方法</span></span><br><span class="line">MyDelegate d2 = <span class="keyword">new</span> MyDelegate(obj.myMethod);</span><br></pre></td></tr></table></figure>

<ul>
<li>委托的调用<ul>
<li>委托变量名(参数列表)</li>
</ul>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d2(<span class="number">8.9</span>);</span><br></pre></td></tr></table></figure>



<h3 id="一个例子"><a href="#一个例子" class="headerlink" title="一个例子"></a>一个例子</h3><ul>
<li><a href="/utils/show_code/index.html?csharp/tds/04/DelegateIntegral.cs">完整代码</a></li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明一个委托</span></span><br><span class="line"><span class="function"><span class="built_in">delegate</span> <span class="built_in">double</span> <span class="title">Fun</span>(<span class="params"><span class="built_in">double</span> x</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DelegateIntegral</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span> &#123;</span><br><span class="line">        <span class="comment">// 类的静态方法</span></span><br><span class="line">        Fun fun = <span class="keyword">new</span> Fun(Math.Sin);</span><br><span class="line">        <span class="built_in">double</span> d = Integral(fun, <span class="number">0</span>, Math.PI / <span class="number">2</span>, <span class="number">1e-4</span>);</span><br><span class="line">        Console.WriteLine(d);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 静态方法</span></span><br><span class="line">        Fun fun2 = <span class="keyword">new</span> Fun(Linear);</span><br><span class="line">        <span class="built_in">double</span> d2 = Integral(fun2, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1e-3</span>);</span><br><span class="line">        Console.WriteLine(d2);</span><br><span class="line"></span><br><span class="line">        Rnd rnd = <span class="keyword">new</span> Rnd();</span><br><span class="line">        <span class="comment">// 类的方法</span></span><br><span class="line">        <span class="built_in">double</span> d3 = Integral(<span class="keyword">new</span> Fun(rnd.Num), <span class="number">0</span>, <span class="number">1</span>, <span class="number">0.01</span>);</span><br><span class="line">        Console.WriteLine(d3);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">double</span> <span class="title">Linear</span>(<span class="params"><span class="built_in">double</span> a</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> a * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title">Rnd</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> Random r = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">double</span> <span class="title">Num</span>(<span class="params"><span class="built_in">double</span> x</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> r.NextDouble();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 积分计算</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">double</span> <span class="title">Integral</span>(<span class="params">Fun f, <span class="built_in">double</span> a, <span class="built_in">double</span> b, <span class="built_in">double</span> eps</span>)</span> &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        fa = f(a); <span class="comment">// 使用委托</span></span><br><span class="line">        fb = f(b);</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>C# 4 以上版本定义了很多的委托</li>
<li>例如</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 没有返回值, 封装的委托从 0 个参数到 16 个参数</span></span><br><span class="line"><span class="built_in">delegate</span> <span class="keyword">void</span> System.Action();</span><br><span class="line"><span class="built_in">delegate</span> <span class="keyword">void</span> System.Action&lt;<span class="keyword">in</span> T&gt; (T obj);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 有返回值, 封装的委托从 0 个参数到 16 个参数</span></span><br><span class="line"><span class="built_in">delegate</span> TResult System.Func&lt;<span class="keyword">in</span> T, <span class="keyword">out</span> TResult&gt;(T arg);</span><br></pre></td></tr></table></figure>

<ul>
<li>我们可以对上面的例子做如下修改<ul>
<li><a href="/utils/show_code/index.html?csharp/tds/04/DelegateIntegral_func.cs">完整代码</a></li>
</ul>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span> &#123;</span><br><span class="line">    Func&lt;<span class="built_in">double</span>, <span class="built_in">double</span>&gt; fun = <span class="keyword">new</span> Func&lt;<span class="built_in">double</span>, <span class="built_in">double</span>&gt;(Math.Sin);</span><br><span class="line">    <span class="built_in">double</span> d = Integral(fun, <span class="number">0</span>, Math.PI / <span class="number">2</span>, <span class="number">1e-4</span>);</span><br><span class="line">    Console.WriteLine(d);</span><br><span class="line"></span><br><span class="line">    Func&lt;<span class="built_in">double</span>, <span class="built_in">double</span>&gt; fun2 = <span class="keyword">new</span> Func&lt;<span class="built_in">double</span>, <span class="built_in">double</span>&gt;(Linear);</span><br><span class="line">    <span class="built_in">double</span> d2 = Integral(fun2, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1e-3</span>);</span><br><span class="line">    Console.WriteLine(d2);</span><br><span class="line"></span><br><span class="line">    Rnd rnd = <span class="keyword">new</span> Rnd();</span><br><span class="line">    <span class="built_in">double</span> d3 = Integral(<span class="keyword">new</span> Func&lt;<span class="built_in">double</span>, <span class="built_in">double</span>&gt;(rnd.Num), <span class="number">0</span>, <span class="number">1</span>, <span class="number">0.01</span>);</span><br><span class="line">    Console.WriteLine(d3);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">double</span> <span class="title">Integral</span>(<span class="params">Func&lt;<span class="built_in">double</span>, <span class="built_in">double</span>&gt; f, <span class="built_in">double</span> a, <span class="built_in">double</span> b, <span class="built_in">double</span> eps</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="委托的合并"><a href="#委托的合并" class="headerlink" title="委托的合并"></a>委托的合并</h3><ul>
<li>委托的合并—-多播MultiCastDelegate<ul>
<li>一个委托实例中可以 “包含” 多个函数</li>
<li>调用委托，就是调用其中多个函数</li>
<li><strong>多个函数间的先后顺序是没有意义的</strong></li>
<li>返回值也就没有太多意义</li>
</ul>
</li>
<li>运算符：<code>+</code> 、<code>-</code>、<code>+=</code>、<code>-=</code><ul>
<li>动态地增减其中的函数</li>
<li>提高了程序的灵活性</li>
</ul>
</li>
<li><a href="/utils/show_code/index.html?csharp/tds/04/DelegateMultiTest.cs">例子</a></li>
</ul>
<h3 id="委托的转换与相等"><a href="#委托的转换与相等" class="headerlink" title="委托的转换与相等"></a>委托的转换与相等</h3><ul>
<li><p>委托的转换</p>
<ul>
<li>按声明的名称判断</li>
<li>以下两个不能互相转换或加减</li>
</ul>
  <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="built_in">delegate</span> <span class="keyword">void</span> <span class="title">D</span>(<span class="params"><span class="built_in">int</span> a</span>)</span>;</span><br><span class="line"><span class="function"><span class="built_in">delegate</span> <span class="keyword">void</span> <span class="title">E</span>(<span class="params"><span class="built_in">int</span> a</span>)</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>委托的相等</p>
<ul>
<li>按内容（即其中“包含的函数”）来判断</li>
<li>有点点像两个<strong>字符串</strong>的 “相等” 与否的判断</li>
</ul>
</li>
<li><p>一些测试</p>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">D cd1 = <span class="keyword">new</span> D(C.M1);</span><br><span class="line">D cd2 = <span class="keyword">new</span> D(C.M1);</span><br><span class="line">D cd3 = <span class="literal">null</span>;</span><br><span class="line">cd3 += <span class="keyword">new</span> D(C.M1);</span><br><span class="line">D cd4 = <span class="keyword">new</span> D(C.M1) + <span class="keyword">new</span> D(C.M1);</span><br><span class="line">E cd5 = <span class="keyword">new</span> E(C.M1);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(cd1.Equals(cd2)); <span class="comment">// True</span></span><br><span class="line">Console.WriteLine(cd1.Equals(cd3)); <span class="comment">// True</span></span><br><span class="line">Console.WriteLine(cd1.Equals(cd4)); <span class="comment">// False</span></span><br><span class="line">Console.WriteLine(cd1.Equals(cd5)); <span class="comment">// False</span></span><br><span class="line"></span><br><span class="line">D cd6 = <span class="keyword">new</span> D(C.M1) + <span class="keyword">new</span> D(C.M2);</span><br><span class="line">D cd7 = <span class="keyword">new</span> D(C.M2) + <span class="keyword">new</span> D(C.M1);</span><br><span class="line">Console.WriteLine(cd6.Equals(cd7)); <span class="comment">// False</span></span><br></pre></td></tr></table></figure>



<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul>
<li>委托相当于函数指针</li>
<li>但它类型更安全，是<strong>引用类型</strong></li>
<li>且功能更强大，有<strong>多播功能</strong></li>
</ul>
<h2 id="2-事件"><a href="#2-事件" class="headerlink" title="2. 事件"></a>2. 事件</h2><ul>
<li>大致上：事件 $\approx$ 回调函数</li>
</ul>
<h3 id="GUI-中的事件"><a href="#GUI-中的事件" class="headerlink" title="GUI 中的事件"></a>GUI 中的事件</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.button1.Click += <span class="keyword">new</span> System.EventHandler(<span class="keyword">this</span>.button1_Click);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">button1_Click</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="自定义事件"><a href="#自定义事件" class="headerlink" title="自定义事件"></a>自定义事件</h3><ul>
<li>事件的声明</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">event</span> 委托名 事件名;</span><br></pre></td></tr></table></figure>

<ul>
<li>事件的注册与移除<ul>
<li>事件名 <code>+=</code>  或 <code>-=</code><ul>
<li><strong>在事件所在类的外面，只能用以上两个运算符</strong></li>
</ul>
</li>
</ul>
</li>
<li>事件的发生(激发)<ul>
<li>事件名(参数列表)</li>
<li>相当于回调所注册的函数</li>
</ul>
</li>
</ul>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><ul>
<li><a href="/utils/show_code/index.html?csharp/tds/04/EventWhenDownload.cs">事件爬虫的例子</a></li>
</ul>
<h3 id="定义及使用事件的-6-步曲"><a href="#定义及使用事件的-6-步曲" class="headerlink" title="定义及使用事件的 6 步曲"></a>定义及使用事件的 6 步曲</h3><ul>
<li>声明事件参数类： <code>class xxxEventArgs&#123;&#125;</code></li>
<li>声明委托：<code>delegate void xxxEventHandler(obj, args)</code></li>
<li>定义事件：<code>public event 类型 名称</code></li>
<li>发生事件：<code>事件名(参数)</code></li>
<li>定义一个方法： <code>void 方法名(obj, args)</code></li>
<li>注册事件：<code>xxx.事件+= new 委托(方法名)</code></li>
</ul>
<h3 id="事件与委托的关系"><a href="#事件与委托的关系" class="headerlink" title="事件与委托的关系"></a>事件与委托的关系</h3><ul>
<li><p>事件有点像委托类型的实例</p>
<ul>
<li>事件一定有相关的委托类型</li>
<li>与委托实例一样，事件也“包含”多个函数</li>
<li>事件的运算受更多限制（在类外只能用 <code>+=</code> 或 <code>-=</code>）</li>
</ul>
</li>
<li><p>事件比委托实例更复杂</p>
<ul>
<li>可以定义事件存取器</li>
</ul>
  <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">修饰符 <span class="keyword">event</span> 委托类型名 事件名 &#123;</span><br><span class="line">    <span class="keyword">add</span>&#123;e += <span class="keyword">value</span>; &#125;</span><br><span class="line">    <span class="keyword">remove</span>&#123; e -= <span class="keyword">value</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="事件总结"><a href="#事件总结" class="headerlink" title="事件总结"></a>事件总结</h3><ul>
<li>事件是一种消息机制</li>
<li>事件源调用事件，别的类注册事件</li>
<li>事件的类型是一个委托</li>
</ul>
<h2 id="3-lambda-表达式"><a href="#3-lambda-表达式" class="headerlink" title="3. lambda 表达式"></a>3. lambda 表达式</h2><ul>
<li>C# 语言新特性<ul>
<li>C#2.0  引入泛型</li>
<li>C#3.0  引入 Lambda 及 Linq</li>
<li>C#4.0  更多的动态特性 dynmaic</li>
</ul>
</li>
</ul>
<h3 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h3><ul>
<li>Generic</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Book&gt; books = <span class="keyword">new</span> List&lt;Book&gt;();</span><br><span class="line">Book book = books[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以前要用强制类型转换</span></span><br><span class="line">ArrayList books = <span class="keyword">new</span> ArrayList();</span><br><span class="line">Book book = (Book)books[<span class="number">0</span>];</span><br></pre></td></tr></table></figure>



<h3 id="匿名方法"><a href="#匿名方法" class="headerlink" title="匿名方法"></a>匿名方法</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">delegate</span>(参数)&#123; 方法体; &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>可以当一个匿名方法</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Thread(<span class="keyword">new</span> ThreadStart(<span class="built_in">delegate</span>()&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;)).Start();</span><br></pre></td></tr></table></figure>

<ul>
<li>可以被隐式转换为一个兼容的委托类型<ul>
<li>省略 <code>ThreadStart</code></li>
</ul>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Thread(<span class="built_in">delegate</span>() &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;).Start();</span><br></pre></td></tr></table></figure>



<h3 id="lambda-表达式"><a href="#lambda-表达式" class="headerlink" title="lambda 表达式"></a>lambda 表达式</h3><ul>
<li>相当于匿名方法的简写<ul>
<li>省略 delegate，甚至省略参数类型</li>
</ul>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(参数) =&gt; &#123; 语句或表达式; &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>例子</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Thread(()=&gt;&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;).Start();</span><br></pre></td></tr></table></figure>

<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">button1.Click += (sender,e) =&gt; &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<h3 id="lambda-表达式-vs-匿名方法"><a href="#lambda-表达式-vs-匿名方法" class="headerlink" title="lambda 表达式 vs 匿名方法"></a>lambda 表达式 vs 匿名方法</h3><ul>
<li>lambda 表达式比匿名函数简单</li>
<li>匿名函数多一个功能：<ul>
<li>不写 <code>(参数)</code> 的匿名函数，可以转成任意多个参数的委托</li>
</ul>
</li>
</ul>
<h3 id="Linq"><a href="#Linq" class="headerlink" title="Linq"></a>Linq</h3><ul>
<li>LINQ：Language Integrated Query</li>
<li><a href="/utils/show_code/index.html?csharp/tds/04/LinqTest.cs">完整例子</a></li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Program&gt; programs = <span class="keyword">new</span> List&lt;Program&gt;();</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i) &#123;</span><br><span class="line">    programs.Add(<span class="keyword">new</span> Program());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Linq</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">from</span> p <span class="keyword">in</span> programs</span><br><span class="line">    <span class="keyword">where</span> p.RunTime &lt; <span class="number">50</span></span><br><span class="line">    <span class="keyword">orderby</span> p.Name</span><br><span class="line">    <span class="keyword">select</span> p.Name;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> i <span class="keyword">in</span> a) &#123;</span><br><span class="line">    Console.WriteLine(i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Lambda 表达式</span></span><br><span class="line"><span class="keyword">var</span> b = programs</span><br><span class="line">    .Where(p =&gt; p.RunTime &lt; <span class="number">50</span>)</span><br><span class="line">    .OrderBy(p =&gt; p.Name)</span><br><span class="line">    .Select(p =&gt; p.Name);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> i <span class="keyword">in</span> a) &#123;</span><br><span class="line">    Console.WriteLine(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><ul>
<li>匿名函数使用 <code>delegate</code></li>
<li>Lambda表达式使用 <code>=&gt;</code></li>
<li>Linq 使用 <code>from</code>, <code>where</code>, <code>select</code></li>
<li><a href="/utils/show_code/index.html?csharp/tds/04/Test05.cs">对比代码</a></li>
</ul>
<h2 id="4-运算符重载"><a href="#4-运算符重载" class="headerlink" title="4. 运算符重载"></a>4. 运算符重载</h2><ul>
<li>运算符重载有一些限制<ul>
<li>如成对(true&#x2F;false)，如类型要求，如有的不能重载</li>
</ul>
</li>
<li>运算符的声明</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 一元运算符</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> 类型 <span class="keyword">operator</span> 一元运算符(类型 参数名)&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 二元运算符</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> 类型 <span class="keyword">operator</span> 二元运算符(类型 参数名, 类型 参数名) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 类型转换运算符</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">implicit</span> <span class="keyword">operator</span> 类型 (类型 参数名) &#123;</span><br><span class="line">    <span class="comment">// ..</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">explicit</span> <span class="keyword">operator</span> 类型 (类型 参数名) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><a href="/utils/show_code/index.html?csharp/tds/04/Complex.cs">复数的例子</a></li>
<li><a href="/utils/show_code/index.html?csharp/tds/04/Digit.cs">数码数字的例子</a></li>
</ul>
<h2 id="5-异常处理"><a href="#5-异常处理" class="headerlink" title="5. 异常处理"></a>5. 异常处理</h2><h3 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125; <span class="keyword">catch</span>(Eception e) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>不管是否有异常，都会执行到 <code>finally</code><ul>
<li>即使在 <code>try</code> 中 <code>return</code> 了，也会执行 <code>finally</code></li>
<li><a href="/utils/show_code/index.html?csharp/tds/04/TestFinally.cs">代码</a></li>
</ul>
</li>
<li><code>System.Exception</code> 类</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Exception</span>()</span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Exception</span>(<span class="params"><span class="built_in">string</span> s</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 属性</span></span><br><span class="line">Message;</span><br><span class="line">StackTrace;</span><br></pre></td></tr></table></figure>



<h3 id="系统内部异常类"><a href="#系统内部异常类" class="headerlink" title="系统内部异常类"></a>系统内部异常类</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">System.OutOfMemoryException</span><br><span class="line">System.StackOverflowException</span><br><span class="line">System.NullReferenceException</span><br><span class="line">System.TypeInitializationException</span><br><span class="line">System.InvalidCastException</span><br><span class="line">System.ArrayTypeMismatchException</span><br><span class="line">System.IndexOutOfRangeException</span><br><span class="line">System.MulticastNotSupportedException</span><br><span class="line">System.ArithmeticException</span><br><span class="line">System.DivideByZeroException</span><br><span class="line">System.OverflowException</span><br></pre></td></tr></table></figure>



<h3 id="捕获和处理异常"><a href="#捕获和处理异常" class="headerlink" title="捕获和处理异常"></a>捕获和处理异常</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125; <span class="keyword">catch</span>(AException e1)&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125; <span class="keyword">catch</span>(BException e2)&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125; <span class="keyword">catch</span>(更一般的Exception e)&#123;</span><br><span class="line">    <span class="comment">//  ...</span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>catch&#123;&#125;</code> 表示捕获所有种类的异常</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="抛出异常"><a href="#抛出异常" class="headerlink" title="抛出异常"></a>抛出异常</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(xxxxxx) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> SomeException(信息);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="自定义异常类"><a href="#自定义异常类" class="headerlink" title="自定义异常类"></a>自定义异常类</h3><ul>
<li>从 <code>Exception</code> 或 <code>ApplicationException</code> 继承</li>
<li>重抛异常</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>异常链接</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> Excepiton(<span class="string">&quot;msg&quot;</span>, e);</span><br></pre></td></tr></table></figure>

<ul>
<li>这里 e 称为内部异常</li>
<li>InnerException 属性</li>
<li>使得外部能进一步知道内部的异常原因</li>
</ul>
<h3 id="算术溢出与-checked"><a href="#算术溢出与-checked" class="headerlink" title="算术溢出与 checked"></a>算术溢出与 checked</h3><ul>
<li>对溢出进行检查<ul>
<li>对整个程序 csc &#x2F;checked</li>
<li>对部分程序<ul>
<li>针对表达式： checked(表达式) 及 uncheckd(表达式)</li>
<li>针对块语句： checked{…} 及 uncheckd{…}</li>
</ul>
</li>
<li>对溢出异常进行捕获<ul>
<li>try{ … } catch( OverflowException e ) { … }</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="6-Attribute"><a href="#6-Attribute" class="headerlink" title="6. Attribute"></a>6. Attribute</h2><ul>
<li>用在类上</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">ComVisible(true)</span>]</span><br><span class="line">[<span class="meta">DefaultMember(<span class="string">&quot;Chars&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="title">String</span> : <span class="title">IComparable</span>, <span class="title">ICloneable</span>,</span><br><span class="line"><span class="title">IConvertible</span>, <span class="title">IEnumerable</span>, <span class="title">IComparable</span>&lt;<span class="title">String</span>&gt;,</span><br><span class="line"><span class="title">IEnumerable</span>&lt;<span class="title">char</span>&gt;, <span class="title">IEquatable</span>&lt;<span class="title">String</span>&gt; &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>用在方法上的</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">SecuritySafeCritical</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">String</span>(<span class="params"><span class="built_in">char</span>[] <span class="keyword">value</span></span>)</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">STAThread</span>]</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Attribute 是与类、结构、方法等元素相关的额外信息，是对元信息的扩展</li>
<li>通过Attribute可以使程序、甚至语言本身的功能得到增强</li>
</ul>
<h3 id="使用系统定义的-Attribute"><a href="#使用系统定义的-Attribute" class="headerlink" title="使用系统定义的 Attribute"></a>使用系统定义的 Attribute</h3><ul>
<li>使用 Attribute 的一般方式<ul>
<li>在程序集、类、域、方法等前面用[]表示</li>
<li>可以省略“Attribute”几个字母，只写xxxxx</li>
<li>可以带参数<ul>
<li>位置参数 （相当于构造方法带的参数）</li>
<li>命名参数（域名或属性名&#x3D;值）</li>
</ul>
</li>
</ul>
</li>
<li>示例<ul>
<li>在Main()方法使用[STAThread]</li>
<li>在结构上、枚举上使用：StructLayout，Flag</li>
<li>在程序集级别应用Attribute<ul>
<li>[assembly: AssemblyCompany(“”)]</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="自定义Attribute"><a href="#自定义Attribute" class="headerlink" title="自定义Attribute"></a>自定义Attribute</h3><ul>
<li>声明 Attribute 类<ul>
<li>从 System.Attribute 继承而来</li>
<li>名字要用 xxxxAttribute</li>
</ul>
</li>
<li>使用 Attribute 类<ul>
<li>在类及成员上面使用方括号</li>
<li><strong>可以省略后缀 Attribute</strong></li>
</ul>
</li>
<li><strong>通过反射访问属性</strong></li>
<li><a href="/utils/show_code/index.html?csharp/tds/04/TestAttribute.cs">实例</a></li>
</ul>
<h2 id="7-C-语言中的其他成分"><a href="#7-C-语言中的其他成分" class="headerlink" title="7. C# 语言中的其他成分"></a>7. C# 语言中的其他成分</h2><h3 id="编译预处理"><a href="#编译预处理" class="headerlink" title="编译预处理"></a>编译预处理</h3><ul>
<li>标识符声明</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个标识符</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 取消定义一个标识符。</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span></span></span><br></pre></td></tr></table></figure>

<ul>
<li>条件处理</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">if</span>, #<span class="keyword">elif</span>, #<span class="keyword">else</span>, #<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<ul>
<li>信息报告</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">error</span>, #<span class="keyword">warning</span></span></span><br></pre></td></tr></table></figure>

<ul>
<li>行号标记</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">line</span> 行号 &quot;文件名&quot;</span></span><br></pre></td></tr></table></figure>



<h3 id="unsafe-及指针"><a href="#unsafe-及指针" class="headerlink" title="unsafe 及指针"></a>unsafe 及指针</h3><ul>
<li><p>unsafe</p>
<ul>
<li>用于修饰类、方法等</li>
</ul>
</li>
<li><p>fixed 及指针</p>
<ul>
<li>fixed(类型 * 指针名 &#x3D; 表达式) 语句</li>
</ul>
</li>
<li><p>sizeof运算符</p>
<ul>
<li>sizeof(简单或结构类型名)</li>
</ul>
</li>
<li><p>stackalloc</p>
<ul>
<li>在栈上分配的内存，而不是在堆上，因此不会担心内存被垃圾回收器自动回收。</li>
</ul>
</li>
<li><p>示例代码</p>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">FileStream</span>: <span class="title">Stream</span> &#123;</span><br><span class="line">    <span class="built_in">int</span> handle;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">dllimport(<span class="string">&quot;kernel32&quot;</span>, SetLastError=true)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">extern</span> <span class="keyword">unsafe</span> <span class="built_in">bool</span> <span class="title">ReadFile</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="built_in">int</span> hFile, <span class="keyword">void</span>* lpBuffer,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="built_in">int</span> nBytesToRead, <span class="built_in">int</span>* nBytesRead, Overlapped* lpOverlapped</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">unsafe</span> <span class="built_in">int</span> <span class="title">Read</span>(<span class="params"><span class="built_in">byte</span>[] buffer, <span class="built_in">int</span> index, <span class="built_in">int</span> count</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">int</span> n = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">fixed</span> (<span class="built_in">byte</span>* p = buffer) &#123;</span><br><span class="line">            ReadFile(handle, p + index, count, &amp;n, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><a href="/utils/show_code/index.html?csharp/tds/04/UnsafeCopy.cs">UnsafeCopy.cs</a><ul>
<li>unsafe 关键字需要在编译的时候加上 <code>/unsafe</code></li>
</ul>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 编译时需要: /unsafe</span></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Test</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">unsafe</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">IntToString</span>(<span class="params"><span class="built_in">int</span> <span class="keyword">value</span></span>)</span> &#123;</span><br><span class="line">        <span class="built_in">char</span>* buffer = <span class="keyword">stackalloc</span> <span class="built_in">char</span>[<span class="number">16</span>];</span><br><span class="line">        <span class="built_in">char</span>* p = buffer + <span class="number">16</span>;</span><br><span class="line">        <span class="built_in">int</span> n = <span class="keyword">value</span> &gt;= <span class="number">0</span> ? <span class="keyword">value</span> : -<span class="keyword">value</span>;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            *--p = (<span class="built_in">char</span>)(n % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">            n /= <span class="number">10</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span> (n != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">value</span> &lt; <span class="number">0</span>) *--p = <span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">string</span>(p, <span class="number">0</span>, (<span class="built_in">int</span>)(buffer + <span class="number">16</span> - p));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span> &#123;</span><br><span class="line">        Console.WriteLine(IntToString(<span class="number">12345</span>));</span><br><span class="line">        Console.WriteLine(IntToString(<span class="number">-999</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="其他关键字"><a href="#其他关键字" class="headerlink" title="其他关键字"></a>其他关键字</h3><ul>
<li>lock<ul>
<li>多线程程序中，lock可以将某个对象加锁</li>
</ul>
</li>
<li>volatile<ul>
<li>随时可能被程序以外的其他因素所修改</li>
<li>域被 volatile 修饰时，会阻止编译器对它的优化</li>
</ul>
</li>
</ul>
<h2 id="8-程序的组织"><a href="#8-程序的组织" class="headerlink" title="8. 程序的组织"></a>8. 程序的组织</h2><ul>
<li>名字空间：程序的逻辑组织</li>
<li>嵌套类型：类中嵌套类型</li>
<li>程序集：程序的物理组织</li>
</ul>
<h3 id="名字空间"><a href="#名字空间" class="headerlink" title="名字空间"></a>名字空间</h3><ul>
<li><p>名字空间的概念</p>
<ul>
<li>逻辑划分；避免名字冲突</li>
</ul>
</li>
<li><p>名字空间的声明</p>
<ul>
<li>可嵌套</li>
</ul>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">xxx.xxxx</span> &#123; &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>名字空间的导入</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> xxx.xxxx;</span><br></pre></td></tr></table></figure>

<ul>
<li>使用别名</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> 别名 = 名字空间或类名;</span><br></pre></td></tr></table></figure>



<h3 id="嵌套类型"><a href="#嵌套类型" class="headerlink" title="嵌套类型"></a>嵌套类型</h3><ul>
<li>嵌套类型的概念</li>
<li>类型中的类型</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">A</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">B</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">struct</span> C &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> A.B.C();</span><br></pre></td></tr></table></figure>

<ul>
<li>嵌套类型的可访问性<ul>
<li>受各个层次的限制</li>
</ul>
</li>
</ul>
<h3 id="程序集"><a href="#程序集" class="headerlink" title="程序集"></a>程序集</h3><ul>
<li>模块（module）<ul>
<li>程序集（assembly）</li>
<li>exe、dll</li>
</ul>
</li>
<li>VS 生成一个程序集<ul>
<li>新建项目的时候指定为<strong>类库</strong></li>
</ul>
</li>
<li>在 VS 上引用程序集<ul>
<li>在项目上点右键，添加引用</li>
</ul>
</li>
</ul>
<h3 id="编译示例"><a href="#编译示例" class="headerlink" title="编译示例"></a>编译示例</h3><img src="04/image-20211010122605122.png" style="zoom:67%;" />

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">csc /target:mod /out:Add.mod Add.cs</span><br><span class="line"></span><br><span class="line">csc /target:mod /out:Multi.mod Multi.cs</span><br><span class="line"></span><br><span class="line">al /target:library /out:MyLibrary.dll Add.mod Multi.mod</span><br><span class="line"></span><br><span class="line">csc /target:exe /out:MyClient.exe /reference:MyLibrary.dll MyClient.cs</span><br></pre></td></tr></table></figure>



<h2 id="9-语法总结"><a href="#9-语法总结" class="headerlink" title="9. 语法总结"></a>9. 语法总结</h2><h3 id="类型声明"><a href="#类型声明" class="headerlink" title="类型声明"></a>类型声明</h3><ul>
<li>类型声明是 C# 程序的主体，它可以位于名字空间中，也可以是嵌套的类型</li>
<li>类型声明包括以下几种：<ul>
<li>类 class</li>
<li>结构 struct</li>
<li>接口 interface</li>
<li>枚举 enum</li>
<li>委托 delegate</li>
</ul>
</li>
</ul>
<h3 id="类的成员"><a href="#类的成员" class="headerlink" title="类的成员"></a>类的成员</h3><ul>
<li>常数（const）<ul>
<li>它代表了与类相关的常数数据</li>
</ul>
</li>
<li>域（field）<ul>
<li>它是类中的变量</li>
</ul>
</li>
<li>方法（method）<ul>
<li>它实现了可以被类实现的计算和行为</li>
</ul>
</li>
<li>属性（property）<ul>
<li>它定义了命名的属性和与对这个属性进行读写的相关行为</li>
</ul>
</li>
<li>事件（event）<ul>
<li>它定义了由类产生的通知</li>
</ul>
</li>
<li>索引（indexer）<ul>
<li>它允许类的实例通过与数组相同的方法来索引</li>
</ul>
</li>
<li>运算符（operator）<ul>
<li>它定义了可以被应用于类的实例上的表达式运算符</li>
</ul>
</li>
<li>实例构造函数（instance constructor）<ul>
<li>它执行需要对类的实例进行初始化的动作</li>
</ul>
</li>
<li>析构函数（destructor）<ul>
<li>类的实例被清除时实现的动作（结构不能有析构函数）</li>
</ul>
</li>
<li>静态构造函数（static constructor）<ul>
<li>它执行对类本身进行初始化的动作</li>
</ul>
</li>
<li>类型（type）<ul>
<li>它代表位于类中的类型</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/07/csharp/tds/04/" data-id="cl9lj74bj00jv64tz87d04eq7" data-title="C#程序设计.唐大仕.04.C#高级语言特性" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/csharp/" rel="tag">csharp</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Math/Plücker-Coordinates" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/07/Math/Pl%C3%BCcker-Coordinates/" class="article-date">
  <time class="dt-published" datetime="2021-10-07T05:23:55.000Z" itemprop="datePublished">2021-10-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Math/">Math</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/10/07/Math/Pl%C3%BCcker-Coordinates/">普吕克坐标(Plücker Coordinates) 简介</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="普吕克坐标"><a href="#普吕克坐标" class="headerlink" title="普吕克坐标"></a>普吕克坐标</h1><ul>
<li>Plücker Coordinates</li>
<li>3 维欧氏空间的一条直线被两个其上不同的点确定，或者被两个包含这条直线的平面确定</li>
</ul>
<h2 id="几何定义"><a href="#几何定义" class="headerlink" title="几何定义"></a>几何定义</h2><h3 id="两个点导出"><a href="#两个点导出" class="headerlink" title="两个点导出"></a>两个点导出</h3><ul>
<li>直线 $L$，考虑 $L$ 上两个<strong>不同</strong>的点：$x&#x3D;(x_{1},x_{2},x_{3}),y&#x3D;(y_{1},y_{2},y_{3})$</li>
<li>$d&#x3D;y-x$</li>
<li>矩：$m&#x3D;{x}\times{y}$<ul>
<li>质点从 $x$ 移动到 $y$ 的矩</li>
<li>$m$ 的大小为三角形 $Oxy$ 面积的两倍，正比于 $d$ 的大小</li>
</ul>
</li>
</ul>
<img src="Plücker-Coordinates/pic1.jpg" style="zoom:67%;" />

<ul>
<li>${d}\cdot{m}&#x3D;0$<ul>
<li>垂直</li>
</ul>
</li>
<li>单独 $d$ 或者 $m$ 都无法唯一确定直线 $L$，他们俩才能唯一确定直线 $L$</li>
<li>定义齐次坐标如下</li>
</ul>
<p>$$<br>(d:m)&#x3D;(d_1:d_2:d_3:m_1:m_2:m_3)<br>$$</p>
<ul>
<li>其中</li>
</ul>
<p>$$<br>\begin{aligned}<br>\begin{array}{c}<br>d_1&#x3D;y_1-x_1\<br>d_2&#x3D;y_2-x_2\<br>d_3&#x3D;y_3-x_3\<br>m_1&#x3D;x_2y_3-y_2x_3\<br>m_2&#x3D;x_3y_1-y_3x_1\<br>m_3&#x3D;x_1y_2-y_1x_2\<br>\end{array}<br>\end{aligned}<br>$$</p>
<ul>
<li>所有的 $(\lambda d:\lambda m),\lambda\ne0$ 都可以由直线 $L$ 上不同的两个点生成</li>
<li>$(d:m)$ 就是普吕克坐标</li>
</ul>
<h2 id="代数定义"><a href="#代数定义" class="headerlink" title="代数定义"></a>代数定义</h2><ul>
<li>直线 $L$ 穿过两个点 $x,y$，他们的齐次坐标表示为 $x&#x3D;(x_0,x_1,x_2,x_3),y&#x3D;(y_0,y_1,y_2,y_3)$<ul>
<li>坐标 0 为其次项</li>
</ul>
</li>
<li>定义普吕克坐标为 $p_{ij}&#x3D;x_iy_j-x_jy_i$<ul>
<li>$p_{ii}&#x3D;0,p_{ij}&#x3D;-p_{ji}$</li>
</ul>
</li>
<li>因此只有 6 个独立变量，对应普吕克坐标</li>
</ul>
<p>$$<br>(p_{01}:p_{02}:p_{03}:p_{23}:p_{31}:p_{12})<br>$$</p>
<h2 id="线线相交"><a href="#线线相交" class="headerlink" title="线线相交"></a>线线相交</h2><ul>
<li>3 维欧氏空间中，两条直线 $L,L’$ 相交则有</li>
</ul>
<p>$$<br>d\cdot m’+m\cdot d&#x3D;0<br>$$</p>
<ul>
<li>其中 $p_{ij},p_{ij}’$ 是 $L,L’$ 的普吕克矩阵</li>
</ul>
<p>$$<br>\begin{aligned}<br>0&amp;&#x3D;p_{01}p’<em>{23}+p</em>{02}p’<em>{31}+p</em>{03}p’<em>{12}+p</em>{23}p’<em>{01}+p</em>{31}p’<em>{02}+p</em>{12}p’<em>{03}\<br>&amp;&#x3D;<br>\begin{vmatrix}<br>x</em>{0}&amp;y_{0}&amp;x’<em>{0}&amp;y’</em>{0}\<br>x_{1}&amp;y_{1}&amp;x’<em>{1}&amp;y’</em>{1}\<br>x_{2}&amp;y_{2}&amp;x’<em>{2}&amp;y’</em>{2}\<br>x_{3}&amp;y_{3}&amp;x’<em>{3}&amp;y’</em>{3}<br>\end{vmatrix}<br>\end{aligned}<br>$$</p>
<ul>
<li>如果不相交，上面式子的正负表示方向<ul>
<li>正：$L$ 为大拇指，$L’$ 的方向为右手螺旋</li>
<li>负：$L$ 为大拇指，$L’$ 的方向为左手螺旋</li>
</ul>
</li>
</ul>
<img src="Plücker-Coordinates/image-20211007111659627.png" style="zoom:67%;" />



<h3 id="齐次坐标行列式为-0"><a href="#齐次坐标行列式为-0" class="headerlink" title="齐次坐标行列式为 0"></a>齐次坐标行列式为 0</h3><h4 id="二维平面"><a href="#二维平面" class="headerlink" title="二维平面"></a>二维平面</h4><ul>
<li>$A(x_a,y_a),B(x_b,y_b),C(x_c,y_c)$ 三点共线 等价于这三个点的齐次坐标组成的行列式值为 0</li>
</ul>
<p>$$<br>\begin{vmatrix}<br>x_{a}&amp;x_{b}&amp;x_{c}\<br>y_{a}&amp;y_{b}&amp;y_{c}\<br>1&amp;1&amp;1\<br>\end{vmatrix}<br>$$</p>
<ul>
<li>$\vec{AB}&#x3D;k\cdot\vec{AC}$<ul>
<li>齐次项化为 1 之后，再相减，此时第三维为 0</li>
</ul>
</li>
<li>说明线性相关，行列式为 0</li>
</ul>
<h4 id="三维平面"><a href="#三维平面" class="headerlink" title="三维平面"></a>三维平面</h4><ul>
<li>类似的，首先将齐次项化为 1，通过同时减去某一列，判断其是否线性相关即可</li>
</ul>
<p>$$<br>\begin{vmatrix}<br>x_{0}&amp;y_{0}&amp;x’<em>{0}&amp;y’</em>{0}\<br>x_{1}&amp;y_{1}&amp;x’<em>{1}&amp;y’</em>{1}\<br>x_{2}&amp;y_{2}&amp;x’<em>{2}&amp;y’</em>{2}\<br>x_{3}&amp;y_{3}&amp;x’<em>{3}&amp;y’</em>{3}<br>\end{vmatrix}<br>$$</p>
<ul>
<li>$\vec{AB}&#x3D;k_1\cdot\vec{AC}+k_2\cdot\vec{AD}$</li>
</ul>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Pl%C3%BCcker_coordinates">维基百科</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/07/Math/Pl%C3%BCcker-Coordinates/" data-id="cl9lj748g000o64tz0pn16sdm" data-title="普吕克坐标(Plücker Coordinates) 简介" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/math/" rel="tag">math</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%87%A0%E4%BD%95/" rel="tag">几何</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%99%AE%E5%90%95%E5%85%8B%E5%9D%90%E6%A0%87/" rel="tag">普吕克坐标</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Kits/obs" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/06/Kits/obs/" class="article-date">
  <time class="dt-published" datetime="2021-10-06T04:51:59.000Z" itemprop="datePublished">2021-10-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Kits/">Kits</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/10/06/Kits/obs/">obs 使用技巧</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="obs-使用技巧"><a href="#obs-使用技巧" class="headerlink" title="obs 使用技巧"></a>obs 使用技巧</h1><h2 id="1-input-overlay"><a href="#1-input-overlay" class="headerlink" title="1. input-overlay"></a>1. input-overlay</h2><ul>
<li>小插件，能够显示按键和鼠标</li>
<li>安装教程参考<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Mf4y1S7QB">B站视频</a></li>
</ul>
<h3 id="1-下载"><a href="#1-下载" class="headerlink" title="(1) 下载"></a>(1) 下载</h3><ul>
<li><a href="ttps://github.com/univrsal/input-overlay/releases/tag/v4.8">GitHub</a><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/univrsal/input-overlay/releases/download/v4.8/input-overlay.v4.8b.win32.64.zip">windows 版本</a></li>
</ul>
</li>
</ul>
<h3 id="2-解压"><a href="#2-解压" class="headerlink" title="(2) 解压"></a>(2) 解压</h3><ul>
<li>解压下载得到的 <code>input-overlay.v4.8b.win32.64.zip</code> 文件<ul>
<li>文件夹重命名为 <code>input-overlay</code></li>
</ul>
</li>
<li>进入到 <code>presets</code> 文件夹下，将对应的压缩包都解压到 <code>*/</code> 文件夹下</li>
</ul>
<h3 id="3-安装"><a href="#3-安装" class="headerlink" title="(3) 安装"></a>(3) 安装</h3><ul>
<li>我的 <code>obs</code> 安装路径为 <code>D:\installed application\obs-studio\</code></li>
<li>文件移动<ul>
<li>我的版本是 <code>64-bit</code>，因此只操作 <code>64-bit</code> 的</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th align="center">下载解压插件</th>
<th align="center">obs 安装目录</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>input-overlay\plugin\data\obs-plugins\*</code></td>
<td align="center"><code>obs-studio\data\obs-plugins\</code></td>
</tr>
<tr>
<td align="center"><code>input-overlay\plugin\obs-plugins\64bit\*</code></td>
<td align="center"><code>obs-studio\obs-plugins\64bit\</code></td>
</tr>
<tr>
<td align="center"><code>input-overlay\presets\*</code></td>
<td align="center"><code>obs-studioinput-overlay\presets\</code></td>
</tr>
</tbody></table>
<ul>
<li>其中 <code>presets</code> 文件夹只需要保存在自己找的到的地方即可</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/06/Kits/obs/" data-id="cl9lj748i001364tzc7zu7q8v" data-title="obs 使用技巧" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Kits/" rel="tag">Kits</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/obs/" rel="tag">obs</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-computation/pyr/03" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/02/computation/pyr/03/" class="article-date">
  <time class="dt-published" datetime="2021-10-02T12:19:40.000Z" itemprop="datePublished">2021-10-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/computation-pyr/">computation.pyr</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/10/02/computation/pyr/03/">计算方法B.裴玉茹.03.方程组</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ul>
<li>数值分析课本第 2 章（方程组） + PPT（非线性方程组迭代求解）</li>
</ul>
<h1 id="方程组"><a href="#方程组" class="headerlink" title="方程组"></a>方程组</h1><h2 id="1-高斯消去法"><a href="#1-高斯消去法" class="headerlink" title="1. 高斯消去法"></a>1. 高斯消去法</h2><h3 id="1-1-朴素的高斯消去法"><a href="#1-1-朴素的高斯消去法" class="headerlink" title="1.1 朴素的高斯消去法"></a>1.1 朴素的高斯消去法</h3><ul>
<li>等价变化（行列式变换）<ul>
<li>两个方程彼此交换位置</li>
<li>在一个方程上加上或者减去两外一个方程的倍数</li>
<li>对于一个方程乘上一个非零的常数</li>
</ul>
</li>
<li>步骤<ul>
<li>化为上三角阵</li>
<li>回代（后向求解）</li>
</ul>
</li>
</ul>
<h3 id="1-2-操作次数"><a href="#1-2-操作次数" class="headerlink" title="1.2 操作次数"></a>1.2 操作次数</h3><p>$$<br>1+2+\cdots+n&#x3D;\dfrac{n(n+1)}{2}<br>$$</p>
<p>$$<br>1^2+2^2+\cdots+n^2&#x3D;\dfrac{n(n+1)(2n+1)}{6}<br>$$</p>
<ul>
<li>输入的方程组（含有 n 个未知数的 n 个方程组）</li>
</ul>
<img src="03/image-20211003163248736.jpg" style="zoom:67%;" />

<ul>
<li><p>把矩阵的下三角部分转化为全 0</p>
<ul>
<li>例如消去 $a_{21}$，对第二列作如下操作</li>
</ul>
<p>  $$<br>  a_{21}-\dfrac{a_{21}}{a_{11}}a_{11}<br>  $$</p>
<ul>
<li>对于这一行：1个除法 + n 个乘法 + n 个减法<ul>
<li>第一列不用，但是 $b_i$ 也要做同样的计算</li>
</ul>
</li>
</ul>
</li>
<li><p>$a_{ii}$ 会在分母中出现，被称为是<strong>主元</strong>，上面的操作要求 $a_{ii}$ 不为 0</p>
</li>
<li><p>我们可以计算得到消去这一步中的操作次数</p>
</li>
</ul>
<p>$$<br>\sum_{k&#x3D;n}^{1}(2k+1)(k-1)&#x3D;\dfrac{4n^3+3n^2-7n}{6}<br>$$</p>
<ul>
<li>此时方程转化为</li>
</ul>
<img src="03/image-20211003164850752.jpg" style="zoom: 67%;" />

<ul>
<li>此时只需要从下到上一步步回代即可<ul>
<li>1 除法、(n-i) 乘法、(n-i) 减法</li>
</ul>
</li>
</ul>
<p>$$<br>x_{i}&#x3D;\dfrac{b_i-a_{i,i+1}x_{i+1}-\cdots-a_{i,n}x_{n}}{a_{ii}}<br>$$</p>
<ul>
<li>操作次数</li>
</ul>
<p>$$<br>\sum_{i&#x3D;1}^{n}2(n-i)+1&#x3D;\sum_{i&#x3D;1}^{n}2(i-1)+1&#x3D;n^2<br>$$</p>
<ul>
<li>高斯消去法时间复杂度：$O(n^3)$<ul>
<li>消去：$O(n^3)$</li>
<li>回代：$O(n^2)$</li>
</ul>
</li>
</ul>
<h2 id="2-LU-分解"><a href="#2-LU-分解" class="headerlink" title="2. LU 分解"></a>2. LU 分解</h2><h3 id="2-1-高斯消去法的矩阵形式"><a href="#2-1-高斯消去法的矩阵形式" class="headerlink" title="2.1 高斯消去法的矩阵形式"></a>2.1 高斯消去法的矩阵形式</h3><ul>
<li>Ax&#x3D;B</li>
<li><strong>LU 分解是高斯消去法的矩阵形式</strong><ul>
<li>L：下三角矩阵</li>
<li>U：上三角矩阵</li>
</ul>
</li>
<li>如下几个事实支持 LU 分解</li>
</ul>
<h4 id="事实1"><a href="#事实1" class="headerlink" title="事实1"></a>事实1</h4><ul>
<li>矩阵左乘相当于高斯消去法的变换</li>
</ul>
<img src="03/image-20211003190022083.jpg" style="zoom:67%;" />

<img src="03/image-20211003185208542.jpg" style="zoom:67%;" />



<h4 id="事实2"><a href="#事实2" class="headerlink" title="事实2"></a>事实2</h4><ul>
<li>逆就是取反</li>
</ul>
<img src="03/image-20211003185540307.jpg" style="zoom:67%;" />



<h4 id="事实3"><a href="#事实3" class="headerlink" title="事实3"></a>事实3</h4><ul>
<li>相乘得到结果（注意<strong>顺序</strong>）</li>
</ul>
<img src="03/image-20211003185647924.jpg" style="zoom:67%;" />



<h4 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h4><ul>
<li>原来的矩阵通过高斯变换转化为上三角矩阵<ul>
<li>$A$ 通过若干 $L_{ij}$ 的变换得到 $U$</li>
</ul>
</li>
<li>将若干变换记作 $L^{-1}$</li>
<li>$L^{-1}A &#x3D; U\Rightarrow A&#x3D;LU$</li>
</ul>
<h3 id="2-2-使用-LU-分解回代"><a href="#2-2-使用-LU-分解回代" class="headerlink" title="2.2 使用  LU 分解回代"></a>2.2 使用  LU 分解回代</h3><ul>
<li>$Ax&#x3D;b\Rightarrow LUx&#x3D;b$</li>
<li>记 $Ux&#x3D;c$，有 $Lc&#x3D;b$</li>
<li>回代过程如下<ul>
<li>通过 $Lc&#x3D;b$，解出 $c$</li>
<li>通过 $Ux&#x3D;c$，解出 $x$</li>
</ul>
</li>
</ul>
<h3 id="2-3-LU-分解的复杂度"><a href="#2-3-LU-分解的复杂度" class="headerlink" title="2.3 LU 分解的复杂度"></a>2.3 LU 分解的复杂度</h3><h4 id="LU-分解的好处"><a href="#LU-分解的好处" class="headerlink" title="LU 分解的好处"></a>LU 分解的好处</h4><ul>
<li>如果对于一系列的方程组求解</li>
</ul>
<p>$$<br>\begin{aligned}<br>\begin{array}{c}<br>Ax&#x3D;b_1\<br>Ax&#x3D;b_2\<br>\cdots\<br>Ax&#x3D;b_k\<br>\end{array}<br>\end{aligned}<br>$$</p>
<ul>
<li>对于原始的高斯消去法，每次都需要经过复杂的消去操作<ul>
<li>复杂度约为：$\dfrac{2kn^3}{3}$</li>
</ul>
</li>
<li>但是对于 LU 分解方法，消去操作只需要做一次<ul>
<li>复杂度约为：$\dfrac{2n^3}{3}+2kn^2$</li>
</ul>
</li>
</ul>
<img src="03/image-20211003192642407.jpg" style="zoom:67%;" />

<ul>
<li>并不是所有的矩阵都能进行 LU 分解</li>
</ul>
<h4 id="实际实现"><a href="#实际实现" class="headerlink" title="实际实现"></a>实际实现</h4><ul>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/343079701">知乎参考</a></li>
<li>注意一些性质<ul>
<li>L 对角线为 1，下三角阵</li>
<li>R 上三角阵</li>
</ul>
</li>
</ul>
<p>$$<br>{A_{ij}}&#x3D;<br>\left{<br>\matrix{<br>\sum\limits_{k &#x3D; 1}^i L_{ik}U_{kj} ,(i &lt; j)\<br>\sum\limits_{k &#x3D; 1}^j L_{ik}U_{kj} ,(i &gt; j)\<br>\sum\limits_{k &#x3D; 1}^i L_{ik}U_{kj} ,(i &#x3D; j)\<br>}\right.<br>\Rightarrow<br>\left{<br>\matrix{<br>\sum\limits_{k &#x3D; 1}^{i - 1} L_{ik}U_{kj}  + U_{ij} &#x3D; A_{ij},(i \le j)\<br>\sum\limits_{k &#x3D; 1}^{j - 1} L_{ik}U_{kj}  + L_{ij}U_{jj} &#x3D; A_{ij},(i &gt; j)\<br>}\right.<br>$$</p>
<p>$$<br>\Rightarrow<br>\left{<br>\matrix{<br>U_{ij} &#x3D; A_{ij} - \sum\limits_{k &#x3D; 1}^{i - 1} L_{ik}U_{kj} ,(i \le j)\<br>L_{ij} &#x3D; \dfrac{A_{ij}-\sum\limits_{k &#x3D; 1}^{j - 1} L_{ik}U_{kj}}{U_{jj}},(i &gt; j)\<br>}\right.<br>$$</p>
<ul>
<li>先计算 $U_{ij}$，再计算 $L_{ij}$</li>
</ul>
<h2 id="3-误差来源"><a href="#3-误差来源" class="headerlink" title="3. 误差来源"></a>3. 误差来源</h2><ul>
<li><strong>病态矩阵</strong></li>
<li><strong>淹没</strong></li>
</ul>
<h3 id="3-1-误差放大和条件数"><a href="#3-1-误差放大和条件数" class="headerlink" title="3.1 误差放大和条件数"></a>3.1 误差放大和条件数</h3><ul>
<li><strong>无穷范数</strong><ul>
<li>向量 $x&#x3D;(x_1,\cdots,x_n)$ 的无穷范数为 $\Vert{x}\Vert_{\infty}&#x3D;\max\vert{x_i}\vert$</li>
</ul>
</li>
<li>$x_a$ 是线性方程组 $Ax&#x3D;b$ 的近似解<ul>
<li><strong>余项</strong>：$r&#x3D;b-Ax_a$</li>
<li><strong>后向误差</strong>：$\Vert{b-Ax_a}\Vert_{\infty}$</li>
<li><strong>前向误差</strong>：$\Vert{x-x_a}\Vert_{\infty}$</li>
</ul>
</li>
<li>前向误差和后向误差可能有不同数量级<ul>
<li>大的前向误差、小的后向误差</li>
</ul>
</li>
</ul>
<img src="03/image-20211003230247314.jpg" style="zoom:67%;" />

<ul>
<li><strong>相对前向误差</strong></li>
</ul>
<p>$$<br>\dfrac{\Vert{x-x_a}\Vert_{\infty}}{\Vert{x}\Vert_{\infty}}<br>$$</p>
<ul>
<li><strong>相对后向误差</strong></li>
</ul>
<p>$$<br>\dfrac{\Vert{b-Ax_a}\Vert_{\infty}}{\Vert{b}\Vert_{\infty}}&#x3D;\dfrac{\Vert{r}\Vert_{\infty}}{\Vert{b}\Vert_{\infty}}<br>$$</p>
<ul>
<li><strong>误差放大因子</strong></li>
</ul>
<p>$$<br>误差放大因子&#x3D;\dfrac{相对前向误差}{相对后向误差}&#x3D;\dfrac{\dfrac{\Vert{x-x_a}\Vert_{\infty}}{\Vert{x}\Vert_{\infty}}}{\dfrac{\Vert{r}\Vert_{\infty}}{\Vert{b}\Vert_{\infty}}}<br>$$</p>
<ul>
<li><strong>条件数</strong><ul>
<li>在预先定义的输入误差范围中最大的误差放大倍数</li>
</ul>
</li>
</ul>
<h4 id="条件数"><a href="#条件数" class="headerlink" title="条件数"></a>条件数</h4><ul>
<li>方阵 A 的条件数 cond(A) 为求解 Ax&#x3D;b 时，对于所有的右侧向量 b，可能出现的最大误差放大因子</li>
<li><strong>矩阵范数</strong><ul>
<li>$n\times n$ 矩阵 A 的矩阵范数定义如下</li>
<li>每行元素绝对值之和的最大值</li>
</ul>
</li>
</ul>
<p>$$<br>\Vert{A}\Vert_{\infty}&#x3D;\max_{i}\left(\sum_{j&#x3D;1}^{n}\vert{a_{ij}}\vert\right)<br>$$</p>
<ul>
<li>$n\times n$ 矩阵的 A 的条件数是（<strong>这里指的是算子范数</strong>）</li>
</ul>
<p>$$<br>\mathrm{cond}(A)&#x3D;\Vert{A}\Vert\cdot\Vert{A^{-1}}\Vert<br>$$</p>
<ul>
<li><a href="#%E6%9D%A1%E4%BB%B6%E6%95%B0%E8%AF%81%E6%98%8E">证明如下</a></li>
</ul>
<h5 id="精度丢失"><a href="#精度丢失" class="headerlink" title="精度丢失"></a>精度丢失</h5><ul>
<li>相对后向误差不可能小于 $\epsilon_{\mathrm{mach}}$，因此相对前向误差可能达到 $\epsilon_{\mathrm{mach}}\cdot \mathrm{cond}(A)$ 这么大<ul>
<li>也就是说如果我们 $\mathrm{cond}(A)\approx{10^k}$，在计算 Ax&#x3D;b 时可能丢掉 k 位数字精度</li>
</ul>
</li>
</ul>
<h4 id="向量范数"><a href="#向量范数" class="headerlink" title="向量范数"></a>向量范数</h4><img src="03/image-20211005134226581.jpg" style="zoom: 67%;" />



<h5 id="1-范数"><a href="#1-范数" class="headerlink" title="1-范数"></a>1-范数</h5><ul>
<li>n 维向量的1-范数</li>
</ul>
<p>$$<br>\Vert{x}\Vert_{1}&#x3D;\vert{x_1}\vert+\vert{x_2}\vert+\cdots+\vert{x_n}\vert<br>$$</p>
<ul>
<li>$n\times n$ 矩阵 A 的 1-范数<ul>
<li>最大绝对列和</li>
<li>列向量的 1-范数 的最大值</li>
</ul>
</li>
</ul>
<p>$$<br>\Vert{A}\Vert_{1}&#x3D;\max_{j}\left(\sum_{i&#x3D;1}^{n}\vert{a_{ij}}\vert\right)<br>$$</p>
<h4 id="算子范数"><a href="#算子范数" class="headerlink" title="算子范数"></a>算子范数</h4><ul>
<li>矩阵范数使用特定的向量范数定义</li>
</ul>
<p>$$<br>\Vert{A}\Vert&#x3D;\max\dfrac{\Vert{Ax}\Vert}{\Vert{x}\Vert}<br>$$</p>
<ul>
<li><strong>矩阵1-范数是向量1-范数的算子范数</strong></li>
</ul>
<h5 id="1-范数证明"><a href="#1-范数证明" class="headerlink" title="1-范数证明"></a>1-范数证明</h5><ul>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/30674132">参考资料</a></li>
</ul>
<p>$$<br>\begin{aligned}<br>L&amp;&#x3D;\max\dfrac{\Vert{Ax}\Vert_1}{\Vert{x}\Vert_1}\<br>R&amp;&#x3D;\max_{j}\left(\sum_{i&#x3D;1}^{n}\vert{a_{ij}}\vert\right)\<br>\end{aligned}<br>$$</p>
<ul>
<li>思路：$L\le R,L\ge R$</li>
</ul>
<h6 id="L-le-R"><a href="#L-le-R" class="headerlink" title="$L\le R$"></a>$L\le R$</h6><p>$$<br>\begin{aligned}<br>{\Vert{Ax}\Vert_1}&#x3D;&amp;\sum_{i&#x3D;1}^{n}\left\vert\sum_{j&#x3D;1}^{n}a_{ij}x_j\right\vert\<br>\le&amp;\sum_{i&#x3D;1}^{n}\sum_{j&#x3D;1}^{n}\vert a_{ij}\vert\vert x_j\vert\<br>&#x3D;&amp;\sum_{j&#x3D;1}^{n}\sum_{i&#x3D;1}^{n}\vert a_{ij}\vert\vert x_j\vert\<br>&#x3D;&amp;\sum_{j&#x3D;1}^{n}\left(\vert x_j\vert\sum_{i&#x3D;1}^{n}\vert a_{ij}\vert\right)\<br>\le&amp;\sum_{j&#x3D;1}^{n}\left(\vert x_j\vert\max_{j}{\sum_{i&#x3D;1}^{n}\vert a_{ij}\vert}\right)\<br>&#x3D;&amp;\max_{j}{\sum_{i&#x3D;1}^{n}\vert a_{ij}\vert}\cdot\sum_{j&#x3D;1}^{n}\vert x_j\vert\<br>&#x3D;&amp;\max_{j}{\sum_{i&#x3D;1}^{n}\vert a_{ij}\vert}\cdot\Vert{x}\Vert_1<br>\end{aligned}<br>$$</p>
<h6 id="L-ge-R-构造"><a href="#L-ge-R-构造" class="headerlink" title="$L\ge R$ 构造"></a>$L\ge R$ 构造</h6><ul>
<li>构造 $\lambda$ 如下，$\lambda&#x3D;R$</li>
</ul>
<p>$$<br>\lambda&#x3D;\sum_{i&#x3D;1}^{n}{\vert{a_{is}}\vert}&#x3D;\max_{j}\sum_{i&#x3D;1}^{n}{\vert{a_{ij}}\vert},1\le{s}\le{n}<br>$$</p>
<ul>
<li>记 $A&#x3D;\left(\alpha_1,\cdots,\alpha_n\right)$</li>
<li>设 n 维向量 $\epsilon_{s}$ 如下，除了第 s 维为 1，其余都为 0</li>
</ul>
<p>$$<br>\epsilon_{s}&#x3D;{(0,0,\cdots,0,1,0,\cdots,0)}^{T}<br>$$</p>
<ul>
<li>那么有</li>
</ul>
<p>$$<br>{\Vert{A\epsilon_s}\Vert_1}&#x3D;{\Vert{\alpha_s}\Vert_1}&#x3D;\lambda&#x3D;\lambda\Vert{\epsilon_s}\Vert<br>$$</p>
<p>$$<br>\Rightarrow\dfrac{\Vert{A\epsilon_s}\Vert_1}{\Vert{\epsilon_s}\Vert_1}&#x3D;\lambda<br>$$</p>
<ul>
<li>于是</li>
</ul>
<p>$$<br>L&#x3D;\max\dfrac{\Vert{Ax}\Vert_1}{\Vert{x}\Vert_1}\ge\dfrac{\Vert{A\epsilon_s}\Vert_1}{\Vert{\epsilon_s}\Vert_1}&#x3D;\lambda&#x3D;R<br>$$</p>
<h5 id="无穷范数证明"><a href="#无穷范数证明" class="headerlink" title="无穷范数证明"></a>无穷范数证明</h5><p>$$<br>\begin{aligned}<br>L&amp;&#x3D;\max\dfrac{\Vert{Ax}\Vert_\infty}{\Vert{x}\Vert_\infty}\<br>R&amp;&#x3D;\max_{i}\left(\sum_{j&#x3D;1}^{n}\vert{a_{ij}}\vert\right)\<br>\end{aligned}<br>$$</p>
<h6 id="L-le-R-1"><a href="#L-le-R-1" class="headerlink" title="$L\le R$"></a>$L\le R$</h6><p>$$<br>\begin{aligned}<br>{\Vert{Ax}\Vert_\infty}&#x3D;&amp;\max_{i}\left\vert\sum_{j&#x3D;1}^{n}a_{ij}x_j\right\vert\<br>\le&amp;\max_{i}\sum_{j&#x3D;1}^{n}\vert a_{ij}\vert\vert x_j\vert\<br>\le&amp;\max_{i}\left(\sum_{j&#x3D;1}^{n}\vert a_{ij}\vert\max_{k}{\vert x_k\vert}\right)\<br>\le&amp;\max_{k}{\vert x_k\vert}\cdot\max_{i}\left(\sum_{j&#x3D;1}^{n}\vert a_{ij}\vert\right)\<br>&#x3D;&amp;{\Vert{x}\Vert_\infty}\cdot\max_{i}\left(\sum_{j&#x3D;1}^{n}\vert a_{ij}\vert\right)\<br>\end{aligned}<br>$$</p>
<h6 id="L-ge-R-构造-1"><a href="#L-ge-R-构造-1" class="headerlink" title="$L\ge R$ 构造"></a>$L\ge R$ 构造</h6><ul>
<li>$e^{i\theta}&#x3D;\cos\theta+i\sin\theta$</li>
<li>设 $\mu$ 如下，$\mu&#x3D;R$</li>
</ul>
<p>$$<br>\mu&#x3D;\sum_{j&#x3D;1}^{n}\vert{a_{sj}}\vert&#x3D;\max_{i}\left(\sum_{j&#x3D;1}^{n}\vert{a_{ij}}\vert\right)<br>$$</p>
<ul>
<li>记 $A&#x3D;\left(\alpha_1,\cdots,\alpha_n\right)$</li>
<li>记 $a_{ij}&#x3D;\vert{a_{ij}}\vert e^{i\theta_j}$</li>
<li>设 n 维向量 $z$ 如下</li>
</ul>
<p>$$<br>z&#x3D;(e^{-s\theta_1},\cdots,e^{-s\theta_n})\Rightarrow\Vert{z}\Vert_\infty&#x3D;1<br>$$</p>
<ul>
<li>那么有<ul>
<li>$\sum_{j&#x3D;1}^{n}{\vert{a_{ij}}\vert}e^{i\theta_j}e^{-s\theta_j}\le\sum_{j&#x3D;1}^{n}{\vert{a_{ij}}\vert}\le{\sum_{j&#x3D;1}^{n}{\vert{a_{sj}}\vert}}$<ul>
<li>$e^{i\theta_j}e^{-s\theta_j}\le1$，等号在 $i&#x3D;s$ 的时候取到</li>
<li>${\sum_{j&#x3D;1}^{n}{\vert{a_{ij}}\vert}}\le{\sum_{j&#x3D;1}^{n}{\vert{a_{sj}}\vert}}$，等号在 $i&#x3D;s$ 的时候取到</li>
</ul>
</li>
<li>同时，$\sum_{j&#x3D;1}^{n}{\vert{a_{ij}}\vert}e^{i\theta_j}e^{-s\theta_j}\ge-\sum_{j&#x3D;1}^{n}{\vert{a_{ij}}\vert}\ge-{\sum_{j&#x3D;1}^{n}{\vert{a_{sj}}\vert}}$</li>
</ul>
</li>
</ul>
<p>$$<br>{\Vert{Az}\Vert_\infty}&#x3D;\max_{i}\left\vert{\sum_{j&#x3D;1}^{n}{\vert{a_{ij}}\vert}e^{i\theta_j}e^{-s\theta_j}}\right\vert&#x3D;\left\vert{\sum_{j&#x3D;1}^{n}{\vert{a_{sj}}\vert}}\right\vert&#x3D;\mu&#x3D;\mu\Vert{z}\Vert_\infty<br>$$</p>
<p>$$<br>\Rightarrow\dfrac{\Vert{Az}\Vert_\infty}{\Vert{z}\Vert_\infty}&#x3D;\mu<br>$$</p>
<ul>
<li>于是</li>
</ul>
<p>$$<br>L&#x3D;\max\dfrac{\Vert{Ax}\Vert_\infty}{\Vert{x}\Vert_\infty}\ge\dfrac{\Vert{Az}\Vert_\infty}{\Vert{z}\Vert_\infty}&#x3D;\mu&#x3D;R<br>$$</p>
<h5 id="希尔伯特矩阵"><a href="#希尔伯特矩阵" class="headerlink" title="希尔伯特矩阵"></a>希尔伯特矩阵</h5><p>$$<br>H_{ij}&#x3D;\dfrac{1}{i+j-1}<br>$$</p>
<ul>
<li>希尔伯特矩阵的条件数很大</li>
<li>解线性方程组 $Hx&#x3D;b$ 就是一个病态问题</li>
</ul>
<h5 id="定理"><a href="#定理" class="headerlink" title="定理"></a>定理</h5><ul>
<li>由定义，有</li>
</ul>
<p>$$<br>{\Vert{Ax}\Vert}\le\Vert{A}\Vert\cdot{\Vert{x}\Vert}<br>$$</p>
<h4 id="条件数证明"><a href="#条件数证明" class="headerlink" title="条件数证明"></a>条件数证明</h4><ul>
<li>由 $A(x-x_a)&#x3D;r$，可以得到 $x-x_a&#x3D;A^{-1}r$，于是有</li>
</ul>
<p>$$<br>\Vert{x-x_a}\Vert\le\Vert{A^{-1}}\Vert\cdot\Vert{r}\Vert<br>$$</p>
<ul>
<li>因为 $Ax&#x3D;b$，于是有</li>
</ul>
<p>$$<br>{\Vert{b}\Vert}\le\Vert{A}\Vert\cdot{\Vert{x}\Vert}<br>$$</p>
<p>$$<br>\Rightarrow\dfrac{1}{\Vert{A}\Vert}\cdot\dfrac{1}{\Vert{x}\Vert}\le\dfrac{1}{\Vert{b}\Vert}<br>$$</p>
<ul>
<li>因此有</li>
</ul>
<p>$$<br>\dfrac{\Vert{x-x_a}\Vert}{\Vert{x}\Vert}\le\Vert{A^{-1}}\Vert\Vert{A}\Vert\cdot\dfrac{\Vert{r}\Vert}{\Vert{b}\Vert}<br>$$</p>
<ul>
<li>一般情况下可以取到等号，<strong>根据证明过程构造即可</strong></li>
</ul>
<h3 id="3-2-淹没-swamp"><a href="#3-2-淹没-swamp" class="headerlink" title="3.2 淹没 swamp"></a>3.2 淹没 swamp</h3><ul>
<li>方程组</li>
</ul>
<p>$$<br>\begin{aligned}<br>\left{<br>\begin{array}{rcrr}<br>10^{-20}x_1&amp;+&amp;x_2&amp;&#x3D;1\<br>x_1&amp;+&amp;2x_2&amp;&#x3D;4<br>\end{array}<br>\right.<br>\end{aligned}<br>$$</p>
<ul>
<li>当<strong>乘子很大</strong>的时候，我们发现将第一行式子成大第二行上面的时候，第二行的式子会被淹没（swamp）<ul>
<li>精度问题导致的</li>
</ul>
</li>
<li>因此我们可以通过交换两行顺序的方法，让乘子的绝对值小于 1，避免上述情况发生</li>
<li><strong>部分主元方法</strong></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/02/computation/pyr/03/" data-id="cl9lj74aa00bm64tz1y502ijd" data-title="计算方法B.裴玉茹.03.方程组" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/computation/" rel="tag">computation</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-computation/pyr/02-1" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/02/computation/pyr/02-1/" class="article-date">
  <time class="dt-published" datetime="2021-10-02T12:09:44.000Z" itemprop="datePublished">2021-10-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/computation-pyr/">computation.pyr</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/10/02/computation/pyr/02-1/">计算方法B.裴玉茹.02.非线性方程迭代求解(2)</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ul>
<li>数值分析课本第 1 章（求解方程） + PPT（非线性方程迭代求解）</li>
</ul>
<h1 id="计算方法B"><a href="#计算方法B" class="headerlink" title="计算方法B"></a>计算方法B</h1><h2 id="4-牛顿法"><a href="#4-牛顿法" class="headerlink" title="4. 牛顿法"></a>4. 牛顿法</h2><ul>
<li>牛顿——拉夫逊方法</li>
<li>给定初始估计 $x_0$，画出函数 $f$ 在 $x_0$ 的切线，用切线来近似函数 $f$，求出其与 $x$ 轴的交点作为 $f$ 的根</li>
</ul>
<img src="02-1/image-20210927142236037.jpg" style="zoom:67%;" />

<ul>
<li><strong>算法流程</strong></li>
</ul>
<p>$$<br>\begin{aligned}<br>\begin{array}{c}<br>x_0&#x3D;初始估计\<br>x_{i+1}&#x3D;x_{i}-\dfrac{f(x_i)}{f’(x_i)}\<br>\end{array}<br>\end{aligned}<br>$$</p>
<ul>
<li>推导<ul>
<li>切线：$y&#x3D;f’(x_i)(x-x_i)+f(x_i)$</li>
<li>令 $y&#x3D;0$ 即可</li>
</ul>
</li>
</ul>
<h3 id="二次收敛"><a href="#二次收敛" class="headerlink" title="二次收敛"></a>二次收敛</h3><p>$$<br>M&#x3D;\lim_{i\to\infty}\dfrac{e_{i+1}}{e^2_{i}}&lt;\infty<br>$$</p>
<ul>
<li><span id="newton"><strong>牛顿方法是二次收敛的</strong></span><ul>
<li>令 $f$ 是二阶连续可微函数，$f(r)&#x3D;0$，如果 $f’(r)\ne0$，则牛顿方法局部收敛到 $r$</li>
<li>第 $i$ 步的误差 $e_i$ 满足如下式子</li>
</ul>
</li>
</ul>
<p>$$<br>\lim_{i\to\infty}\dfrac{e_{i+1}}{e^2_{i}}&#x3D;M&#x3D;\dfrac{f’’(r)}{2f’(r)}<br>$$</p>
<ul>
<li><strong>证明</strong><ul>
<li><strong>局部收敛</strong>：FPI 的特殊情况，可以计算得到 $g’(r)&#x3D;0&lt;1$</li>
<li><strong>二次收敛</strong>：<strong>泰勒展开</strong>，要求 $f’(r)\ne0$</li>
</ul>
</li>
</ul>
<p>$$<br>\begin{aligned}<br>\begin{array}{c}<br>0&#x3D;f(r)&#x3D;f(x_i)+(r-x_i)f’(x_i)+\dfrac{(r-x_i)^2}{2}f’’(c)\<br>x_{i}-\dfrac{f(x_i)}{f’(x_i)}-r&#x3D;\dfrac{(r-x_i)^2}{2f’(x_i)}f’’(c)\<br>e_{i+1}&#x3D;\dfrac{e_i^2}{2f’(x_i)}f’’(c)\<br>\dfrac{e_{i+1}}{e^2_{i}}&#x3D;\dfrac{f’’(c)}{2f’(x_i)}\<br>c\ 和\ x_i\ 都会收敛到\ r\Rightarrow\lim_{i\to\infty}\dfrac{e_{i+1}}{e^2_{i}}&#x3D;\dfrac{f’’(r)}{2f’(r)}\<br>\end{array}<br>\end{aligned}<br>$$</p>
<ul>
<li>误差公式近似为 $e_{i+1}\approx Me^2_{i}$</li>
</ul>
<h3 id="重根"><a href="#重根" class="headerlink" title="重根"></a>重根</h3><img src="02-1/image-20210928114840328.jpg" style="zoom:67%;" />

<ul>
<li>如果不满足 $f’(r)\ne0$，则收敛速度变为线性<ul>
<li>例子：$f(x)&#x3D;x^{m}$ 求根</li>
<li>牛顿公式：$x_{i+1}&#x3D;x_i-\dfrac{x^{m}_i}{mx^{m-1}<em>i}&#x3D;\dfrac{m-1}{m}x</em>{i}$</li>
</ul>
</li>
</ul>
<img src="02-1/image-20210927153913039.jpg" style="zoom: 67%;" />



<h4 id="修正方法1"><a href="#修正方法1" class="headerlink" title="修正方法1"></a>修正方法1</h4><img src="02-1/image-20210927154343927.jpg" style="zoom:67%;" />



<h4 id="修正方法2"><a href="#修正方法2" class="headerlink" title="修正方法2"></a>修正方法2</h4><p>$$<br>\mu(x)&#x3D;\dfrac{f(x)}{f’(x)}<br>$$</p>
<p>$$<br>\begin{aligned}<br>\mu(x)&#x3D;&amp;\dfrac{(x-p)^mq(x)}{m(x-p)^{m-1}q(x)+(x-p)^mq’(x)}\<br>&#x3D;&amp;{\color{red}(x-p)}\dfrac{q(x)}{mq(x)+(x-p)q’(x)}\<br>\end{aligned}<br>$$</p>
<ul>
<li>发现 $p$ 是 $\mu$ 的单根</li>
</ul>
<p>$$<br>\dfrac{q(p)}{mq(p)+(p-p)q’(x)}&#x3D;\dfrac{1}{m}\ne0<br>$$</p>
<ul>
<li>关于 $\mu$ 应用牛顿方法</li>
</ul>
<p>$$<br>g(x)&#x3D;x-\dfrac{f(x)f’(x)}{[f’(x)]^2-f(x)f’’(x)}<br>$$</p>
<ul>
<li>在单根的情况下，修正牛顿方法和原始牛顿方法的收敛速度都快，但是需要更大的计算量</li>
</ul>
<h3 id="牛顿方法失效"><a href="#牛顿方法失效" class="headerlink" title="牛顿方法失效"></a>牛顿方法失效</h3><ul>
<li>例子</li>
</ul>
<p>$$<br>f(x)&#x3D;4x^4-6x^2-\dfrac{11}{4},x_0&#x3D;\dfrac{1}{2}<br>$$</p>
<ul>
<li>只有在根近邻的初始估计才能收敛到根</li>
</ul>
<h2 id="5-不需要导数的根求解"><a href="#5-不需要导数的根求解" class="headerlink" title="5. 不需要导数的根求解"></a>5. 不需要导数的根求解</h2><ul>
<li>导数需要除以一个较小的值，这样可能会引入误差</li>
</ul>
<h3 id="割线方法"><a href="#割线方法" class="headerlink" title="割线方法"></a>割线方法</h3><ul>
<li>使用差商来代替导数</li>
</ul>
<p>$$<br>\dfrac{f(x_i)-f(x_{i-1})}{x_i-x_{i-1}}<br>$$</p>
<p>$$<br>f’(x_{i-1})&#x3D;\lim_{x_{i}\to{x_{i-1}}}\dfrac{f(x_i)-f(x_{i-1})}{x_i-x_{i-1}}<br>$$</p>
<ul>
<li>算法流程</li>
</ul>
<p>$$<br>\begin{aligned}<br>\begin{array}{c}<br>x_0,x_1&#x3D;初始估计\<br>x_{i+1}&#x3D;x_{i}-\dfrac{f(x_i)(x_i-x_{i-1})}{f(x_i)-f(x_{i-1})}\<br>\end{array}<br>\end{aligned}<br>$$</p>
<ul>
<li>误差分析<ul>
<li>第一个式子可以通过割线方法的递推式推导得到（右边通分，构造出 3 个误差项）</li>
<li>第二个式子将一般形式 $e_{i+1}&#x3D;Ce_{i}^k$ 代入第一个式子解出来即可</li>
</ul>
</li>
</ul>
<img src="02-1/image-20210927160440330.jpg" style="zoom:67%;" />

<ul>
<li><strong>超线性收敛</strong></li>
</ul>
<h3 id="割线方法的推广形式"><a href="#割线方法的推广形式" class="headerlink" title="割线方法的推广形式"></a>割线方法的推广形式</h3><h4 id="试位方法"><a href="#试位方法" class="headerlink" title="试位方法"></a>试位方法</h4><ul>
<li>Regula Falsi 方法</li>
<li>与<strong>二分法</strong>相似，但是其中的中点被割线和 $x$ 轴的交点代替</li>
</ul>
<p>$$<br>\begin{aligned}<br>\begin{array}{rl}<br>割线:&amp;y&#x3D;\dfrac{f(a)-f(b)}{a-b}(x-a)+f(a)\<br>令\ y&#x3D;0:&amp;x&#x3D;\dfrac{bf(a)-af(b)}{f(a)-f(b)}<br>\end{array}<br>\end{aligned}<br>$$</p>
<ul>
<li>算法流程</li>
</ul>
<img src="02-1/image-20210927161920043.jpg" style="zoom:67%;" />

<ul>
<li>试位方法可能在某些例子中收敛的更慢</li>
<li><strong>不保证收敛</strong></li>
</ul>
<h4 id="Muller-方法"><a href="#Muller-方法" class="headerlink" title="Muller 方法"></a>Muller 方法</h4><ul>
<li>通过之前计算的 3 个点（$x_0,x_1,x_2$），画出他们的抛物线 $y&#x3D;p(x)$，求出和 $x$ 轴的交点，作为接下来对 $x$ 的近似估计<ul>
<li>如果有 2 个交点，选择离 $x_2$ 较近的点</li>
<li>如果有 0 个交点，出现复数解</li>
</ul>
</li>
</ul>
<h4 id="逆二次插值-IQI"><a href="#逆二次插值-IQI" class="headerlink" title="逆二次插值 IQI"></a>逆二次插值 IQI</h4><ul>
<li>和 Muller 方法相同，但是使用的抛物线是 $x&#x3D;p(y)$，保证和 $x$ 轴只有一个交点</li>
</ul>
<img src="02-1/image-20210927164249863.jpg" style="zoom:67%;" />

<ul>
<li>拉格朗日插值的一个例子</li>
<li>迭代更新的两种方法<ul>
<li>$x_i,x_{i-1},x_{i-2}$ 更新为 $x_{i+1},x_i,x_{i-1}$</li>
<li>$x_i,x_{i-1},x_{i-2}$ 中去掉后向误差最大的那个，然后加上 $x_{i+1}$</li>
</ul>
</li>
<li>Muller 方法和逆二次插值 IQI 比割线方法收敛更快（<strong>更高阶的插值计算</strong>）</li>
</ul>
<h3 id="Brent-方法"><a href="#Brent-方法" class="headerlink" title="Brent 方法"></a>Brent 方法</h3><ul>
<li>混合迭代技术</li>
<li>兼具：二分法的保证收敛性质、更加复杂方法的快速收敛性质</li>
<li>Dekker 和 Van Wijingaarden 提出（20 世纪 60 年代）</li>
</ul>
<img src="02-1/image-20210927165124959.jpg" style="zoom:67%;" />



<h2 id="6-PPT-补充"><a href="#6-PPT-补充" class="headerlink" title="6. PPT 补充"></a>6. PPT 补充</h2><h3 id="不动点存在且唯一"><a href="#不动点存在且唯一" class="headerlink" title="不动点存在且唯一"></a>不动点存在且唯一</h3><ul>
<li><strong>不是充要条件</strong></li>
<li>如果满足如下两个条件，则<strong>不动点存在且唯一</strong></li>
</ul>
<img src="02-1/image-20210927171646046.jpg" style="zoom:67%;" />

<ul>
<li>条件：<strong>自身映射</strong>、<strong>连续</strong>、<strong>导数小于1</strong></li>
<li>证明<ul>
<li>存在性：设函数 $h(x)&#x3D;g(x)-x&#x3D;0$，要么端点成立，要么由介值定理存在一个数使其成立</li>
<li>唯一性：假设存在两个 $p,q$，推出矛盾</li>
</ul>
</li>
</ul>
<p>$$<br>\vert{p-q}\vert&#x3D;\vert{g(p)-g(q)}\vert&#x3D;g’(\xi)\vert{p-q}\vert&lt;\vert{p-q}\vert<br>$$</p>
<h3 id="不动点迭代收敛"><a href="#不动点迭代收敛" class="headerlink" title="不动点迭代收敛"></a>不动点迭代收敛</h3><img src="02-1/image-20210927172949309.jpg" style="zoom:67%;" />

<ul>
<li>条件：<strong>自身映射</strong>、<strong>连续</strong>、<strong>导数小于1</strong></li>
<li>证明：<strong>中值定理</strong></li>
</ul>
<p>$$<br>\begin{aligned}<br>\begin{array}{c}<br>\vert{p_{n}-p}\vert&#x3D;\vert{g(p_{n-1})-g(p)}\vert&#x3D;\vert{g’(\xi)}\vert\vert{p_{n-1}-p}\vert\<br>\vert{p_{n}-p}\vert\le k\vert{p_{n-1}-p}\vert\le\cdots\le k^{n}\vert{p_0-p}\vert\<br>\lim_{n\to\infty}\vert{p_{n}-p}\vert&#x3D;\lim_{n\to\infty}k^n\vert{p_{0}-p}\vert&#x3D;0\<br>\end{array}<br>\end{aligned}<br>$$</p>
<h4 id="推论"><a href="#推论" class="headerlink" title="推论"></a>推论</h4><ul>
<li>如果函数 $g$ 满足不动点定理, 则利用 $p_n$ 近似 $p$ 的误差界如下</li>
</ul>
<p>$$<br>\begin{aligned}<br>\begin{array}{c}<br>\vert{p_{n}-p}\vert\le k^{n}\max{p_0-a,b-p_0}\<br>\vert{p_{n}-p}\vert\le \dfrac{k^{n}}{1-k}\vert{p_1-p_0}\vert\<br>\end{array}<br>\end{aligned}<br>$$</p>
<ul>
<li>第一个式子显然</li>
<li>第二个式子</li>
</ul>
<p>$$<br>\begin{aligned}<br>\begin{array}{c}<br>\vert{p_{n+1}-p_{n}}\vert&#x3D;\vert{g(p_{n})-g(p_{n-1})}\vert&#x3D;\vert{g’(\xi)}\vert\vert{p_{n}-p_{n-1}}\vert\le k\vert{p_{n}-p_{n-1}}\vert\<br>\vert{p_{n+1}-p_{n}}\vert\le k\vert{p_{n}-p_{n-1}}\vert\le\cdots\le k^{n}\vert{p_1-p_0}\vert\<br>\end{array}<br>\end{aligned}<br>$$</p>
<p>$$<br>\begin{aligned}<br>\begin{array}{rl}<br>\vert{p_{m}-p_{n}}\vert&amp;&#x3D;\vert{p_{m}-p_{m-1}+p_{m-1}-\cdots-p_{n}}\vert\<br>&amp;\le\vert{p_{m}-p_{m-1}}\vert+\vert{p_{m-1}-p_{m-2}}\vert\cdots\vert{p_{n+1}-p_{n}}\vert\<br>&amp;&#x3D;\vert{p_1-p_0}\vert(k^{m-1}+k^{m-2}+\cdots+k^{n})\<br>&amp;&#x3D;\vert{p_1-p_0}\vert k^{n}(k^{m-n-1}+\cdots+1)\<br>\end{array}<br>\end{aligned}<br>$$</p>
<p>$$<br>\begin{aligned}<br>\begin{array}{rl}<br>\vert{p-p_{n}}\vert&amp;&#x3D;\lim_{m\to\infty}\vert{p_m-p_n}\vert\<br>&amp;\le\lim_{m\to\infty}\vert{p_1-p_0}\vert k^{n}(k^{m-n-1}+\cdots+1)\<br>&amp;&#x3D;\vert{p_1-p_0}\vert k^{n}\sum_{i&#x3D;0}^{\infty}{k^i}\<br>&amp;&#x3D;\dfrac{k^{n}}{1-k}\vert{p_1-p_0}\vert\<br>\end{array}<br>\end{aligned}<br>$$</p>
<h3 id="牛顿法"><a href="#牛顿法" class="headerlink" title="牛顿法"></a>牛顿法</h3><img src="02-1/image-20210928094753843.jpg" style="zoom:67%;" />

<ul>
<li>证明方法<ul>
<li>自身映射，导数小于 1（连续）</li>
</ul>
</li>
<li>在满足假设条件的情况下，只要选择足够精确的初始近似，牛顿法就会收敛</li>
<li>缺点：需要知道 $f$ 在每个近似点的导数</li>
</ul>
<h3 id="迭代方法的误差"><a href="#迭代方法的误差" class="headerlink" title="迭代方法的误差"></a>迭代方法的误差</h3><ul>
<li><strong>收敛速度</strong></li>
</ul>
<img src="02-1/image-20210928105824087.jpg" style="zoom:67%;" />

<ul>
<li>总结</li>
</ul>
<img src="02-1/image-20210928110000710.jpg" style="zoom:67%;" />



<h3 id="线性收敛"><a href="#线性收敛" class="headerlink" title="线性收敛"></a>线性收敛</h3><ul>
<li>自身映射、连续、导数小于1</li>
</ul>
<img src="02-1/image-20210928111249471.jpg" style="zoom:67%;" />



<h3 id="二阶收敛"><a href="#二阶收敛" class="headerlink" title="二阶收敛"></a>二阶收敛</h3><ul>
<li>证明方法就是上面的牛顿方法<a href="#newton">证明</a></li>
</ul>
<img src="02-1/image-20210928111530871.jpg" style="zoom:67%;" />

<ul>
<li>在有限的迭代后，二阶收敛所能达到的有效数字的位数<strong>远大于</strong>线性收敛所能达到的有效数字的位数</li>
<li>构造二阶收敛</li>
</ul>
<p>$$<br>\begin{aligned}<br>\begin{array}{cr}<br>g(x)&#x3D;x-\phi(x)f(x)&amp;\<br>0&#x3D;g’(p)&#x3D;1-\phi’(p)f(p)-\phi(p)f’(p)&#x3D;1-\phi(p)f’(p),&amp;f(p)&#x3D;0\<br>\phi(x)&#x3D;\dfrac{1}{f’(x)}&amp;\<br>p_{n+1}&#x3D;p_{n}-\dfrac{f(p_{n})}{f’(p_{n})}<br>\end{array}<br>\end{aligned}<br>$$</p>
<h3 id="高阶收敛"><a href="#高阶收敛" class="headerlink" title="高阶收敛"></a>高阶收敛</h3><ul>
<li><strong>形式上看和泰勒展开一致</strong></li>
</ul>
<img src="02-1/image-20210928112838271.jpg" style="zoom:67%;" />





<h3 id="加速收敛"><a href="#加速收敛" class="headerlink" title="加速收敛"></a>加速收敛</h3><ul>
<li>$\mathrm{Aitken’s}\ \Delta^2$方法</li>
<li>加速任何线性收敛的序列<ul>
<li>引入了更多的计算达到<strong>超线性收敛</strong></li>
<li>每次根据之前的 3 个估计进行加速</li>
</ul>
</li>
</ul>
<img src="02-1/image-20210928135724178.jpg" style="zoom:67%;" />

<ul>
<li>$n$ 足够大的时候</li>
</ul>
<p>$$<br>\dfrac{p_{n+1}-p}{p_n-p}\approx\dfrac{p_{n+2}-p}{p_{n+1}-p}<br>$$</p>
<p>$$<br>p\approx \dfrac{p_{n}p_{n+2}-p_{n+1}^2}{p_n-2p_{n+1}+p_{n+2}}&#x3D;p_n-\dfrac{(p_{n+1}-p_{n})^2}{p_n-2p_{n+1}+p_{n+2}}<br>$$</p>
<p>$$<br>\hat{p}&#x3D;p_n-\dfrac{(p_{n+1}-p_{n})^2}{p_n-2p_{n+1}+p_{n+2}}<br>$$</p>
<ul>
<li>考虑前向差分公式</li>
</ul>
<p>$$<br>\begin{aligned}<br>\begin{array}{c}<br>\Delta{p_i}&#x3D;p_{i+1}-p_{i}\<br>\Delta^k{p_i}&#x3D;\Delta^{k-1}(\Delta{p_i})&#x3D;\Delta^{k-1}{p_{i+1}}-\Delta^{k-1}{p_{i}}\<br>\hat{p}&#x3D;p_n-\dfrac{(\Delta{p_{n}})^2}{\Delta^2{p_{n}}}<br>\end{array}<br>\end{aligned}<br>$$</p>
<ul>
<li>每 3 个估计值更新一次<ul>
<li><strong>超线性收敛</strong></li>
</ul>
</li>
</ul>
<img src="02-1/image-20210928141816384.jpg" style="zoom:67%;" />

<ul>
<li>更新之后的值马上用来计算<ul>
<li><strong>二阶收敛</strong></li>
</ul>
</li>
</ul>
<img src="02-1/image-20210928142125048.jpg" style="zoom:67%;" />
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/02/computation/pyr/02-1/" data-id="cl9lj74a800bc64tz6nyc5l5b" data-title="计算方法B.裴玉茹.02.非线性方程迭代求解(2)" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/computation/" rel="tag">computation</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-csharp/tds/03-1" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/02/csharp/tds/03-1/" class="article-date">
  <time class="dt-published" datetime="2021-10-02T12:05:10.000Z" itemprop="datePublished">2021-10-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/csharp-tds/">csharp.tds</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/10/02/csharp/tds/03-1/">C#程序设计.唐大仕.03.面向对象的C#语言(2)</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ul>
<li><a target="_blank" rel="noopener" href="https://www.icourse163.org/learn/PKU-1001663016">中国大学慕课</a></li>
</ul>
<h1 id="面向对象的C-语言"><a href="#面向对象的C-语言" class="headerlink" title="面向对象的C#语言"></a>面向对象的C#语言</h1><h2 id="4-修饰符"><a href="#4-修饰符" class="headerlink" title="4. 修饰符"></a>4. 修饰符</h2><h3 id="访问控制符"><a href="#访问控制符" class="headerlink" title="访问控制符"></a>访问控制符</h3><table>
<thead>
<tr>
<th align="center">访问控制符</th>
<th align="center">同类中</th>
<th align="center">相同程序集的<br />子类</th>
<th align="center">相同程序集的<br />非子类</th>
<th align="center">不同程序集的<br />子类</th>
<th align="center">不同程序集的<br />非子类</th>
</tr>
</thead>
<tbody><tr>
<td align="center">public</td>
<td align="center">$\checkmark$</td>
<td align="center">$\checkmark$</td>
<td align="center">$\checkmark$</td>
<td align="center">$\checkmark$</td>
<td align="center">$\checkmark$</td>
</tr>
<tr>
<td align="center">protected internal</td>
<td align="center">$\checkmark$</td>
<td align="center">$\checkmark$</td>
<td align="center">$\checkmark$</td>
<td align="center">$\checkmark$</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">protected</td>
<td align="center">$\checkmark$</td>
<td align="center">$\checkmark$</td>
<td align="center"></td>
<td align="center">$\checkmark$</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">internal</td>
<td align="center">$\checkmark$</td>
<td align="center">$\checkmark$</td>
<td align="center">$\checkmark$</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">private</td>
<td align="center">$\checkmark$</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody></table>
<ul>
<li>protected 保证子类（逻辑），internal 保证相同程序集（物理）</li>
<li>程序集：项目编译成同一个 exe 和 dll 文件，这一组文件称为一个程序集</li>
</ul>
<h3 id="static"><a href="#static" class="headerlink" title="static"></a>static</h3><ul>
<li>static的字段、方法、属性是属于整个类的</li>
<li>static 方法中，不能访问实例变量<ul>
<li>例如不能使用 this</li>
</ul>
</li>
<li>调用 static 方法时，<strong>直接用类名访问</strong></li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Console.WriteLine(<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>static 变量可以用来表示<strong>全局变量</strong><ul>
<li>定义一个类，里面的所有变量都是 static 的，当作全局变量使用</li>
</ul>
</li>
<li>在 c#2.0 中，类名也可以用 static 来修饰<ul>
<li>称为 static 类</li>
<li>所有字段、方法都是 static 的</li>
</ul>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title">StaticClass</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> A;</span><br><span class="line">    <span class="comment">// public int B; // error CS0708: &quot;StaticClass.B&quot;: 不能在静态类中声明实例成员</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="static-构造方法"><a href="#static-构造方法" class="headerlink" title="static 构造方法"></a>static 构造方法</h3><ul>
<li>static 构造方法只会调用一次，但其调用时间是不确定的</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Person</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> TotalNum;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="title">Person</span>()</span> &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Person: static constructor&quot;</span>);</span><br><span class="line">        TotalNum = <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span>()</span> &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Person: constructor&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span> &#123;</span><br><span class="line">        Person p = <span class="keyword">new</span> Person();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* output</span></span><br><span class="line"><span class="comment">Person: static constructor</span></span><br><span class="line"><span class="comment">Person: constructor</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>



<h3 id="const-与-readonly"><a href="#const-与-readonly" class="headerlink" title="const 与 readonly"></a>const 与 readonly</h3><ul>
<li>const 相当于静态常量<ul>
<li>Math.PI</li>
</ul>
</li>
<li>readonly 相当于不可改量，只能赋一次值<ul>
<li>String.Empty</li>
<li>在构造方法中赋值，或者在声明时就赋值</li>
</ul>
</li>
<li>const 只能用于基本类型及 string</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Person</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span>(<span class="params"><span class="built_in">string</span> name</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.Name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span> &#123;</span><br><span class="line">        Person p1 = <span class="keyword">new</span> Person(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">        <span class="comment">// const Person p2 = p1; // error CS0133: 指派给 &quot;p2&quot; 的表达式必须是常量</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> <span class="built_in">string</span> s1 = <span class="string">&quot;string&quot;</span>;</span><br><span class="line">        <span class="comment">// s1 = &quot;s&quot;; //  error CS0131: 赋值号左边必须是变量、属性或索引器</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>readonly 只能修饰字段，而 const 还可以修饰局部变量</li>
</ul>
<h3 id="sealed-和-abstract"><a href="#sealed-和-abstract" class="headerlink" title="sealed 和 abstract"></a>sealed 和 abstract</h3><ul>
<li>sealed类，不可继承(也有利于编译优化)<ul>
<li>如 String  Console  Math  Convert Graphics Font</li>
</ul>
</li>
<li>abstract类，不可实例化（new）<ul>
<li>如 Array, RandomNumberGenerator</li>
<li>abstract 的方法体，不用{}，用;<ul>
<li>abstract  类型 方法名(参数列表);</li>
<li>abstract  类型 属性名{get;set;}</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过编译</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title">AbstractClass</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AbstractClass</span>()</span> &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;AbstractClass: constructor&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">fun1</span>()</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fun2</span>()</span> &#123; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> A;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="5-接口"><a href="#5-接口" class="headerlink" title="5. 接口"></a>5. 接口</h2><ul>
<li>接口实际上是一个约定<ul>
<li>如：ICloneable、IComparable</li>
</ul>
</li>
<li>接口是抽象成员的集合<ul>
<li>ICloneable 含有方法 clone()</li>
<li>IComparable 含有方法 compare()</li>
</ul>
</li>
<li><strong>接口是一个引用类型，比抽象类更抽象</strong></li>
</ul>
<h3 id="接口能够帮助实现多重继承"><a href="#接口能够帮助实现多重继承" class="headerlink" title="接口能够帮助实现多重继承"></a>接口能够帮助实现多重继承</h3><ul>
<li>例子</li>
</ul>
<img src="03-1/image-20211002130915314.jpg" style="zoom:67%;" />



<h3 id="接口的用处"><a href="#接口的用处" class="headerlink" title="接口的用处"></a>接口的用处</h3><ul>
<li>实现不相关类的相同行为<ul>
<li>不需要考虑这些类之间的层次关系</li>
</ul>
</li>
<li>通过接口可以了解对象的交互界面，而不需了解对象所对应的类</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="title">String</span> :</span><br><span class="line"><span class="title">IComparable</span>, <span class="title">ICloneable</span>, <span class="title">IConvertible</span>, <span class="title">IEnumerable</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="定义一个接口"><a href="#定义一个接口" class="headerlink" title="定义一个接口"></a>定义一个接口</h3><ul>
<li>所有的接口都是 public、abstract 的，但是不需要显式声明<ul>
<li><strong>不能显式写出来</strong></li>
</ul>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IStringList</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Add</span>(<span class="params"><span class="built_in">string</span> s</span>)</span>;</span><br><span class="line">    <span class="built_in">int</span> Count &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line">    <span class="built_in">string</span> <span class="keyword">this</span>[<span class="built_in">int</span> index] &#123; <span class="keyword">get</span>;<span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="实现接口"><a href="#实现接口" class="headerlink" title="实现接口"></a>实现接口</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> 类名 : [父类, ] 接口, 接口, ..., 接口 &#123;</span><br><span class="line">    <span class="comment">// 实现接口的方法</span></span><br><span class="line">    <span class="keyword">public</span> 方法 () &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="显式接口成员实现"><a href="#显式接口成员实现" class="headerlink" title="显式接口成员实现"></a>显式接口成员实现</h3><ul>
<li>在实现多个接口时，如果不同的接口有同名的方法，</li>
<li>为了消除歧义，<strong>需要在方法名前写接口名</strong></li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> IWindow.Close () &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>调用时，<strong>只能用接口调用</strong>（强制类型转换）</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((IWindow)f).Close();</span><br></pre></td></tr></table></figure>

<ul>
<li>例子</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">class</span> <span class="title">InterfaceExplicitImpl</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span> &#123;</span><br><span class="line">        FileViewer f = <span class="keyword">new</span> FileViewer();</span><br><span class="line">        f.Test();</span><br><span class="line">        ((IWindow)f).Close();</span><br><span class="line">        IWindow w = <span class="keyword">new</span> FileViewer();</span><br><span class="line">        w.Close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title">IWindow</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Close</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title">IFileHandler</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Close</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">FileViewer</span> : <span class="title">IWindow</span>, <span class="title">IFileHandler</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> IWindow.Close () &#123;</span><br><span class="line">        Console.WriteLine( <span class="string">&quot;Window Closed&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> IFileHandler.Close() &#123;</span><br><span class="line">        Console.WriteLine( <span class="string">&quot;File Closed&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Test</span>()</span> &#123;</span><br><span class="line">        ((IWindow)<span class="keyword">this</span>).Close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="6-结构及枚举"><a href="#6-结构及枚举" class="headerlink" title="6. 结构及枚举"></a>6. 结构及枚举</h2><h3 id="结构-struct"><a href="#结构-struct" class="headerlink" title="结构 struct"></a>结构 struct</h3><ul>
<li>结构常用来表示较简单的多个分量（字段）</li>
<li>Point、Color、Size、DateTime、Int32</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> Int32 :</span><br><span class="line">IComparable, IFormattable, IConvertible,</span><br><span class="line">IComparable&lt;<span class="built_in">int</span>&gt;, IEquatable&lt;<span class="built_in">int</span>&gt; &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>可以有方法、属性等其他成员</strong></li>
</ul>
<h3 id="结构的例子"><a href="#结构的例子" class="headerlink" title="结构的例子"></a>结构的例子</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> Point &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> x, y;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Point</span>(<span class="params"><span class="built_in">double</span> x, <span class="built_in">double</span> y</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.x = x;</span><br><span class="line">        <span class="keyword">this</span>.y = y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">double</span> <span class="title">R</span>()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Math.Sqrt(x*x+y*y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="结构和类的区别"><a href="#结构和类的区别" class="headerlink" title="结构和类的区别"></a>结构和类的区别</h3><ul>
<li><strong>struct 是值类型</strong><ul>
<li>结构<strong>不能包含无参数构造方法</strong></li>
<li>每个字段在定义时，不能给初始值</li>
<li>构造方法中，必须对每个字段进行赋值</li>
</ul>
</li>
<li>struct 是 sealed 的，不能被继承</li>
<li>实例化时，使用 new，<strong>但与引用型变量的内存是不同的</strong></li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Point p = <span class="keyword">new</span> Point(<span class="number">100</span>,<span class="number">80</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>值类型变量在赋值时，实行的是字段的 copy</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> MPoint &#123;</span><br><span class="line">    <span class="comment">// public double x = 1.0, y = 1.0;</span></span><br><span class="line">    <span class="comment">// error CS0573: &quot;MPoint&quot;: 结构中不能实例属性或字段初始值设定项</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> x, y;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// error CS0568: 结构不能包含显式的无参数构造函数</span></span><br><span class="line">    <span class="comment">// public MPoint() &#123;&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MPoint</span>(<span class="params"><span class="built_in">double</span> x, <span class="built_in">double</span> y</span>)</span> &#123;</span><br><span class="line">         <span class="keyword">this</span>.x = x;</span><br><span class="line">         <span class="comment">// 如果注释掉上面一行的赋值语句则报错</span></span><br><span class="line">         <span class="comment">// error CS0171: 在控制返回调用方之前，字段&quot;MPoint.x&quot;必须完全赋值</span></span><br><span class="line">         <span class="keyword">this</span>.y = y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 接口列表中的类型 &quot;MPoint&quot; 不是接口</span></span><br><span class="line"><span class="comment">// error CS0527: struct MMPoint : MPoint &#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title">AA</span> &#123;&#125;</span><br><span class="line"><span class="comment">// OK</span></span><br><span class="line"><span class="keyword">struct</span> MMM : AA &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">TestStruct</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span> &#123;</span><br><span class="line">        MPoint p1 = <span class="keyword">new</span> MPoint(<span class="number">1.0</span>, <span class="number">1.0</span>);</span><br><span class="line">        MPoint p2 = p1;</span><br><span class="line">        p1.x = <span class="number">2.0</span>;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;p1.x: &quot;</span> + p1.x);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;p2.x: &quot;</span> + p2.x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* output</span></span><br><span class="line"><span class="comment">p1.x: 2</span></span><br><span class="line"><span class="comment">p2.x: 1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>



<h3 id="枚举-enum"><a href="#枚举-enum" class="headerlink" title="枚举 enum"></a>枚举 enum</h3><ul>
<li>枚举实际上是有意义的整数<ul>
<li>FontStyle、GraphicsUnit、KnownColor、DockStyle、DialogResult</li>
</ul>
</li>
<li>例子</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="built_in">enum</span> MColor &#123;</span><br><span class="line">    Red,</span><br><span class="line">    Green = <span class="number">1</span>,</span><br><span class="line">    Blue = <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">TestStruct</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span> &#123;</span><br><span class="line">        Console.WriteLine(MColor.Red);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* output</span></span><br><span class="line"><span class="comment">Red</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<ul>
<li>用法</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 赋值</span></span><br><span class="line">MColor c = MColor.Red;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 比较</span></span><br><span class="line"><span class="keyword">if</span>(c == MColor.Red) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 选择</span></span><br><span class="line"><span class="keyword">switch</span>(c) &#123;</span><br><span class="line">    <span class="keyword">case</span> MColor.Red:</span><br><span class="line">        <span class="comment">// ..</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>与字符串的转化</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="built_in">enum</span> MColor &#123;</span><br><span class="line">    Red,</span><br><span class="line">    Green = <span class="number">1</span>,</span><br><span class="line">    Blue = <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">TestStruct</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span> &#123;</span><br><span class="line">        MColor c = MColor.Red;</span><br><span class="line">        Console.WriteLine(c.ToString());</span><br><span class="line">        Console.WriteLine(</span><br><span class="line">            (MColor) Enum.Parse(<span class="keyword">typeof</span>(MColor), <span class="string">&quot;Red&quot;</span>)</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* output</span></span><br><span class="line"><span class="comment">Red</span></span><br><span class="line"><span class="comment">Red</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>



<h3 id="结构和枚举比较"><a href="#结构和枚举比较" class="headerlink" title="结构和枚举比较"></a>结构和枚举比较</h3><ul>
<li>结构主要用来表示多个分量</li>
<li>枚举主要用来表示<strong>符号化的常量</strong></li>
<li>它们都是<strong>值类型</strong></li>
</ul>
<h2 id="7-面向对象编程"><a href="#7-面向对象编程" class="headerlink" title="7. 面向对象编程"></a>7. 面向对象编程</h2><ul>
<li>Object Oriented 方法的三大特点<ul>
<li><strong>继承 inheritance</strong><ul>
<li>子类继承父类的成员，还可增加、调用、隐藏</li>
<li>提高软件模块的可重用性和可扩充性</li>
</ul>
</li>
<li><strong>封装 encapsulation</strong><ul>
<li>使用接口，而不关心具体的类</li>
<li>使用属性，而将字段设为private</li>
</ul>
</li>
<li><strong>多态 polymorphism</strong><ul>
<li>相同的方法，不同的参数</li>
<li>自动调用子类相应的方法（虚方法调用，以后讲）</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="8-UML-类图"><a href="#8-UML-类图" class="headerlink" title="8. UML 类图"></a>8. UML 类图</h2><ul>
<li>UML，统一建模语言</li>
<li>有类图、状态图、时序图等多种图形</li>
<li><a target="_blank" rel="noopener" href="http://www.uml.org.cn/">http://www.uml.org.cn/</a></li>
</ul>
<h3 id="VS-中的类关系图"><a href="#VS-中的类关系图" class="headerlink" title="VS 中的类关系图"></a>VS 中的类关系图</h3><ul>
<li>在项目上，点右键，”查看类关系图“</li>
<li>添加新项，其他项，类关系图<ul>
<li>然后将相应的类文件拖动到该 “类关系图” 中</li>
</ul>
</li>
<li>UML 工具<ul>
<li>IBM Rational XDE for .NET</li>
<li>Borland Together</li>
<li>Microsoft Visio</li>
</ul>
</li>
<li>正向工程，由UML图自动产生代码</li>
<li>反向工程，由代码自动产生UML图</li>
</ul>
<h2 id="9-编程规范"><a href="#9-编程规范" class="headerlink" title="9. 编程规范"></a>9. 编程规范</h2><ul>
<li>数字要有意义，不能天上掉下来</li>
<li>常用手段<ul>
<li>使用变量 delta &#x3D; 100</li>
<li>使用常量 const int MAX_LEN &#x3D; 1000</li>
<li>使用系统常量 Math.PI</li>
<li>使用枚举</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/02/csharp/tds/03-1/" data-id="cl9lj74bj00jz64tzfkvsdjgf" data-title="C#程序设计.唐大仕.03.面向对象的C#语言(2)" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/csharp/" rel="tag">csharp</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Kits/cmd" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/01/Kits/cmd/" class="article-date">
  <time class="dt-published" datetime="2021-10-01T07:25:13.000Z" itemprop="datePublished">2021-10-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Kits/">Kits</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/10/01/Kits/cmd/">cmd 命令行技巧</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="cmd"><a href="#cmd" class="headerlink" title="cmd"></a>cmd</h1><h2 id="1-shell"><a href="#1-shell" class="headerlink" title="1. shell"></a>1. shell</h2><h3 id="1-多行输入"><a href="#1-多行输入" class="headerlink" title="(1) 多行输入"></a>(1) 多行输入</h3><ul>
<li>命令太长分为多行输入，使用连接符 <code>^</code></li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls D:\</span><br></pre></td></tr></table></figure>

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls ^</span><br><span class="line"><span class="function">D:\</span></span><br></pre></td></tr></table></figure>



<h3 id="2-重定向"><a href="#2-重定向" class="headerlink" title="(2) 重定向"></a>(2) 重定向</h3><ul>
<li>在原来的文件中<strong>追加</strong></li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls D:\ &gt;&gt; a.txt</span><br></pre></td></tr></table></figure>

<ul>
<li>先清空原来文件，然后将文字输出到文件中（文件不存在则新建）</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls D:\ &gt; a.txt</span><br></pre></td></tr></table></figure>


<h2 id="2-fsutil"><a href="#2-fsutil" class="headerlink" title="2. fsutil"></a>2. fsutil</h2><ul>
<li>关于文件系统的功能，可以试试</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fsutil</span><br></pre></td></tr></table></figure>

<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">---- 支持的命令 ----</span><br><span class="line"></span><br><span class="line">8dot3name         8dot3name 管理</span><br><span class="line">behavior          控制文件系统行为</span><br><span class="line">dax               Dax 卷管理</span><br><span class="line">dirty             管理卷更改位</span><br><span class="line">file              文件特定命令</span><br><span class="line">fsInfo            文件系统信息</span><br><span class="line">hardlink          硬链接管理</span><br><span class="line">objectID          对象 ID 管理</span><br><span class="line">quota             配额管理</span><br><span class="line">repair            自愈管理</span><br><span class="line">reparsePoint      重分析点管理</span><br><span class="line">storageReserve    存储保留管理</span><br><span class="line">resource          事务性资源管理器管理</span><br><span class="line">sparse            稀疏文件控制</span><br><span class="line">tiering           存储分层属性管理</span><br><span class="line">transaction       事务管理</span><br><span class="line">usn               USN 管理</span><br><span class="line">volume            卷管理</span><br><span class="line">wim               透明 wim 托管管理</span><br></pre></td></tr></table></figure>



<h3 id="1-新建空文件"><a href="#1-新建空文件" class="headerlink" title="(1) 新建空文件"></a>(1) 新建空文件</h3><ul>
<li>利用 <code>fsutil</code></li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fsutil file createNew b.txt <span class="number">0</span></span><br></pre></td></tr></table></figure>

<ul>
<li>输出空的内容，重定向到新文件中</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> . &gt; a.txt</span><br></pre></td></tr></table></figure>



<h2 id="3-netsh"><a href="#3-netsh" class="headerlink" title="3. netsh"></a>3. netsh</h2><ul>
<li>网络操作</li>
<li>每一个命令之后使用 <code>/?</code> 都能获得当前操作之后的提示信息</li>
</ul>
<h3 id="1-wlan"><a href="#1-wlan" class="headerlink" title="(1) wlan"></a>(1) wlan</h3><ul>
<li>查看所有保存过密码的 wifi</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh wlan show profiles</span><br></pre></td></tr></table></figure>

<ul>
<li>查看某个账号对应的信息<ul>
<li><code>key=clear</code> 表示直接显示密码</li>
</ul>
</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh wlan show profile name=banbao990 key=clear</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/01/Kits/cmd/" data-id="cl9lj748g000s64tzfdx6h6co" data-title="cmd 命令行技巧" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Kits/" rel="tag">Kits</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Kits/ffmpeg" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/01/Kits/ffmpeg/" class="article-date">
  <time class="dt-published" datetime="2021-10-01T02:41:41.000Z" itemprop="datePublished">2021-10-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Kits/">Kits</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/10/01/Kits/ffmpeg/">ffmpeg 简单应用</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ul>
<li><a target="_blank" rel="noopener" href="https://ffmpeg.org/">ffmpeg 官网</a></li>
</ul>
<h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h1><h2 id="版本信息"><a href="#版本信息" class="headerlink" title="版本信息"></a>版本信息</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.gyan.dev/ffmpeg/builds/">windows 版本</a></li>
</ul>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg version 2021-09-30-git-3ee4502753-essentials_build-www.gyan.dev Copyright (c) 2000-2021 the FFmpeg developers</span><br></pre></td></tr></table></figure>

<ul>
<li>ffmpeg、ffprobe、ffplay 三件套</li>
<li>ffmpeg 处理视频的流程</li>
</ul>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> _______              ______________</span><br><span class="line">|       |            |              |</span><br><span class="line">| input |  demuxer   | encoded data |   decoder</span><br><span class="line">| file  | ---------&gt; | packets      | -----+</span><br><span class="line">|_______|            |______________|      |</span><br><span class="line">                                           v</span><br><span class="line">                                       _________</span><br><span class="line">                                      |         |</span><br><span class="line">                                      | decoded |</span><br><span class="line">                                      | frames  |</span><br><span class="line">                                      |_________|</span><br><span class="line"> ________             ______________       |</span><br><span class="line">|        |           |              |      |</span><br><span class="line">| output | &lt;-------- | encoded data | &lt;----+</span><br><span class="line">| file   |   muxer   | packets      |   encoder</span><br><span class="line">|________|           |______________|</span><br></pre></td></tr></table></figure>



<h1 id="一些功能"><a href="#一些功能" class="headerlink" title="一些功能"></a>一些功能</h1><h2 id="1-查看视频信息"><a href="#1-查看视频信息" class="headerlink" title="1. 查看视频信息"></a>1. 查看视频信息</h2><h3 id="1-查看视频整体的信息"><a href="#1-查看视频整体的信息" class="headerlink" title="(1) 查看视频整体的信息"></a>(1) 查看视频整体的信息</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffprobe -show_format input.mp4</span><br></pre></td></tr></table></figure>

<ul>
<li>时长、比特率</li>
</ul>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Duration: 00:00:06.78, start: 0.000000, bitrate: 14865 kb/s</span><br></pre></td></tr></table></figure>

<ul>
<li>流信息</li>
</ul>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Stream #0:0[0x1](und): Video: h264 (Baseline) (avc1 / 0x31637661), yuv420p(tv, smpte170m/bt470bg/smpte170m, progressive), 1080x1920, 14831 kb/s, 30 fps, 30 tbr, 1000k tbn (default)</span><br><span class="line">  Metadata:</span><br><span class="line">    handler_name    : VideoHandler</span><br><span class="line">    vendor_id       : [0][0][0][0]</span><br><span class="line">Stream #0:1[0x2](und): Audio: aac (LC) (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 128 kb/s (default)</span><br><span class="line">  Metadata:</span><br><span class="line">    handler_name    : SoundHandler</span><br><span class="line">    vendor_id       : [0][0][0][0]</span><br></pre></td></tr></table></figure>



<h3 id="2-查看视频的帧信息"><a href="#2-查看视频的帧信息" class="headerlink" title="(2) 查看视频的帧信息"></a>(2) 查看视频的帧信息</h3><ul>
<li>如下 <code>test_1s.mp4</code> 为一个时长 <code>1s</code> 的视频文件</li>
<li>输出所有帧的信息（包括视频帧和音频帧）<ul>
<li><code>-of xml</code>：输出为 xml 格式</li>
</ul>
</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffprobe -show_frames -of xml test_1s.mp4 &gt; info_all.xml</span><br></pre></td></tr></table></figure>



<h4 id="视频帧信息"><a href="#视频帧信息" class="headerlink" title="视频帧信息"></a>视频帧信息</h4><ul>
<li>json 格式</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;media_type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;video&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;stream_index&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;key_frame&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span> <span class="comment">// 是否是关键帧</span></span><br><span class="line">    <span class="attr">&quot;pts&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;pts_time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.000000&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;pkt_dts&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;pkt_dts_time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.000000&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;best_effort_timestamp&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;best_effort_timestamp_time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.000000&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;pkt_duration&quot;</span><span class="punctuation">:</span> <span class="number">33333</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;pkt_duration_time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.033333&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;pkt_pos&quot;</span><span class="punctuation">:</span> <span class="string">&quot;791&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;pkt_size&quot;</span><span class="punctuation">:</span> <span class="string">&quot;223934&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;width&quot;</span><span class="punctuation">:</span> <span class="number">1080</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;height&quot;</span><span class="punctuation">:</span> <span class="number">1920</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;pix_fmt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;yuv420p&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;pict_type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;I&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;coded_picture_number&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;display_picture_number&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;interlaced_frame&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;top_field_first&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;repeat_pict&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;color_range&quot;</span><span class="punctuation">:</span> <span class="string">&quot;tv&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;color_space&quot;</span><span class="punctuation">:</span> <span class="string">&quot;smpte170m&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;color_primaries&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bt470bg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;color_transfer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;smpte170m&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;chroma_location&quot;</span><span class="punctuation">:</span> <span class="string">&quot;left&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<h4 id="select-streams"><a href="#select-streams" class="headerlink" title="select_streams"></a>select_streams</h4><ul>
<li>选项<ul>
<li><code>v</code>：视频</li>
<li><code>a</code>：音频</li>
<li><code>v:1</code>： 音频流，而且 index&#x3D;1</li>
</ul>
</li>
<li>只输出<strong>视频帧</strong>的信息<ul>
<li><code>-of json</code>：输出为 json 格式</li>
</ul>
</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffprobe -select_streams v -show_frames -of json test_1s.mp4 &gt; infos.json</span><br></pre></td></tr></table></figure>



<h4 id="show-entries"><a href="#show-entries" class="headerlink" title="show_entries"></a><strong>show_entries</strong></h4><ul>
<li>只显示给定的属性<ul>
<li>例如只显示<strong>这一帧开始播放的时间</strong>、<strong>帧号</strong></li>
</ul>
</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ffprobe -select_streams v -show_frames ^</span><br><span class="line">-show_entries frame=pts_time,coded_picture_number ^</span><br><span class="line">-of xml test_1s.mp4 &gt; infos.xml</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>根据给定的帧数找到对应的时间戳</strong><ul>
<li>找到第 30 帧的时间戳<ul>
<li>帧从 0 开始编号</li>
</ul>
</li>
<li><strong>视频较大时很慢</strong></li>
</ul>
</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ffprobe -select_streams v -show_frames ^</span><br><span class="line">-show_entries frame=pts_time,coded_picture_number ^</span><br><span class="line">-of xml test_1s.mp4 | <span class="built_in">findstr</span> &quot;coded_picture_number=\&quot;<span class="number">29</span>\&quot;&quot; &gt; ans.xml</span><br></pre></td></tr></table></figure>



<h2 id="2-按时间剪辑"><a href="#2-按时间剪辑" class="headerlink" title="2. 按时间剪辑"></a>2. 按时间剪辑</h2><h3 id="1-视频剪辑"><a href="#1-视频剪辑" class="headerlink" title="(1) 视频剪辑"></a>(1) 视频剪辑</h3><ul>
<li>如果选项放在 <code>-i</code> 之前那就是作为 <code>input</code> 选项，之后就是作为 <code>output</code> 选项</li>
</ul>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i input.mp4 -s <span class="number">0</span> -t <span class="number">3</span>.<span class="number">33</span> -vcodec <span class="built_in">copy</span> -acodec <span class="built_in">copy</span> output.mp4</span><br></pre></td></tr></table></figure>

<ul>
<li><code>-i</code>：输入文件</li>
<li><code>-s(input/output)</code>：从哪里时间开始</li>
<li><code>-to(input/output)</code>：到哪个时间停止<ul>
<li><code>-t(input/output)</code>：持续多久时间（和 <code>-to</code> 互斥，<code>-t</code> 优先级更高）</li>
</ul>
</li>
<li><code>-vcodec copy</code>：不对视频进行重新编码</li>
<li><code>-acodec copy</code>：不对音频进行重新编码</li>
<li><strong>时间的格式</strong><ul>
<li>55：55 seconds</li>
<li>0.2：0.2 seconds</li>
<li>23.189：23.189 seconds</li>
<li>200ms：200 milliseconds  (&#x3D; 0.2s)</li>
<li>200000us：200000 microseconds (&#x3D; 0.2s)</li>
<li>12:03:45：12 hours, 03 minutes and 45 seconds</li>
</ul>
</li>
</ul>
<h3 id="2-音频剪辑"><a href="#2-音频剪辑" class="headerlink" title="(2) 音频剪辑"></a>(2) 音频剪辑</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -vn -i a.mp3 -s <span class="number">0</span> -t <span class="number">3</span>.<span class="number">33</span> b.mp3</span><br></pre></td></tr></table></figure>



<h2 id="3-合并视频"><a href="#3-合并视频" class="headerlink" title="3. 合并视频"></a>3. 合并视频</h2><ul>
<li>mp4 转 ts</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i p1.mp4 -vcodec <span class="built_in">copy</span> -acodec <span class="built_in">copy</span> -vbsf h264_mp4toannexb <span class="number">1</span>.ts</span><br><span class="line">ffmpeg -i p2.mp4 -vcodec <span class="built_in">copy</span> -acodec <span class="built_in">copy</span> -vbsf h264_mp4toannexb <span class="number">2</span>.ts</span><br><span class="line">ffmpeg -i p3.mp4 -vcodec <span class="built_in">copy</span> -acodec <span class="built_in">copy</span> -vbsf h264_mp4toannexb <span class="number">3</span>.ts</span><br></pre></td></tr></table></figure>
<ul>
<li>拼接，转 mp4</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i &quot;concat:<span class="number">1</span>.ts|<span class="number">2</span>.ts|<span class="number">3</span>.ts&quot; -acodec <span class="built_in">copy</span> -vcodec <span class="built_in">copy</span> -absf aac_adtstoasc output.mp4</span><br></pre></td></tr></table></figure>

<ul>
<li>删除中间 ts 文件<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">del</span> *.ts</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="4-分离视频与音频"><a href="#4-分离视频与音频" class="headerlink" title="4. 分离视频与音频"></a>4. 分离视频与音频</h2><ul>
<li><code>-an(input/output)</code>：阻挡所有音频流</li>
<li><code>-vn(input/output)</code>：阻挡所有视频流</li>
<li>输出视频</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -an -i input.mp4 -vcodec <span class="built_in">copy</span> audio_mutex.mp4</span><br></pre></td></tr></table></figure>

<ul>
<li>输出音频</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -vn -i input.mp4 -acodec <span class="built_in">copy</span> only_audio.aac</span><br></pre></td></tr></table></figure>



<h2 id="5-音视频合并"><a href="#5-音视频合并" class="headerlink" title="5. 音视频合并"></a>5. 音视频合并</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i audio_mutex.mp4 -i only_audio.aac ^</span><br><span class="line">-c:v <span class="built_in">copy</span> -c:a aac -strict experimental combine.mp4</span><br></pre></td></tr></table></figure>

<ul>
<li>如果音频长于视频，则输出视频长度和<strong>音频</strong>一样，<strong>缺失的视频用最后一帧补全</strong></li>
<li>如果视频长于音频，则输出视频长度和<strong>视频</strong>一样，<strong>缺失的音频为无声</strong></li>
</ul>
<h3 id="1-音频循环播放直至视频结束"><a href="#1-音频循环播放直至视频结束" class="headerlink" title="(1) 音频循环播放直至视频结束"></a>(1) 音频循环播放直至视频结束</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -stream_loop -<span class="number">1</span> -i xue.m4a -i pintu.mp4 -shortest ^</span><br><span class="line">-vcodec <span class="built_in">copy</span> -acodec <span class="built_in">copy</span> ^</span><br><span class="line">-map <span class="number">1</span>:v:<span class="number">0</span> -map <span class="number">0</span>:a:<span class="number">0</span> ^</span><br><span class="line">out.mp4</span><br></pre></td></tr></table></figure>

<ul>
<li><code>-stream_loop(input)</code>：表示流循环次数<ul>
<li>-1：无限循环</li>
<li>1：循环一次，表示让当前输入流循环一次，一共播放<strong>两次</strong></li>
</ul>
</li>
<li><code>-shortest</code><ul>
<li>短的流结束则输入结束</li>
</ul>
</li>
<li><code>-map 1:v:0 -map 0:a:0</code><ul>
<li>使用第 1 号输入流的视频作为第 0 号输出流的视频</li>
<li>使用第 0 号输入流的音频作为第 0 号输出流的音频</li>
</ul>
</li>
</ul>
<h2 id="6-视频加速"><a href="#6-视频加速" class="headerlink" title="6. 视频加速"></a>6. 视频加速</h2><ul>
<li>如下例子是对音视频都加速 1.1 倍</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -hwaccel cuda -i input.mp4 -vf setpts=PTS/<span class="number">1</span>.<span class="number">1</span> -af atempo=<span class="number">1</span>.<span class="number">1</span> output_1.<span class="number">1</span>.mp4</span><br></pre></td></tr></table></figure>

<ul>
<li><code>-hwaccel cuda</code>：使用 GPU 加速</li>
<li>查看可用硬件</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -hwaccels</span><br></pre></td></tr></table></figure>




      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/01/Kits/ffmpeg/" data-id="cl9lj748i001064tzaqv5fzqz" data-title="ffmpeg 简单应用" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Kits/" rel="tag">Kits</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-csharp/tds/03" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/30/csharp/tds/03/" class="article-date">
  <time class="dt-published" datetime="2021-09-30T03:14:35.000Z" itemprop="datePublished">2021-09-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/csharp-tds/">csharp.tds</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/09/30/csharp/tds/03/">C#程序设计.唐大仕.03.面向对象的C#语言</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ul>
<li><a target="_blank" rel="noopener" href="https://www.icourse163.org/learn/PKU-1001663016">中国大学慕课</a></li>
</ul>
<h1 id="面向对象的C-语言"><a href="#面向对象的C-语言" class="headerlink" title="面向对象的C#语言"></a>面向对象的C#语言</h1><h2 id="1-类、字段、方法"><a href="#1-类、字段、方法" class="headerlink" title="1. 类、字段、方法"></a>1. 类、字段、方法</h2><ul>
<li>类（class）最基本的要素<ul>
<li>字段（field）：变量</li>
<li>方法（method）： 函数</li>
</ul>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Person</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> name;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> age;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SayHello</span>()</span> &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Hello! My name is &quot;</span> + name );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">GetInfo</span>()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Name: &quot;</span> + name + <span class="string">&quot;, Age: &quot;</span> + age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="构造方法"><a href="#构造方法" class="headerlink" title="构造方法"></a>构造方法</h3><ul>
<li>构造方法（constructor）</li>
<li>构造方法的主要作用是完成对象的初始化工作<ul>
<li>构造方法的方法名与类名相同</li>
<li>构造方法没有返回类型，也不能写 void</li>
</ul>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Person</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span>(<span class="params"><span class="built_in">string</span> n, <span class="built_in">int</span> a</span>)</span>&#123;</span><br><span class="line">        name = n; age = a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>默认（default）构造方法<ul>
<li>如果用户<strong>没有定义任何构造方法</strong>，则系统会自动产生一个</li>
</ul>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Person</span>()</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>构造方法不能显式地直接调用，而是用 new 来调用</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Person p = <span class="keyword">new</span> Person(<span class="string">&quot;Liming&quot;</span>, <span class="number">20</span> );</span><br></pre></td></tr></table></figure>



<h3 id="析构方法"><a href="#析构方法" class="headerlink" title="析构方法"></a>析构方法</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Person</span> &#123;</span><br><span class="line">    ~Person() &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>由于 C# 自动进行对象的释放，所以用户一般不定义析构方法</li>
</ul>
<h3 id="方法的重载"><a href="#方法的重载" class="headerlink" title="方法的重载"></a>方法的重载</h3><ul>
<li>overloading</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SayHello</span>()</span>&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;Hello! My name is &quot;</span> + name );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SayHello</span>(<span class="params"> Person another </span>)</span>&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;Hello,&quot;</span> + another.name</span><br><span class="line">                      + <span class="string">&quot;! My name is &quot;</span> + name );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>系统通过方法签名来区分</li>
<li>方法签名：<strong>方法名</strong>及<strong>参数个数及类型</strong>构成（参数名不算）</li>
</ul>
<h3 id="this"><a href="#this" class="headerlink" title="this"></a>this</h3><ul>
<li><p>this指这个对象本身</p>
</li>
<li><p>常用于</p>
<ul>
<li>访问这个对象的字段及方法<ul>
<li>用于 VS 自动补全</li>
</ul>
</li>
<li>区分字段与局部变量</li>
</ul>
  <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Person</span>(<span class="params"><span class="built_in">int</span> age, <span class="built_in">string</span> name</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>用于构造方法调用另一个构造方法，<strong>注意其位置</strong></li>
</ul>
  <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Person</span>() : <span class="title">this</span>(<span class="params"> <span class="number">0</span>, <span class="string">&quot;&quot;</span> </span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 构造方法的其他语句;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="应用实例：银行系统"><a href="#应用实例：银行系统" class="headerlink" title="应用实例：银行系统"></a>应用实例：银行系统</h3><ul>
<li>可在 vs 中，添加 “ 类关系图 ”（类图）</li>
</ul>
<p><img src="/03/image-20210930183705246.png"></p>
<h2 id="2-属性、索引"><a href="#2-属性、索引" class="headerlink" title="2. 属性、索引"></a>2. 属性、索引</h2><h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><h4 id="使用属性"><a href="#使用属性" class="headerlink" title="使用属性"></a>使用属性</h4><ul>
<li>button1.Text &#x3D; “说你好”;<ul>
<li>含义相当于button1.SetText( “说你好”);</li>
</ul>
</li>
<li>string s &#x3D; button1.Text;<ul>
<li>含义相当于 s &#x3D; button1.GetText();</li>
</ul>
</li>
</ul>
<h4 id="定义属性"><a href="#定义属性" class="headerlink" title="定义属性"></a>定义属性</h4><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="built_in">string</span> _name;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">string</span> Name &#123;</span><br><span class="line">    <span class="keyword">get</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> _name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">set</span> &#123;</span><br><span class="line">        _name = <span class="keyword">value</span>; <span class="comment">// value 关键字, 便是传进来的参数</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>C#3 之后可以简写</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">set</span>; <span class="keyword">get</span>; &#125;</span><br></pre></td></tr></table></figure>



<h5 id="一个例子"><a href="#一个例子" class="headerlink" title="一个例子"></a>一个例子</h5><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Person</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123;</span><br><span class="line">        <span class="keyword">set</span>; <span class="keyword">get</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用属性</span></span><br><span class="line"><span class="keyword">class</span> <span class="title">xxx</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">xxx</span>()</span> &#123;</span><br><span class="line">        Person a = <span class="keyword">new</span> Person();</span><br><span class="line">        a.Name = <span class="string">&quot;banbao&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>编译器</strong>对于上面的属性生成如下方法<ul>
<li>可以通过反汇编看到生成的方法</li>
</ul>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">set_Name</span>(<span class="params"><span class="built_in">string</span> <span class="keyword">value</span></span>)</span>;</span><br><span class="line"><span class="function"><span class="built_in">string</span> <span class="title">get_Name</span>()</span>;</span><br></pre></td></tr></table></figure>



<h4 id="属性和字段的对比"><a href="#属性和字段的对比" class="headerlink" title="属性和字段的对比"></a>属性和字段的对比</h4><ul>
<li><strong>属性实际上是方法</strong></li>
</ul>
<h4 id="属性的优点"><a href="#属性的优点" class="headerlink" title="属性的优点"></a>属性的优点</h4><ul>
<li><p>可以只读或只写</p>
<ul>
<li>只读：只有 get，没有 set</li>
</ul>
  <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Person</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123;</span><br><span class="line">        <span class="keyword">get</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>只写：只有 set，没有 get</li>
</ul>
</li>
<li><p>可以进行有效性检查</p>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Person</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> _name;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> _name;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">value</span> == <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;Name can not be an empty string!&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            _name = <span class="keyword">value</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>可以是计算得到的数据</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">string</span> Info&#123;</span><br><span class="line">    <span class="keyword">get</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Name :&quot;</span> + Name + <span class="string">&quot;,Age :&quot;</span> + Age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>可以定义抽象属性</li>
</ul>
<h3 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h3><ul>
<li>string s&#x3D;”abcde”;</li>
<li>求出第0个字符：s[0]<ul>
<li>含义上相当于 s.Get(0)</li>
</ul>
</li>
</ul>
<h4 id="定义索引"><a href="#定义索引" class="headerlink" title="定义索引"></a>定义索引</h4><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">修饰符 类型名 <span class="keyword">this</span> [参数列表] &#123;</span><br><span class="line">    <span class="keyword">set</span> &#123;&#125;</span><br><span class="line">    <span class="keyword">get</span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="使用索引"><a href="#使用索引" class="headerlink" title="使用索引"></a>使用索引</h4><ul>
<li><strong>对象名[参数]</strong></li>
<li><strong>编译器</strong>自动产生两个方法，以供调用</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">T <span class="title">get_Item</span>(<span class="params">P</span>)</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">set_Item</span>(<span class="params">P, T <span class="keyword">value</span></span>)</span>;</span><br></pre></td></tr></table></figure>



<h4 id="课程示例"><a href="#课程示例" class="headerlink" title="课程示例"></a>课程示例</h4><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">class</span> <span class="title">IndexerRecord</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span>[] data = <span class="keyword">new</span> <span class="built_in">string</span>[<span class="number">6</span>];</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span>[] keys = &#123;</span><br><span class="line">        <span class="string">&quot;Author&quot;</span>, <span class="string">&quot;Publisher&quot;</span>, <span class="string">&quot;Title&quot;</span>, <span class="string">&quot;Subject&quot;</span>, <span class="string">&quot;ISBN&quot;</span>, <span class="string">&quot;Comments&quot;</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 定义索引</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> <span class="keyword">this</span>[<span class="built_in">int</span> idx] &#123;</span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (idx &gt;= <span class="number">0</span> &amp;&amp; idx &lt; data.Length) data[idx] = <span class="keyword">value</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (idx &gt;= <span class="number">0</span> &amp;&amp; idx &lt; data.Length) <span class="keyword">return</span> data[idx];</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 两种方式访问</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> <span class="keyword">this</span>[<span class="built_in">string</span> key] &#123;</span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">            <span class="built_in">int</span> idx = FindKey(key);</span><br><span class="line">            <span class="keyword">this</span>[idx] = <span class="keyword">value</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>[FindKey(key)];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="built_in">int</span> <span class="title">FindKey</span>(<span class="params"><span class="built_in">string</span> key</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; keys.Length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (keys[i] == key) &#123;</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span> &#123;</span><br><span class="line">        IndexerRecord <span class="keyword">record</span> = <span class="keyword">new</span> IndexerRecord();</span><br><span class="line">        <span class="comment">// 使用索引</span></span><br><span class="line">        <span class="keyword">record</span>[0] = <span class="string">&quot;马克-吐温&quot;</span>;</span><br><span class="line">        <span class="keyword">record</span>[1] = <span class="string">&quot;Crox出版公司&quot;</span>;</span><br><span class="line">        <span class="keyword">record</span>[2] = <span class="string">&quot;汤姆-索亚历险记&quot;</span>;</span><br><span class="line">        Console.WriteLine(<span class="keyword">record</span>[&quot;<span class="title">Title</span>&quot;]);</span><br><span class="line">        Console.WriteLine(<span class="keyword">record</span>[&quot;<span class="title">Author</span>&quot;]);</span><br><span class="line">        Console.WriteLine(<span class="keyword">record</span>[&quot;<span class="title">Publisher</span>&quot;]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="属性和索引"><a href="#属性和索引" class="headerlink" title="属性和索引"></a>属性和索引</h3><table>
<thead>
<tr>
<th align="center">属性</th>
<th align="center">索引器</th>
</tr>
</thead>
<tbody><tr>
<td align="center">通过名称标识</td>
<td align="center">通过参数列表进行标识</td>
</tr>
<tr>
<td align="center">通过简单名称来访问</td>
<td align="center">通过 [] 运算符来访问</td>
</tr>
<tr>
<td align="center">可以用 static 修饰</td>
<td align="center">不能用 static 修饰</td>
</tr>
<tr>
<td align="center">属性的 get 访问器没有参数</td>
<td align="center">索引的 get 访问器具有与索引相同的参数</td>
</tr>
<tr>
<td align="center">属性的 set 访问器包含隐式 value 参数</td>
<td align="center">除了 value 参数外，<br />索引的 set 访问器还具有与索引相同的参数列表</td>
</tr>
</tbody></table>
<h2 id="3-类的继承"><a href="#3-类的继承" class="headerlink" title="3. 类的继承"></a>3. 类的继承</h2><ul>
<li>窗体程序</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Form1</span> : <span class="title">System.Windows.Forms.Form</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>继承使用 <code>:</code> 表示</li>
<li>子类 subclass、父类 baseclass</li>
<li>C# 中采用<strong>单继承</strong></li>
<li>所有的类都是通过直接或间接地继承 object（即System.Object）得到的<ul>
<li>如果一个类明显显式声明继承自哪一个类，系统认为其继承于 object</li>
<li>默认有 <code>ToString()</code> 等方法</li>
</ul>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">SubClass</span> : <span class="title">BaseClass</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>子类自动地从父类那里继承所有的字段、方法、属性、索引器等成员作为自己的成员</li>
<li>除了继承父类的成员外，子类还可以<ul>
<li><strong>添加新的成员</strong></li>
<li><strong>隐藏或修改父类的成员</strong></li>
</ul>
</li>
</ul>
<h3 id="字段的继承、添加与隐藏"><a href="#字段的继承、添加与隐藏" class="headerlink" title="字段的继承、添加与隐藏"></a>字段的继承、添加与隐藏</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">A</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> a;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">B</span> : <span class="title">A</span> &#123;</span><br><span class="line">    <span class="comment">// 继承字段 a</span></span><br><span class="line">    <span class="keyword">new</span> <span class="keyword">public</span> <span class="built_in">int</span> b; <span class="comment">// 隐藏</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> c; <span class="comment">// 添加</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="方法的继承、添加"><a href="#方法的继承、添加" class="headerlink" title="方法的继承、添加"></a>方法的继承、添加</h3><ul>
<li>方法的继承（自动）</li>
<li>方法的添加（多定义一些方法）</li>
</ul>
<h4 id="与父类同名的方法"><a href="#与父类同名的方法" class="headerlink" title="与父类同名的方法"></a>与父类同名的方法</h4><ul>
<li>一是定义同名、但参数列表（签名）与父类不同的方法，这称为对父类方法的重载（<strong>Overloading</strong>）</li>
<li>二是定义同名且参数列表也与父类相同的方法，这称为新增加一种方法 ，用 <strong>new</strong> 表示</li>
<li>三是定义同名且参数列表也与父类相同的方法，而且父类的方法用了 abstract 或 virtual 进行了修饰，子类的同名方法用了 overridnewe 进行了修饰，这称为虚方法的覆盖（<strong>Overriding</strong>）</li>
</ul>
<h4 id="base-关键字"><a href="#base-关键字" class="headerlink" title="base 关键字"></a>base 关键字</h4><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Base</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> A;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Base</span>(<span class="params"><span class="built_in">int</span> A</span>)</span> &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Base: constructor!&quot;</span>);</span><br><span class="line">        <span class="keyword">this</span>.A = A;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SayHello</span>()</span> &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Base: Hello!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Derived</span> : <span class="title">Base</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> B;</span><br><span class="line">    <span class="comment">// 通过 base 关键字调用父类构造函数</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Derived</span>(<span class="params"><span class="built_in">int</span> A, <span class="built_in">int</span> B</span>): <span class="title">base</span>(<span class="params">A</span>)</span> &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Derived: constructor!&quot;</span>);</span><br><span class="line">        <span class="keyword">this</span>.B = B;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// new 关键字表示隐藏(否则会报警告)</span></span><br><span class="line">    <span class="keyword">new</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SayHello</span>()</span> &#123;</span><br><span class="line">        <span class="keyword">base</span>.SayHello(); <span class="comment">// 通过 base 关键字调用父类方法</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Derived: Hello!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span> &#123;</span><br><span class="line">        Derived d = <span class="keyword">new</span> Derived(<span class="number">0</span> ,<span class="number">0</span>);</span><br><span class="line">        d.SayHello();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* output</span></span><br><span class="line"><span class="comment">Base: constructor!</span></span><br><span class="line"><span class="comment">Derived: constructor!</span></span><br><span class="line"><span class="comment">Base: Hello!</span></span><br><span class="line"><span class="comment">Derived: Hello!</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>



<h4 id="父类与子类的转换"><a href="#父类与子类的转换" class="headerlink" title="父类与子类的转换"></a>父类与子类的转换</h4><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Person p1 = <span class="keyword">new</span> Person();</span><br><span class="line">Person p2 = <span class="keyword">new</span> Student();</span><br><span class="line">Student s1 = <span class="keyword">new</span> Student();</span><br><span class="line">Student s2 = <span class="keyword">new</span> Student();</span><br><span class="line"></span><br><span class="line">statement A;</span><br></pre></td></tr></table></figure>

<ul>
<li>上述 <code>statement A</code> 分别为如下语句</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">p1 = s1; <span class="comment">// 可以, 因为 Person 类型的变量可以引用 Student 对象</span></span><br><span class="line"></span><br><span class="line">s2 = p1; <span class="comment">// 不行, 因为会产生编译错误</span></span><br><span class="line"></span><br><span class="line">s2 = (Student) p1;  <span class="comment">// 编译时可以通过, 运行时则会出现类型不能转换的异常</span></span><br><span class="line"></span><br><span class="line">s2 = (Student) p2;  <span class="comment">// 正确，因为 p2 引用的正好是 Student 对象实例</span></span><br></pre></td></tr></table></figure>



<h4 id="as-运算符"><a href="#as-运算符" class="headerlink" title="as 运算符"></a>as 运算符</h4><ul>
<li>如果不能转换，则值为null</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Student s3 = p1 <span class="keyword">as</span> Student;  <span class="comment">// 结果 s3 为 null</span></span><br><span class="line">Student s4 = p2 <span class="keyword">as</span> Student;  <span class="comment">// s4 被赋值</span></span><br></pre></td></tr></table></figure>

<ul>
<li>与强制类型转换的差别<ul>
<li>as 只能针对<strong>引用型变量</strong></li>
<li><strong>如果不能转换，as 运算不会引起异常，只是值为 null</strong></li>
</ul>
</li>
</ul>
<h4 id="is-运算符"><a href="#is-运算符" class="headerlink" title="is 运算符"></a>is 运算符</h4><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(p <span class="keyword">is</span> Person) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>判断一个对象是不是某个类(及其子类)的实例</li>
</ul>
<h4 id="typeof-运算符"><a href="#typeof-运算符" class="headerlink" title="typeof 运算符"></a>typeof 运算符</h4><ul>
<li>变量则使用 <code>GetType()</code></li>
<li>类型则使用 <code>typeof()</code></li>
<li>返回类型为 <code>System.Type</code></li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Base</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Derived</span> : <span class="title">Base</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span> &#123;</span><br><span class="line">        Derived d1 = <span class="keyword">new</span> Derived();</span><br><span class="line">        <span class="comment">// Derived d2 = new Base(); // 编译错误</span></span><br><span class="line">        Base b1 = <span class="keyword">new</span> Derived();</span><br><span class="line">        Base b2 = <span class="keyword">new</span> Base();</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;d1: &quot;</span> + d1.GetType());</span><br><span class="line">        <span class="comment">// Console.WriteLine(&quot;d2: &quot; + d2.GetType());</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;b1: &quot;</span> + b1.GetType());</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;b2: &quot;</span> + b2.GetType());</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        Console.WriteLine(<span class="keyword">typeof</span>(Base));</span><br><span class="line">        Console.WriteLine(<span class="keyword">typeof</span>(Derived));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* output</span></span><br><span class="line"><span class="comment">d1: Derived</span></span><br><span class="line"><span class="comment">b1: Derived</span></span><br><span class="line"><span class="comment">b2: Base</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Base</span></span><br><span class="line"><span class="comment">Derived</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>



<h3 id="属性、索引的继承"><a href="#属性、索引的继承" class="headerlink" title="属性、索引的继承"></a>属性、索引的继承</h3><ul>
<li>属性、索引也是可以继承的</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/09/30/csharp/tds/03/" data-id="cl9lj74bi00jt64tz41ubeqwx" data-title="C#程序设计.唐大仕.03.面向对象的C#语言" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/csharp/" rel="tag">csharp</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-computation/pyr/02" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/26/computation/pyr/02/" class="article-date">
  <time class="dt-published" datetime="2021-09-26T08:55:54.000Z" itemprop="datePublished">2021-09-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/computation-pyr/">computation.pyr</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/09/26/computation/pyr/02/">计算方法B.裴玉茹.02.非线性方程迭代求解</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ul>
<li>数值分析课本第 1 章（求解方程） + PPT（非线性方程迭代求解）</li>
</ul>
<h1 id="非线性方程迭代求解"><a href="#非线性方程迭代求解" class="headerlink" title="非线性方程迭代求解"></a>非线性方程迭代求解</h1><ul>
<li>求解方程</li>
</ul>
<h2 id="1-二分法"><a href="#1-二分法" class="headerlink" title="1. 二分法"></a>1. 二分法</h2><ul>
<li>原理</li>
</ul>
<img src="02/image-20210926170010282.jpg" style="zoom:67%;" />

<ul>
<li>算法流程</li>
</ul>
<img src="02/image-20210926170146479.jpg" style="zoom: 67%;" />



<h3 id="速度与准确性"><a href="#速度与准确性" class="headerlink" title="速度与准确性"></a>速度与准确性</h3><ul>
<li>初始区间 $[a,b]$</li>
<li>最终选择区间的中点作为近似解</li>
<li>$n$ 步二分法之后<ul>
<li>求解误差 $&#x3D;\vert{x_c-r}\vert\le\dfrac{b-a}{2^{n+1}}$<ul>
<li><strong>绝对误差界</strong></li>
</ul>
</li>
<li>函数计算次数：$n+2$</li>
</ul>
</li>
<li>和有效数字类似的定义<ul>
<li><strong>定义</strong>：如果误差小于 $0.5\times10^{-p}$，阶精确到小数点后 $p$ 位</li>
</ul>
</li>
</ul>
<h3 id="终止条件"><a href="#终止条件" class="headerlink" title="终止条件"></a>终止条件</h3><ul>
<li>绝对误差小于容差</li>
<li>相对误差小于容差</li>
<li>后向误差小于容差</li>
</ul>
<h3 id="实际计算的问题"><a href="#实际计算的问题" class="headerlink" title="实际计算的问题"></a>实际计算的问题</h3><h4 id="避免向上溢出"><a href="#避免向上溢出" class="headerlink" title="避免向上溢出"></a>避免向上溢出</h4><ul>
<li>使用 $p_{n}&#x3D;a_n+\dfrac{b_n-a_n}{2}$ 来代替 $p_n&#x3D;\dfrac{b_n+a_n}{2}$</li>
</ul>
<h4 id="避免乘法运算"><a href="#避免乘法运算" class="headerlink" title="避免乘法运算"></a>避免乘法运算</h4><ul>
<li>使用符号函数 $\mathrm{sgn}$</li>
<li>使用 $\mathrm{sgn}(f(a_n))\cdot\mathrm{sgn}(f(p_n))&lt;0$ 代替 $f(a_n)\cdot f(b_n)&lt;0$</li>
</ul>
<h2 id="2-不动点迭代"><a href="#2-不动点迭代" class="headerlink" title="2. 不动点迭代"></a>2. 不动点迭代</h2><ul>
<li>FPI：Fixed Point Iteration</li>
<li><strong>定义</strong>：当 $g(r)&#x3D;r$，实数 $r$ 是函数 $g$ 的不动点</li>
<li>$g(x)$ 的不动点，同时也是 $x&#x3D;f(x)$ 的解</li>
<li>不动点迭代：$g(x)$<ul>
<li>$x_0$ &#x3D; 初始估计</li>
<li>$x_{i+1}&#x3D;g(x_i)$</li>
</ul>
</li>
<li>无穷多步迭代之后，序列 ${x_i}$ 可能收敛，也可能发散</li>
<li>如果函数 $g$ 连续，而且 ${x_i}$ 收敛到 $r$，则 $r$ 是函数 $g$ 对应的不动点</li>
</ul>
<p>$$<br>g(r)&#x3D;g(\lim_{i\to\infty}{x_i})&#x3D;\lim_{i\to\infty}g(x_i)&#x3D;\lim_{i\to\infty}x_{i+1}&#x3D;r<br>$$</p>
<h3 id="多种形式"><a href="#多种形式" class="headerlink" title="多种形式"></a>多种形式</h3><ul>
<li>$x^3+x-1&#x3D;0$</li>
<li>可以使用如下的不动点迭代方式<ul>
<li>$x&#x3D;1-x^3&#x3D;g_1(x)$</li>
<li>$x&#x3D;\sqrt[3]{1-x}&#x3D;g_2(x)$</li>
<li>$x&#x3D;\dfrac{1+2x^3}{1+3x^2}&#x3D;g_3(x)$</li>
</ul>
</li>
<li>一些现象<ul>
<li>起始点为 $x_0&#x3D;0.5$ 时，$g_1(x)$ 未收敛，在 $0,1$ 两个数上跳跃</li>
<li>起始点为 $x_0&#x3D;0.5$ 时，$g_2(x)$ 收敛了</li>
<li>起始点为 $x_0&#x3D;0.5$ 时，$g_3(x)$ 收敛了，比 $g_2(x)$ 更快</li>
</ul>
</li>
<li><strong>cobweb 图</strong></li>
</ul>
<img src="02/image-20210926201732414.jpg" style="zoom:67%;" />



<h3 id="线性收敛"><a href="#线性收敛" class="headerlink" title="线性收敛"></a>线性收敛</h3><ul>
<li><strong>定义</strong>：令 $e_i$ 表示迭代过程中第 $i$ 步时的误差，如果有如下式子成立，该方法被称为满足<strong>线性收敛</strong>，收敛速度为 $S$</li>
</ul>
<p>$$<br>\lim_{i\to\infty}\dfrac{e_{i+1}}{e_{i}}&#x3D;S<br>$$</p>
<h3 id="局部收敛"><a href="#局部收敛" class="headerlink" title="局部收敛"></a>局部收敛</h3><ul>
<li><strong>定理</strong><ul>
<li>可导函数的导函数不存在第一类间断点，只可能存在第二类间断点</li>
</ul>
</li>
</ul>
<img src="02/image-20210926204254017.jpg" style="zoom:67%;" />

<ul>
<li><p><strong>定义</strong>：如果一个迭代方法对于一个足够接近 $r$ 的初值能收敛到 $r$，该迭代方法被称为<strong>局部收敛</strong>到 $r$</p>
<ul>
<li>如果存在近邻区间 $(r-\epsilon,r+\epsilon)$，其中 $\epsilon&gt;0$，使得近邻区间种的所有初始估计都可以收敛到 $r$，那么该方法局部收敛到 $r$</li>
<li>定理 1.6 的结论：当 $\vert{g’(r)}\vert&lt;1$ 时不动点迭代局部收敛</li>
</ul>
</li>
<li><p>FPI 计算 $\sqrt{2}$</p>
</li>
</ul>
<p>$$<br>f(x)&#x3D;\dfrac{x+\dfrac{2}{x}}{2}<br>$$</p>
<h3 id="终止条件-1"><a href="#终止条件-1" class="headerlink" title="终止条件"></a>终止条件</h3><ul>
<li>无法通过<strong>初始值</strong>和<strong>迭代次数</strong>，预测达到给定<strong>容差</strong>所需要进行的<strong>步数</strong></li>
<li>绝对误差：$\vert{x_{i+1}-x_{i}}\vert&lt;TOL$</li>
<li>相对误差（要求解不在 0 附近）：$\dfrac{\vert{x_{i+1}-x_{i}}\vert}{\vert{x_{i+1}}\vert}&lt;TOL$</li>
<li>混合绝对&#x2F;相对误差（可用于解在 0 附近）：$\dfrac{\vert{x_{i+1}-x_{i}}\vert}{\max{(\vert{x_{i+1}}\vert},\theta)}$</li>
<li>同时设置<strong>最大迭代步数</strong>，防止收敛失败</li>
</ul>
<h3 id="和二分法的对比"><a href="#和二分法的对比" class="headerlink" title="和二分法的对比"></a>和二分法的对比</h3><ul>
<li>区别<ul>
<li>二分法保证线性收敛</li>
<li>不动点迭代仅仅是局部收敛。当不动点迭代收敛时，其线性收敛</li>
</ul>
</li>
<li>相同<ul>
<li>迭代的每一步都只需要进行一次函数求值</li>
</ul>
</li>
</ul>
<h2 id="3-精度的极限"><a href="#3-精度的极限" class="headerlink" title="3. 精度的极限"></a>3. 精度的极限</h2><ul>
<li>计算机的精度是有限的</li>
<li>二分法可能在中间的某一步停止，此时函数值可能不为 0，但是由于精度问题，计算计算出来的值未 0<ul>
<li>这不是二分法的问题，而是计算机本身精度不够导致的</li>
</ul>
</li>
</ul>
<h3 id="前向误差与后向误差"><a href="#前向误差与后向误差" class="headerlink" title="前向误差与后向误差"></a>前向误差与后向误差</h3><ul>
<li>假设 $f$ 是一个函数，$r$ 是一个根，即 $f(r)&#x3D;0$。假设 $x_a$ 时 $r$ 的近似值。对于根求解问题，近似 $x_a$ 的<strong>后向误差</strong>是 $\vert{f(x_a)}\vert$，<strong>前向误差</strong>是 $\vert{r-x_a}\vert$</li>
<li>前向后向的解释</li>
</ul>
<img src="02/image-20210926220533706.jpg" style="zoom:67%;" />

<ul>
<li><strong>重根</strong></li>
</ul>
<img src="02/image-20210926220650895.jpg" style="zoom:67%;" />

<ul>
<li>在多根附近，函数变化十分缓慢，<strong>垂直方向的后向误差</strong>通常比<strong>水平方向的前向误差</strong>小得多</li>
</ul>
<h3 id="终止条件-2"><a href="#终止条件-2" class="headerlink" title="终止条件"></a>终止条件</h3><ul>
<li>如何设定方程求解器的终止条件？<ul>
<li>$\vert{x_a-r}\vert$ 足够小（前向误差）</li>
<li>$\vert{f(x_a)}\vert$ 足够小（后向误差）</li>
</ul>
</li>
<li>二分法两种误差都可观测<ul>
<li>前向误差：可控，不会大于当前区间的一半</li>
<li>后向误差：可计算</li>
</ul>
</li>
<li>FPI：只能计算出后向误差</li>
<li>其他的终止条件：<strong>计算时间</strong></li>
</ul>
<h3 id="威尔金森多项式"><a href="#威尔金森多项式" class="headerlink" title="威尔金森多项式"></a>威尔金森多项式</h3><ul>
<li>数值求解很难的单根例子</li>
</ul>
<p>$$<br>W(x)&#x3D;(x-1)(x-2)\cdots(x-20)<br>$$</p>
<ul>
<li>展开后的形式很长 $\dots\dots$<ul>
<li>对展开的形式求根困难</li>
<li>求根过程中保存系数的很小误差会被放大，对结果产生很大影响</li>
</ul>
</li>
</ul>
<h3 id="根搜索的敏感性"><a href="#根搜索的敏感性" class="headerlink" title="根搜索的敏感性"></a>根搜索的敏感性</h3><ul>
<li><strong>方程中小的求解误差造成求解根中的大误差</strong></li>
<li><strong>敏感性问题</strong><ul>
<li>在输入中是一个小误差，在这种情况下我们对问题进行求解，造成输出中的大问题</li>
</ul>
</li>
<li>通过<strong>误差放大因子</strong>和<strong>条件数</strong>定量描述</li>
<li>假定 $f(x)&#x3D;0$ 的根为 $x&#x3D;r$，我们对输入做了一个小变化 $\epsilon g(x)$（$\epsilon$ 可能很小），令 $\Delta r$是对应根中的变化</li>
</ul>
<p>$$<br>f(r+\Delta r)+\epsilon g(r+\Delta r)&#x3D;0<br>$$</p>
<ul>
<li>一阶泰勒展开</li>
</ul>
<p>$$<br>f(r)+(\Delta r)f’(r)+\epsilon g(r)+\epsilon(\Delta r)g’(r)+O((\Delta r)^2)<br>$$</p>
<ul>
<li>忽略高阶项</li>
</ul>
<p>$$<br>(\Delta r)(\epsilon g’(r)+f’(r))\approx-f(r)-\epsilon g(r)&#x3D;-\epsilon g(r)<br>$$</p>
<ul>
<li>假定 $\epsilon$ 相对于 $f’(r)$ 来说很小，而且 $f’(r)\ne0$</li>
</ul>
<p>$$<br>\Delta r&#x3D;\dfrac{-\epsilon g(r)}{\epsilon g’(r)+f’(r)}\approx\dfrac{-\epsilon g(r)}{f’(r)}<br>$$</p>
<h4 id="根的敏感性公式"><a href="#根的敏感性公式" class="headerlink" title="根的敏感性公式"></a>根的敏感性公式</h4><ul>
<li>假定 $r$ 是 $f(r)$ 的根，并且 $r+\Delta r$ 是 $f(x)+\epsilon g(x)$ 的根，则当 $\epsilon&lt;&lt;f’(r)$ 时</li>
</ul>
<p>$$<br>\Delta r\approx\dfrac{-\epsilon g(r)}{f’(r)}<br>$$</p>
<h4 id="误差放大因子"><a href="#误差放大因子" class="headerlink" title="误差放大因子"></a>误差放大因子</h4><ul>
<li>相对前向误差 &#x2F; 相对后向误差</li>
<li>求根过程中的误差放大因子</li>
</ul>
<p>$$<br>\left\vert\dfrac{\dfrac{\Delta r}{r}}{\dfrac{\epsilon g(r)}{g(r)}}\right\vert\approx\left\vert{\dfrac{\dfrac{-\epsilon g(r)}{rf’(r)}}{\epsilon}}\right\vert&#x3D;\left\vert{\dfrac{g(r)}{rf’(r)}}\right\vert<br>$$</p>
<h3 id="条件数"><a href="#条件数" class="headerlink" title="条件数"></a>条件数</h3><ul>
<li>条件数：与算法无关，与问题本身有关</li>
<li>稳定：与算法相关，而不是问题本身</li>
</ul>
<img src="02/image-20210926230401057.jpg" style="zoom:67%;" />




      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/09/26/computation/pyr/02/" data-id="cl9lj74a900bg64tz5kmb385l" data-title="计算方法B.裴玉茹.02.非线性方程迭代求解" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/computation/" rel="tag">computation</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/9/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><a class="page-number" href="/page/12/">12</a><span class="space">&hellip;</span><a class="page-number" href="/page/26/">26</a><a class="extend next" rel="next" href="/page/11/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/0/">0</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Algebra/">Algebra</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/C-Kits/">C++.Kits</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG/">CG</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-Algorithm/">CG.Algorithm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-GAMES101/">CG.GAMES101</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-GAMES102/">CG.GAMES102</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-GAMES103/">CG.GAMES103</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-GAMES104/">CG.GAMES104</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-GAMES202/">CG.GAMES202</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-GAMES203/">CG.GAMES203</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-Kits/">CG.Kits</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-LS/">CG.LS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-PBRT/">CG.PBRT</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-Paper/">CG.Paper</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CV/">CV</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Code/">Code</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/DB-CLJ/">DB.CLJ</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/DB-MySQL/">DB.MySQL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/DB-SQLServer/">DB.SQLServer</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/DSA/">DSA</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kits/">Kits</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Math/">Math</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/OS-CXQ/">OS.CXQ</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/OS-OSTEP/">OS.OSTEP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/OS-xv6-labs/">OS.xv6-labs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/OS-xv6-source-code/">OS.xv6-source-code</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/TODO/">TODO</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/book-directory/">book.directory</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/computation-pyr/">computation.pyr</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/csharp-kits/">csharp.kits</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/csharp-tds/">csharp.tds</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/images/">images</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/installation/">installation</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mitsuba/">mitsuba</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/nothing/">nothing</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/software-Maya/">software.Maya</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/software-ps/">software.ps</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/software-vscode/">software.vscode</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/win/">win</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algebra/" rel="tag">Algebra</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BFS/" rel="tag">BFS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BST/" rel="tag">BST</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BVH/" rel="tag">BVH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CG/" rel="tag">CG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CG-Algorithm/" rel="tag">CG-Algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CV/" rel="tag">CV</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Code/" rel="tag">Code</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DB/" rel="tag">DB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DFS/" rel="tag">DFS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DP/" rel="tag">DP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DSA/" rel="tag">DSA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dijkstra/" rel="tag">Dijkstra</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EG/" rel="tag">EG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Floyd/" rel="tag">Floyd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GI/" rel="tag">GI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Glints/" rel="tag">Glints</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HDR/" rel="tag">HDR</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HQX/" rel="tag">HQX</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Heap/" rel="tag">Heap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kits/" rel="tag">Kits</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LCA/" rel="tag">LCA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LLG/" rel="tag">LLG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MCMC/" rel="tag">MCMC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MIS/" rel="tag">MIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MLT/" rel="tag">MLT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Maya/" rel="tag">Maya</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NEE/" rel="tag">NEE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OS/" rel="tag">OS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PBRT/" rel="tag">PBRT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Paper/" rel="tag">Paper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Radiometry/" rel="tag">Radiometry</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RayTracing/" rel="tag">RayTracing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SAH/" rel="tag">SAH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SDF/" rel="tag">SDF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SGJ/" rel="tag">SGJ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/" rel="tag">SQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQLServer/" rel="tag">SQLServer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/STL/" rel="tag">STL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Shadow/" rel="tag">Shadow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WHM/" rel="tag">WHM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WX/" rel="tag">WX</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/YLQ/" rel="tag">YLQ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/book/" rel="tag">book</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/computation/" rel="tag">computation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/csharp/" rel="tag">csharp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/images/" rel="tag">images</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/installation/" rel="tag">installation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/" rel="tag">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/" rel="tag">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mitsuba/" rel="tag">mitsuba</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mobaxterm/" rel="tag">mobaxterm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nothing/" rel="tag">nothing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/obs/" rel="tag">obs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/occlusion/" rel="tag">occlusion</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ps/" rel="tag">ps</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/software/" rel="tag">software</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/test/" rel="tag">test</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tree/" rel="tag">tree</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vscode/" rel="tag">vscode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/win/" rel="tag">win</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xv6/" rel="tag">xv6</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%8C%E5%88%86/" rel="tag">二分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%83%E5%AE%87%E5%AE%99/" rel="tag">元宇宙</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%87%A0%E4%BD%95/" rel="tag">几何</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8F%AF%E8%A7%81%E6%80%A7/" rel="tag">可见性</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%B6%E6%9F%A5%E9%9B%86/" rel="tag">并查集</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/" rel="tag">拓扑排序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8E%92%E5%BA%8F/" rel="tag">排序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%99%AE%E5%90%95%E5%85%8B%E5%9D%90%E6%A0%87/" rel="tag">普吕克坐标</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/" rel="tag">最小生成树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF/" rel="tag">最短路</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/" rel="tag">线段树</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Algebra/" style="font-size: 10px;">Algebra</a> <a href="/tags/BFS/" style="font-size: 10px;">BFS</a> <a href="/tags/BST/" style="font-size: 10px;">BST</a> <a href="/tags/BVH/" style="font-size: 12.5px;">BVH</a> <a href="/tags/C/" style="font-size: 10px;">C++</a> <a href="/tags/CG/" style="font-size: 20px;">CG</a> <a href="/tags/CG-Algorithm/" style="font-size: 10px;">CG-Algorithm</a> <a href="/tags/CV/" style="font-size: 10.63px;">CV</a> <a href="/tags/Code/" style="font-size: 14.38px;">Code</a> <a href="/tags/DB/" style="font-size: 19.38px;">DB</a> <a href="/tags/DFS/" style="font-size: 12.5px;">DFS</a> <a href="/tags/DP/" style="font-size: 13.13px;">DP</a> <a href="/tags/DSA/" style="font-size: 11.25px;">DSA</a> <a href="/tags/Dijkstra/" style="font-size: 10px;">Dijkstra</a> <a href="/tags/EG/" style="font-size: 12.5px;">EG</a> <a href="/tags/Floyd/" style="font-size: 10.63px;">Floyd</a> <a href="/tags/GI/" style="font-size: 11.25px;">GI</a> <a href="/tags/Glints/" style="font-size: 10px;">Glints</a> <a href="/tags/HDR/" style="font-size: 10px;">HDR</a> <a href="/tags/HQX/" style="font-size: 10px;">HQX</a> <a href="/tags/Heap/" style="font-size: 10px;">Heap</a> <a href="/tags/Kits/" style="font-size: 13.75px;">Kits</a> <a href="/tags/LCA/" style="font-size: 10px;">LCA</a> <a href="/tags/LLG/" style="font-size: 12.5px;">LLG</a> <a href="/tags/MCMC/" style="font-size: 10.63px;">MCMC</a> <a href="/tags/MIS/" style="font-size: 10px;">MIS</a> <a href="/tags/MLT/" style="font-size: 10px;">MLT</a> <a href="/tags/Maya/" style="font-size: 10px;">Maya</a> <a href="/tags/MySQL/" style="font-size: 11.88px;">MySQL</a> <a href="/tags/NEE/" style="font-size: 10px;">NEE</a> <a href="/tags/OS/" style="font-size: 17.5px;">OS</a> <a href="/tags/PBRT/" style="font-size: 10px;">PBRT</a> <a href="/tags/Paper/" style="font-size: 15.63px;">Paper</a> <a href="/tags/Radiometry/" style="font-size: 10px;">Radiometry</a> <a href="/tags/RayTracing/" style="font-size: 10px;">RayTracing</a> <a href="/tags/SAH/" style="font-size: 10px;">SAH</a> <a href="/tags/SDF/" style="font-size: 10px;">SDF</a> <a href="/tags/SGJ/" style="font-size: 10.63px;">SGJ</a> <a href="/tags/SQL/" style="font-size: 13.13px;">SQL</a> <a href="/tags/SQLServer/" style="font-size: 10.63px;">SQLServer</a> <a href="/tags/STL/" style="font-size: 11.25px;">STL</a> <a href="/tags/Shadow/" style="font-size: 10px;">Shadow</a> <a href="/tags/WHM/" style="font-size: 16.88px;">WHM</a> <a href="/tags/WX/" style="font-size: 11.88px;">WX</a> <a href="/tags/YLQ/" style="font-size: 18.13px;">YLQ</a> <a href="/tags/book/" style="font-size: 10.63px;">book</a> <a href="/tags/computation/" style="font-size: 18.75px;">computation</a> <a href="/tags/csharp/" style="font-size: 16.25px;">csharp</a> <a href="/tags/images/" style="font-size: 10px;">images</a> <a href="/tags/installation/" style="font-size: 11.88px;">installation</a> <a href="/tags/js/" style="font-size: 10px;">js</a> <a href="/tags/linux/" style="font-size: 11.25px;">linux</a> <a href="/tags/math/" style="font-size: 10px;">math</a> <a href="/tags/mitsuba/" style="font-size: 11.88px;">mitsuba</a> <a href="/tags/mobaxterm/" style="font-size: 10px;">mobaxterm</a> <a href="/tags/nothing/" style="font-size: 10.63px;">nothing</a> <a href="/tags/obs/" style="font-size: 10px;">obs</a> <a href="/tags/occlusion/" style="font-size: 15px;">occlusion</a> <a href="/tags/ps/" style="font-size: 10px;">ps</a> <a href="/tags/software/" style="font-size: 10px;">software</a> <a href="/tags/test/" style="font-size: 10px;">test</a> <a href="/tags/tree/" style="font-size: 11.25px;">tree</a> <a href="/tags/vscode/" style="font-size: 10.63px;">vscode</a> <a href="/tags/win/" style="font-size: 10.63px;">win</a> <a href="/tags/xv6/" style="font-size: 16.25px;">xv6</a> <a href="/tags/%E4%BA%8C%E5%88%86/" style="font-size: 10.63px;">二分</a> <a href="/tags/%E5%85%83%E5%AE%87%E5%AE%99/" style="font-size: 10.63px;">元宇宙</a> <a href="/tags/%E5%87%A0%E4%BD%95/" style="font-size: 10px;">几何</a> <a href="/tags/%E5%8F%AF%E8%A7%81%E6%80%A7/" style="font-size: 11.88px;">可见性</a> <a href="/tags/%E5%B9%B6%E6%9F%A5%E9%9B%86/" style="font-size: 10.63px;">并查集</a> <a href="/tags/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/" style="font-size: 10px;">拓扑排序</a> <a href="/tags/%E6%8E%92%E5%BA%8F/" style="font-size: 10px;">排序</a> <a href="/tags/%E6%99%AE%E5%90%95%E5%85%8B%E5%9D%90%E6%A0%87/" style="font-size: 10px;">普吕克坐标</a> <a href="/tags/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/" style="font-size: 10px;">最小生成树</a> <a href="/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF/" style="font-size: 13.13px;">最短路</a> <a href="/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/" style="font-size: 10px;">线段树</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/10/23/CG/WHM-GAMES103/11/">GAMES103.王华民.11.Incompressible Fluid Dynamics and Eulerian Fluids</a>
          </li>
        
          <li>
            <a href="/2022/10/23/CG/Papers/2021/bvh-survey-3/">(论文)[2021] A Survey on Bounding Volume Hierarchies for Ray Tracing(4)</a>
          </li>
        
          <li>
            <a href="/2022/04/28/CG/Kits/MIS-NEE/">NEE、MIS(多重重要性采样)</a>
          </li>
        
          <li>
            <a href="/2022/04/18/CG/WHM-GAMES103/10/">GAMES103.王华民.10.Surface Waves</a>
          </li>
        
          <li>
            <a href="/2022/04/17/CG/WHM-GAMES103/09-1/">GAMES103.王华民.09.Collision Handling(1)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>