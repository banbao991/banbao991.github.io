<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/3/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-CG/Kits/StratifiedSampling" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/03/15/CG/Kits/StratifiedSampling/" class="article-date">
  <time class="dt-published" datetime="2022-03-15T02:48:00.000Z" itemprop="datePublished">2022-03-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CG-Kits/">CG.Kits</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/03/15/CG/Kits/StratifiedSampling/">Stratified Sampling 分层采样</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Stratified-Sampling"><a href="#Stratified-Sampling" class="headerlink" title="Stratified Sampling"></a>Stratified Sampling</h1><h2 id="分层采样"><a href="#分层采样" class="headerlink" title="分层采样"></a>分层采样</h2><ul>
<li>分层采样就是将采样区域划分为若干个区域，这些区域两两不相交，所有区域的并为原始的积采样区域</li>
<li>在不同区域上分配的样本数，和他们区域上的测度成比例</li>
<li>此时得到的结果仍然是对原始估计的一个无偏估计，而且<strong>方差更小</strong></li>
</ul>
<h3 id="直观感觉"><a href="#直观感觉" class="headerlink" title="直观感觉"></a>直观感觉</h3><ul>
<li>采样的点数没有减少，方差不会变大</li>
<li>分组这个操作提供了新的信息<ul>
<li>想象如下例子，你找的划分恰好把圆划为一部分，剩下的划为一部分，此时 $I&#x3D;EI$，方差为 0</li>
</ul>
</li>
</ul>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><h3 id="蒙特卡洛积分"><a href="#蒙特卡洛积分" class="headerlink" title="蒙特卡洛积分"></a>蒙特卡洛积分</h3><ul>
<li>求 <code>pi</code></li>
</ul>
<img src="StratifiedSampling/fig-3.01-circ-square.jpg" style="zoom: 50%;" />

<ul>
<li>定义</li>
</ul>
<p>$$<br>I&#x3D;\int_{\Omega}g(X)\mathrm{d}\mu(X),X&#x3D;(x,y)<br>$$</p>
<p>$$<br>\Omega&#x3D;{-1\le x\le1,-1\le y\le 1}\<br>$$</p>
<p>$$<br>\mathrm{d}\mu(X)&#x3D;\mathrm{d}x\mathrm{d}y<br>$$</p>
<p>$$<br>g(X)&#x3D;\left{\begin{array}{ll}<br>1,&amp;x^2+y^2&lt;1\<br>0,&amp;else\<br>\end{array}\right.<br>$$</p>
<ul>
<li>实际积分得到：$I&#x3D;\pi$</li>
<li>假设 $p(X)$ 是 $\Omega$ 上的均匀分布，那么对 $I$ 的蒙特卡洛估计如下<ul>
<li>$X_i$ 为独立同分布的样本</li>
</ul>
</li>
</ul>
<p>$$<br>\hat{I}&#x3D;\dfrac{1}{N}\sum_{i&#x3D;1}^{N}\dfrac{g(X_i)}{p(X_i)}<br>$$</p>
<ul>
<li>这是一个无偏估计</li>
</ul>
<p>$$<br>\begin{aligned}<br>E\left[\hat{I}\right]<br>&amp;&#x3D;E\left[\dfrac{1}{N}\sum_{i&#x3D;1}^{N}\dfrac{g(X_i)}{p(X_i)}\right]\<br>&amp;&#x3D;E\left[\dfrac{g(X_i)}{p(X_i)}\right]\<br>&amp;&#x3D;\int_{\Omega}\dfrac{g(X)}{p(X)}p(X);\mathrm{d}\mu(X)\<br>&amp;&#x3D;I<br>\end{aligned}<br>$$</p>
<ul>
<li>方差如下</li>
</ul>
<p>$$<br>\begin{aligned}<br>Var\left[\hat{I}\right]<br>&amp;&#x3D;\dfrac{1}{N^2}Var\left[\sum_{i&#x3D;1}^{N}\dfrac{g(X_i)}{p(X_i)}\right]\<br>&amp;&#x3D;\dfrac{1}{N}Var\left[\dfrac{g(X)}{p(X)}\right]\<br>&amp;&#x3D;\dfrac{1}{N}\left(E\left[(\dfrac{g(X)}{p(X)})^2\right]-\left(E\left[\dfrac{g(X)}{p(X)}\right]\right)^2\right)\<br>&amp;&#x3D;\dfrac{1}{N}\int_{\Omega}\dfrac{g^2(X)}{p(X)};\mathrm{d}\mu(X)-\dfrac{I^2}{N}\<br>\end{aligned}<br>$$</p>
<ul>
<li>根据条件可以简化如下（代码实现）</li>
</ul>
<p>$$<br>\hat{I}&#x3D;\dfrac{1}{N}\sum_{i&#x3D;1}^{N}\dfrac{g(X_i)}{p(X_i)}&#x3D;\dfrac{4}{N}\sum_{i&#x3D;1}^{N}g(X_i)<br>$$</p>
<h3 id="分层采样-1"><a href="#分层采样-1" class="headerlink" title="分层采样"></a>分层采样</h3><ul>
<li>例如这里划分为 <code>4*4</code> 的采样区域，每个区域的样本数正比于区域的大小</li>
</ul>
<img src="StratifiedSampling/fig-3.02-jitter.jpg" style="zoom: 50%;" />

<ul>
<li>每个区域内部还是均匀采样</li>
<li>估计如下<ul>
<li>$N&#x3D;\sum_{i&#x3D;1}^{k}{n_i}$</li>
<li>$\dfrac{1}{p}&#x3D;\sum_{i&#x3D;1}^{k}\dfrac{1}{p_i}$</li>
<li>$X_{i,j}$ 表示在区域 $j$ 采样的第 $i$ 个样本</li>
</ul>
</li>
</ul>
<p>$$<br>\begin{aligned}<br>\hat{I}<em>2&amp;&#x3D;\sum</em>{j&#x3D;1}^{k}\dfrac{1}{n_j}\sum_{i&#x3D;1}^{n_j}\dfrac{g(X_{i,j})}{p_j(X_{i,j})}\<br>\end{aligned}<br>$$</p>
<ul>
<li>这是无偏的<ul>
<li><strong>基于黎曼积分的可加性</strong></li>
</ul>
</li>
</ul>
<p>$$<br>\begin{aligned}<br>E\left[\hat{I}<em>2\right]<br>&amp;&#x3D;E\left[\sum</em>{j&#x3D;1}^{k}\dfrac{1}{n_j}\sum_{i&#x3D;1}^{n_j}\dfrac{g(X_{i,j})}{p_j(X_{i,j})}\right]\<br>&amp;&#x3D;\sum_{j&#x3D;1}^{k}E\left[\dfrac{1}{n_j}\sum_{i&#x3D;1}^{n_j}\dfrac{g(X_{i,j})}{p_j(X_{i,j})}\right]\<br>&amp;&#x3D;\sum_{j&#x3D;1}^{k}E\left[\dfrac{g(X_{i,j})}{p_j(X_{i,j})}\right]\<br>&amp;&#x3D;\sum_{j&#x3D;1}^{k}\int_{\Omega_j}\dfrac{g(X)}{p_j(X)}p_j(X);\mathrm{d}\mu(X)\<br>&amp;&#x3D;\sum_{j&#x3D;1}^{k}\int_{\Omega_j}g(X);\mathrm{d}\mu(X)\<br>&amp;&#x3D;\int_{\Omega}g(X);\mathrm{d}\mu(X)\<br>&amp;&#x3D;I<br>\end{aligned}<br>$$</p>
<ul>
<li>根据均匀采样的性质，可以得到如下式子</li>
</ul>
<p>$$<br>\dfrac{1}{p}&#x3D;\sum_{i&#x3D;1}^{k}\dfrac{1}{p_i}<br>$$</p>
<ul>
<li>按比例分配</li>
</ul>
<p>$$<br>\dfrac{\mathrm{d}\mu(X_i)}{\mathrm{d}\mu(X)}&#x3D;\dfrac{p}{p_i}&#x3D;\dfrac{n_i}{n}<br>$$</p>
<ul>
<li>方差估计</li>
</ul>
<p>$$<br>\begin{aligned}<br>Var\left[\hat{I}<em>2\right]<br>&amp;&#x3D;Var\left[\sum</em>{j&#x3D;1}^{k}\dfrac{1}{n_j}\sum_{i&#x3D;1}^{n_j}\dfrac{g(X_{i,j})}{p_j(X_{i,j})}\right]\<br>&amp;&#x3D;\sum_{j&#x3D;1}^{k}Var\left[\dfrac{1}{n_j}\sum_{i&#x3D;1}^{n_j}\dfrac{g(X_{i,j})}{p_j(X_{i,j})}\right]\<br>&amp;&#x3D;\sum_{j&#x3D;1}^{k}\dfrac{n_j}{n^2_j}Var\left[\dfrac{g(X_{j})}{p_j(X_{j})}\right]\<br>&amp;&#x3D;\sum_{j&#x3D;1}^{k}\dfrac{1}{n_j}Var\left[\dfrac{g(X_{j})}{p_j(X_{j})}\right]\<br>&amp;&#x3D;\sum_{j&#x3D;1}^{k}\dfrac{p_j}{Np}\int_{\Omega_j}\left(\dfrac{g(X_{j})}{p_j(X_{j})}-I_j\right)^2p_{j}(X)\mathrm{d}\mu(X)\<br>&amp;&#x3D;\sum_{j&#x3D;1}^{k}\dfrac{1}{Np}\int_{\Omega_j}\left(g(X_{j})-I_jp_j\right)^2(X)\mathrm{d}\mu(X)\<br>&amp;&#x3D;\dfrac{1}{Np}\sum_{j&#x3D;1}^{k}\int_{\Omega_j}\left(g(X)-I_jp_j\right)^2\mathrm{d}\mu(X)\<br>&amp;&#x3D;\left(\dfrac{1}{N}\sum_{j&#x3D;1}^{k}\int_{\Omega_j}\dfrac{g^2(X)}{p}\mathrm{d}\mu(X)\right)<br>-\sum_{j&#x3D;1}^{k}\dfrac{I_j^2p_j}{Np}\<br>&amp;&#x3D;Var\left[\hat {I}\right]+\dfrac{I^2}{N}-\sum_{j&#x3D;1}^{k}\dfrac{1}{p}\dfrac{I_j^2p_j}{N}\<br>&amp;&#x3D;Var\left[\hat {I}\right]+\dfrac{1}{N}\left(I^2-\sum_{j&#x3D;1}^{k}\dfrac{1}{p_i}\sum_{j&#x3D;1}^{k}I_j^2p_j\right)\<br>\end{aligned}<br>$$</p>
<ul>
<li>根据柯西不等式</li>
</ul>
<p>$$<br>I^2<br>&#x3D;\left(\sum_{i&#x3D;1}^{k} I_i\right)^2<br>&#x3D;\left(\sum_{i&#x3D;1}^{k} \sqrt{p_i}I_i\times\dfrac{1}{\sqrt{p_i}}\right)^2<br>\le\sum_{i&#x3D;1}^{k}p_iI_i^2\sum_{i&#x3D;1}^{k}\dfrac{1}{p_i}<br>$$</p>
<ul>
<li>于是有</li>
</ul>
<p>$$<br>Var\left[\hat{I}_2\right]\le Var\left[\hat{I}\right]<br>$$</p>
<ul>
<li>根据条件可以简化如下（代码实现）</li>
</ul>
<p>$$<br>\begin{aligned}<br>\hat{I}<em>2<br>&amp;&#x3D;\sum</em>{j&#x3D;1}^{k}\dfrac{1}{n_j}\sum_{i&#x3D;1}^{n_j}\dfrac{g(X_{i,j})}{p_j(X_{i,j})}\<br>&amp;&#x3D;\sum_{j&#x3D;1}^{k}\dfrac{4}{kn_j}\sum_{i&#x3D;1}^{n_j}g(X_{i,j})\<br>&amp;&#x3D;\dfrac{4}{N}\sum_{j&#x3D;1}^{k}\sum_{i&#x3D;1}^{n_j}g(X_{i,j})\<br>\end{aligned}<br>$$</p>
<h2 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h2><ul>
<li>上面的期望和方差分析都是一般性的分析</li>
<li>书上的证明<ul>
<li>注意这里的 $p_i$ 表示的是选到这一个划分区域的概率，而不是上面的 pdf</li>
<li>原始蒙特卡洛积分为，积分区域为 $[0,1]^s$</li>
</ul>
</li>
</ul>
<p>$$<br>\int_{\mathcal{L}}\kappa(\mathrm{z})\mathrm{d}F(\mathrm{z})<br>$$</p>
<p><img src="/StratifiedSampling/image-20220315164405222.png"></p>
<p><img src="/StratifiedSampling/image-20220315164422302.png"></p>
<p><img src="/StratifiedSampling/image-20220315164500543.png"></p>
<h2 id="规范化描述"><a href="#规范化描述" class="headerlink" title="规范化描述"></a>规范化描述</h2><h3 id="数值积分"><a href="#数值积分" class="headerlink" title="数值积分"></a>数值积分</h3><p><img src="/StratifiedSampling/image-20220315104550170.png"></p>
<h3 id="蒙特卡洛积分-1"><a href="#蒙特卡洛积分-1" class="headerlink" title="蒙特卡洛积分"></a>蒙特卡洛积分</h3><p><img src="/StratifiedSampling/image-20220315162827071.png"></p>
<h3 id="分层积分"><a href="#分层积分" class="headerlink" title="分层积分"></a>分层积分</h3><p><img src="/StratifiedSampling/image-20220315162855141.png"></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a target="_blank" rel="noopener" href="http://www.mcqmc2012.unsw.edu.au/slides/MCQMC2012_Gopalakrishnan.pdf">课件</a></li>
<li>书籍：Monte Carlo: concepts, algorithms, and applications<ul>
<li>4.3 Stratified Sampling</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/371735546">图形学｜Robust：MC Integration 基础部分+PBRT：MC Sampling 采样算法</a></li>
<li><a target="_blank" rel="noopener" href="https://www.docin.com/p-441150793.html">蒙特卡洛计算中减少方差的技巧</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/03/15/CG/Kits/StratifiedSampling/" data-id="cl9lj749a005764tz9xmudowi" data-title="Stratified Sampling 分层采样" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CG/" rel="tag">CG</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-CG/Kits/rtyl" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/03/11/CG/Kits/rtyl/" class="article-date">
  <time class="dt-published" datetime="2022-03-11T05:56:50.000Z" itemprop="datePublished">2022-03-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CG-Kits/">CG.Kits</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/03/11/CG/Kits/rtyl/">Ray Tracing-The Rest of Your Life</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ul>
<li><a target="_blank" rel="noopener" href="https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html">Ray Tracing: The Rest of Your Life</a></li>
</ul>
<h1 id="Ray-Tracing-The-Rest-of-Your-Life"><a href="#Ray-Tracing-The-Rest-of-Your-Life" class="headerlink" title="Ray Tracing-The Rest of Your Life"></a>Ray Tracing-The Rest of Your Life</h1><h2 id="1-蒙特卡洛采样"><a href="#1-蒙特卡洛采样" class="headerlink" title="1. 蒙特卡洛采样"></a>1. 蒙特卡洛采样</h2><ul>
<li>Monte Carlo (MC)</li>
</ul>
<p><img src="/RTYL/fig-3.01-circ-square.jpg"><br>$$<br>\dfrac{\pi r^2}{(2r)^2}&#x3D;\dfrac{\pi}{4}<br>$$</p>
<h3 id="1-Stratified-Samples-Jittering"><a href="#1-Stratified-Samples-Jittering" class="headerlink" title="(1) Stratified Samples (Jittering)"></a>(1) Stratified Samples (Jittering)</h3><ul>
<li>我们很快能够得到一个 $\pi$ 的估计，但是收敛的很慢<ul>
<li>收益递减定律：law of diminishing return</li>
</ul>
</li>
<li>可以通过分层来降低影响</li>
</ul>
<p><img src="/RTYL/fig-3.02-jitter.jpg"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 常规的 MC</span></span><br><span class="line"><span class="type">double</span> x = <span class="built_in">random_double</span>(<span class="number">-1</span>, <span class="number">1</span>);</span><br><span class="line"><span class="type">double</span> y = <span class="built_in">random_double</span>(<span class="number">-1</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (x * x + y * y &lt; <span class="number">1</span>) &#123;</span><br><span class="line">    ++circle;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 分层 MC</span></span><br><span class="line"><span class="comment">// 分成了 sqrt_N * sqrt_N 个</span></span><br><span class="line">x = <span class="number">2</span> * ((i + <span class="built_in">random_double</span>()) / sqrt_N) - <span class="number">1</span>;</span><br><span class="line">y = <span class="number">2</span> * ((j + <span class="built_in">random_double</span>()) / sqrt_N) - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (x * x + y * y &lt; <span class="number">1</span>) &#123;</span><br><span class="line">    ++circle_j;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Regular    Estimate of PI: 3.1416273200</span><br><span class="line">Stratified Estimate of PI: 3.1415919200</span><br></pre></td></tr></table></figure>

<ul>
<li>效果确实好了，估计得更准确，收敛的也更快<ul>
<li>为什么呢？<strong>分层采样的方差更小</strong></li>
<li><a href="/2022/03/15/CG/Kits/StratifiedSampling/">分层采样的方差分析</a></li>
</ul>
</li>
<li>这个优势会随着维度的增加而递减，例如把上面的代码应用到 3D 的球和正方体，用体积占比算 PI<ul>
<li>维度的诅咒： Curse of Dimensionality</li>
</ul>
</li>
</ul>
<h2 id="2-一维-MC"><a href="#2-一维-MC" class="headerlink" title="2. 一维 MC"></a>2. 一维 MC</h2><h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><p>$$<br>I&#x3D;\int_{0}^{2}x^2;\mathrm{d}x<br>$$</p>
<ul>
<li>$[0,2]$ 上均匀采样，$p(x)&#x3D;\dfrac{1}{2}$</li>
</ul>
<p>$$<br>\hat{I}&#x3D;\dfrac{1}{N}\sum_{i&#x3D;1}^{N}\dfrac{X_i^2}{p(X_i)}&#x3D;\dfrac{1}{N}\sum_{i&#x3D;1}^{N}2X_i^2<br>$$</p>
<ul>
<li>结果如下：$\dfrac{8}{3}$</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2.6671368997</span><br><span class="line">2.6669793315</span><br><span class="line">2.6669378018</span><br></pre></td></tr></table></figure>

<ul>
<li>MC 适用于一些很难显式求出积分的问题，例如</li>
</ul>
<p>$$<br>I&#x3D;\int_{1}^{2}\log(\sin x);\mathrm{d}x<br>$$</p>
<h3 id="PDF"><a href="#PDF" class="headerlink" title="PDF"></a>PDF</h3><ul>
<li>pdf：<em>probability density function</em><ul>
<li>$p(x)$</li>
</ul>
</li>
</ul>
<p>$$<br>\int_{\infty}^{\infty}p(x);\mathrm{d}x&#x3D;1<br>$$</p>
<ul>
<li>cdf：<em>cumulative probability distribution function</em><ul>
<li>$F(x)$</li>
</ul>
</li>
</ul>
<p>$$<br>F(x_0)&#x3D;\int_{-\infty}^{x_0}p(x);\mathrm{d}x<br>$$</p>
<h3 id="采样特定分布"><a href="#采样特定分布" class="headerlink" title="采样特定分布"></a>采样特定分布</h3><ul>
<li>如何从一个均匀分布采样得到另外一个分布呢？</li>
<li>目标 cdf 为 $F(x)$，目标 pdf 为 $p(x)$，$p(x)$ 在 $[0,1]$ 上非零，$U$ 表示 $[0,1]$ 上的均匀分布</li>
<li>我们需要找函数 $f(u(x))$，使得 pdf 为 $p(x)$</li>
<li>设 $X&#x3D;f(U)$</li>
</ul>
<p>$$<br>\begin{aligned}<br>F(x)&amp;&#x3D;\Pr(X\le x)\<br>&amp;&#x3D;\Pr\Big(f(U)\le x\Big)\<br>&amp;&#x3D;\Pr\Big(U\le f^{-1}(x)\Big)\<br>&amp;&#x3D;f^{-1}(x)<br>\end{aligned}<br>$$</p>
<ul>
<li>于是有</li>
</ul>
<p>$$<br>f(x)&#x3D;F^{-1}(x)<br>$$</p>
<ul>
<li>于是我们便可以产生指定分布的样本</li>
</ul>
<h4 id="例子-1"><a href="#例子-1" class="headerlink" title="例子"></a>例子</h4><ul>
<li>指定 $p(x)&#x3D;\dfrac{x}{2},0\le x\le2$</li>
<li>$F(x)&#x3D;\dfrac{x^2}{4}$</li>
<li>$f(x)&#x3D;\sqrt{4y}$</li>
<li>样本生成：$X&#x3D;2\sqrt{U}$</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">estimate_x_x_pdf</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> N = <span class="number">100000000</span>;</span><br><span class="line">    <span class="type">double</span> ans = <span class="number">0.0</span>, ans_pdf = <span class="number">0.0</span>;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        ++num;</span><br><span class="line">        <span class="type">double</span> x = <span class="built_in">random_double</span>(<span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">        ans += <span class="number">2</span> * x * x;</span><br><span class="line"></span><br><span class="line">        x = <span class="number">2</span> * <span class="built_in">sqrt</span>(<span class="built_in">random_double</span>(<span class="number">0</span>, <span class="number">1</span>));</span><br><span class="line">        ans_pdf += x * <span class="number">2</span>;  <span class="comment">// x*x/p(x) = x*x*2/x = x*2</span></span><br><span class="line">        <span class="keyword">if</span> (num % N == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(</span><br><span class="line">                <span class="string">&quot;uniform: %.10lf\n&quot;</span></span><br><span class="line">                <span class="string">&quot;pdf=x/2: %.10lf\n\n&quot;</span>,</span><br><span class="line">                ans / num, ans_pdf / num);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Importance-Sampling"><a href="#Importance-Sampling" class="headerlink" title="Importance Sampling"></a>Importance Sampling</h3><ul>
<li>重要性采样</li>
<li>我们期望在积分值比较大的地方采样更多的样本，这样可以得到更小的噪声，而且收敛更快</li>
<li>我们试图将采样引导向分布中比较重要的部分，这也是我们为什么要设计一个<strong>非均匀分布采样</strong>的原因<ul>
<li>这被称为重要性采样</li>
</ul>
</li>
<li>例如我们如果令 $p(x)&#x3D;\dfrac{f(x)}{\int f(x)}$，此时 $E(X)&#x3D;X,Var[X]&#x3D;0$，直接一次采样返回结果</li>
</ul>
<h3 id="MC-方法流程"><a href="#MC-方法流程" class="headerlink" title="MC 方法流程"></a>MC 方法流程</h3><ul>
<li>一个积分函数</li>
</ul>
<p>$$<br>I&#x3D;\int_{\Omega}g(X);\mathrm{d}\mu(X)<br>$$</p>
<ul>
<li>一个在 $\Omega$ 上不为 0 的分布函数 pdf $p(X)$</li>
<li>采样计算结果</li>
</ul>
<p>$$<br>\hat{I}&#x3D;\dfrac{1}{N}\sum_{i&#x3D;1}^{N}\dfrac{g(X_i)}{p(X_i)}<br>$$</p>
<h2 id="3-球面-MC"><a href="#3-球面-MC" class="headerlink" title="3. 球面 MC"></a>3. 球面 MC</h2><p><img src="/RTYL/image-20220316190428847.png"></p>
<ul>
<li>3D 中的方向可以表示为单位球上的一个点</li>
</ul>
<p>$$<br>X&#x3D;(\theta,\phi)<br>$$</p>
<ul>
<li>考虑球面均匀采样</li>
</ul>
<p>$$<br>\int_{\Omega};\mathrm{d}S&#x3D;4\pi<br>$$</p>
<p>$$<br>\mathrm{d}S&#x3D;\sin\theta;\mathrm{d}\theta;\mathrm{d}\phi<br>$$</p>
<h3 id="例子-2"><a href="#例子-2" class="headerlink" title="例子"></a>例子</h3><p>$$<br>I&#x3D;\int\cos^2\theta;\mathrm{d}S&#x3D;\dfrac{4\pi}{3}<br>$$</p>
<h4 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h4><ul>
<li>均匀采样 $x,y$，等价于对 $\phi,\cos{\theta}$ 均匀采样</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">vec3 <span class="title">vec3::random_on_unit_sphere_surface</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 如何在一个球面上均匀采样 ? 单位球上的面积(r=1)</span></span><br><span class="line">    <span class="comment">// dA = \sin&#123;\theta&#125;d&#123;\theta&#125;d&#123;\phi&#125; = \cos&#123;\theta&#125;d&#123;\phi&#125;</span></span><br><span class="line">    <span class="comment">// 应该是对 \phi, \cos&#123;\theta&#125; 均匀采样</span></span><br><span class="line">    <span class="type">double</span> phi = <span class="built_in">random_double</span>(<span class="number">0</span>, <span class="number">2</span> * pi);</span><br><span class="line">    <span class="type">double</span> z = <span class="built_in">random_double</span>(<span class="number">-1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="type">double</span> r = std::<span class="built_in">sqrt</span>(<span class="number">1</span> - z * z);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">vec3</span>(r * std::<span class="built_in">cos</span>(phi), r * std::<span class="built_in">sin</span>(phi), z);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h4><p>$$<br>I&#x3D;\int_{0}^{\pi}\left(\int_{0}^{2\pi}\cos^2\theta\sin\theta;\mathrm{d}\theta\right);\mathrm{d}\phi<br>$$</p>
<ul>
<li>对 $\phi,\theta$ 均匀采样，此时的估计如下</li>
</ul>
<p>$$<br>p(\theta,\phi)&#x3D;\dfrac{1}{\int_{\Omega};\mathrm{d}\theta;\mathrm{d}\phi}&#x3D;\dfrac{1}{2\pi^2}<br>$$</p>
<h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// I = \int_&#123;\Omega&#125;\cos^2\theta</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">estimate_cos_sphere</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> N = <span class="number">20000000</span>;</span><br><span class="line">    <span class="type">double</span> ans = <span class="number">0.0</span>, ans1 = <span class="number">0.0</span>;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="type">double</span> <span class="type">const</span> pi4 = pi * <span class="number">4</span>;</span><br><span class="line">    <span class="type">double</span> <span class="type">const</span> pi22 = <span class="number">2</span> * pi * pi;</span><br><span class="line">    <span class="type">double</span> <span class="type">const</span> result = pi4 / <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        ++num;</span><br><span class="line">        <span class="comment">// p(x) = 0.5, 0&lt;=x&lt;=2</span></span><br><span class="line">        vec3 x = vec3::<span class="built_in">random_on_unit_sphere_surface</span>();</span><br><span class="line">        <span class="comment">// p(X) = 1/(4*pi)</span></span><br><span class="line">        ans += x.<span class="built_in">z</span>() * x.<span class="built_in">z</span>() * pi4;</span><br><span class="line"></span><br><span class="line">        <span class="type">double</span> theta = <span class="built_in">random_double</span>(<span class="number">0</span>, pi);</span><br><span class="line">        <span class="type">double</span> phi = <span class="built_in">random_double</span>(<span class="number">0</span>, pi2);</span><br><span class="line">        <span class="type">double</span> t = <span class="built_in">cos</span>(theta);</span><br><span class="line">        <span class="comment">// p(X) = 1/(2*pi*pi)</span></span><br><span class="line">        ans1 += t * t * <span class="built_in">sin</span>(theta) * pi22;</span><br><span class="line">        <span class="keyword">if</span> (num % N == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(</span><br><span class="line">                <span class="string">&quot;standard                :   %.10lf\n&quot;</span></span><br><span class="line">                <span class="string">&quot;dS uniform              :   %.10lf\n&quot;</span></span><br><span class="line">                <span class="string">&quot;d(theta), d(phi) uniform:   %.10lf\n&quot;</span>,</span><br><span class="line">                result, ans / num, ans1 / num);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">standard                :   4.1887902048</span><br><span class="line">dS uniform              :   4.1888837271</span><br><span class="line">d(theta), d(phi) uniform:   4.1887124194</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/03/11/CG/Kits/rtyl/" data-id="cl9lj749d005l64tzepbq5ebc" data-title="Ray Tracing-The Rest of Your Life" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CG/" rel="tag">CG</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-software/ps/01" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/03/11/software/ps/01/" class="article-date">
  <time class="dt-published" datetime="2022-03-11T04:58:52.000Z" itemprop="datePublished">2022-03-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/software-ps/">software.ps</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/03/11/software/ps/01/">PS 批量处理图片</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="批量处理图片"><a href="#批量处理图片" class="headerlink" title="批量处理图片"></a>批量处理图片</h1><ul>
<li><a target="_blank" rel="noopener" href="https://jingyan.baidu.com/article/6b97984d887ee25da3b0bf10.html">教程</a></li>
<li>其实用 opencv 更快</li>
</ul>
<h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><ul>
<li>对相同大小的图片进行相同的剪裁效果</li>
<li><strong><span style="color:red">这里的操作是在原始图片上进行修改的，注意提前备份</span></strong></li>
</ul>
<h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><h3 id="1-显示动作窗口"><a href="#1-显示动作窗口" class="headerlink" title="(1) 显示动作窗口"></a>(1) 显示动作窗口</h3><ul>
<li>窗口 <code>-&gt;</code> 动作</li>
</ul>
<h3 id="2-新建动作记录"><a href="#2-新建动作记录" class="headerlink" title="(2) 新建动作记录"></a>(2) 新建动作记录</h3><ul>
<li>可以新建一个组，把用户自定义的动作放到这个组里（区别于默认动作）</li>
</ul>
<p><img src="/01/image-20220311125451894.png"></p>
<ul>
<li>此时新建的动作下面会有录制播放等</li>
</ul>
<p><img src="/01/image-20220311130258284.png"></p>
<ul>
<li>可以先暂停</li>
</ul>
<h3 id="3-录制动作"><a href="#3-录制动作" class="headerlink" title="(3) 录制动作"></a>(3) 录制动作</h3><ul>
<li>打开图片</li>
<li>开始录制，录制结束后停止</li>
<li>效果如下</li>
</ul>
<p><img src="/01/image-20220311130954116.png"></p>
<h3 id="4-组操作"><a href="#4-组操作" class="headerlink" title="(4) 组操作"></a>(4) 组操作</h3><ul>
<li>文件 <code>-&gt;</code> 自动 <code>-&gt;</code> 批处理</li>
</ul>
<p><img src="/01/image-20220311131136986.png"></p>
<ul>
<li>配置</li>
</ul>
<p><img src="/01/image-20220311131953580.png"></p>
<ul>
<li>确定即可</li>
</ul>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ul>
<li>如果不想覆盖原文件，而是另存为，最后一步操作如下<ul>
<li>删除动作序列中的<strong>存储命令</strong></li>
<li>组操作中设置<strong>另存为</strong></li>
</ul>
</li>
</ul>
<p><img src="/01/image-20220311132616528.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/03/11/software/ps/01/" data-id="cl9lj74bp00l464tzhqqb6bkh" data-title="PS 批量处理图片" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ps/" rel="tag">ps</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-software/maya/01" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/03/10/software/maya/01/" class="article-date">
  <time class="dt-published" datetime="2022-03-10T05:17:29.000Z" itemprop="datePublished">2022-03-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/software-Maya/">software.Maya</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/03/10/software/maya/01/">Maya 基础知识</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Maya-基础知识"><a href="#Maya-基础知识" class="headerlink" title="Maya 基础知识"></a>Maya 基础知识</h1><ul>
<li>Maya2019</li>
<li><a target="_blank" rel="noopener" href="http://docs.autodesk.com/MAYAUL/2015/CHS/GettingStarted/#!/url=./files/landing_page.htm">教程</a></li>
</ul>
<h2 id="基本认知"><a href="#基本认知" class="headerlink" title="基本认知"></a>基本认知</h2><ul>
<li>创建多边形基本体的时候，不要双击，而是点右边的复选框，这样能够设置属性</li>
</ul>
<p><img src="/01/image-20220310112813533.png"></p>
<ul>
<li>选中具体的工具之后才能够进行变换操作（平移、旋转、放缩）</li>
</ul>
<p><img src="/01/image-20220310112325229.png"></p>
<ul>
<li>不同的视图模式<ul>
<li><strong>空格键快速切换</strong></li>
</ul>
</li>
</ul>
<p><img src="/01/image-20220310112635230.png"></p>
<h2 id="变换操作"><a href="#变换操作" class="headerlink" title="变换操作"></a>变换操作</h2><ul>
<li>选中物体，可以通过大纲视图中选中某个物体</li>
</ul>
<p><img src="/01/image-20220310114314840.png"></p>
<ul>
<li><strong>如果单击某个特定的控制柄，则表示移动将约束到这一特定轴方向</strong></li>
<li>移动也可以直接拖动，同时也可以通过顶部的 <code>X,Y,Z</code> 设置</li>
</ul>
<p><img src="/01/image-20220310113553183.png"></p>
<ul>
<li>也可以通过<strong>通道盒</strong>设置</li>
</ul>
<p><img src="/01/image-20220310113906961.png"></p>
<h2 id="通道盒"><a href="#通道盒" class="headerlink" title="通道盒"></a>通道盒</h2><p><img src="/01/image-20220310113906961.png"></p>
<ul>
<li>设置变换</li>
<li>重命名<ul>
<li>大纲视图中也可以重命名</li>
</ul>
</li>
</ul>
<h2 id="复制"><a href="#复制" class="headerlink" title="复制"></a>复制</h2><ul>
<li>编辑 <code>-&gt;</code> 特殊复制<ul>
<li>允许设置复制的属性</li>
</ul>
</li>
</ul>
<h2 id="摄像机工具"><a href="#摄像机工具" class="headerlink" title="摄像机工具"></a>摄像机工具</h2><ul>
<li><strong>如下操作都是在移动相机，而不是物体</strong><ul>
<li><code>alt</code> + 鼠标右键：推拉工具(Dolly Tool)</li>
<li><code>alt</code> + 鼠标中键：平移工具(Track Tool)</li>
<li><code>alt</code> + 鼠标左键：翻滚工具(Tumble Tool)</li>
</ul>
</li>
</ul>
<h2 id="着色模式"><a href="#着色模式" class="headerlink" title="着色模式"></a>着色模式</h2><ul>
<li>线框、平滑着色</li>
</ul>
<p><img src="/01/image-20220310125612523.png"></p>
<h2 id="分组对象"><a href="#分组对象" class="headerlink" title="分组对象"></a>分组对象</h2><ul>
<li>按住 <code>shift</code> ，左键选择需要合并成一组的物体</li>
<li>编辑 <code>-&gt;</code> 分组</li>
</ul>
<h2 id="Hypergraph"><a href="#Hypergraph" class="headerlink" title="Hypergraph"></a>Hypergraph</h2><ul>
<li>显示层次结构</li>
</ul>
<p><img src="/01/image-20220310130525833.png"></p>
<p><img src="/01/image-20220310130642463.png"></p>
<ul>
<li>面板 <code>-&gt;</code> 布局<ul>
<li>可以控制面板的布局</li>
</ul>
</li>
</ul>
<h2 id="选择模式和遮罩"><a href="#选择模式和遮罩" class="headerlink" title="选择模式和遮罩"></a>选择模式和遮罩</h2><p><img src="/01/comp_SelectMasks1.png"></p>
<ul>
<li>例子<ul>
<li>按层级和组合选择 + 按层次选择：根<ul>
<li>选中一个物体的时候，会选中整个层级</li>
</ul>
</li>
<li>按层级和组合选择 + 按层次选择：叶<ul>
<li>选中一个物体的时候，只会选中这个物体</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="枢轴点"><a href="#枢轴点" class="headerlink" title="枢轴点"></a>枢轴点</h2><ul>
<li>变换的参考点</li>
<li>例子<ul>
<li>旋转，90度，3副本</li>
</ul>
</li>
</ul>
<p><img src="/01/image-20220310132516940.png"></p>
<h2 id="模板显示"><a href="#模板显示" class="headerlink" title="模板显示"></a>模板显示</h2><ul>
<li>当您的场景变得复杂时，通过为场景中某些对象的显示设置模板，可以更加轻松地仅选择所需的对象</li>
<li>在为对象显示设置模板时，其线框变为灰色。这些对象仍然可见，但不容易选择它们</li>
<li>这有助于防止您意外选择或修改它</li>
<li>方法<ul>
<li>选中需要设置为模板的物体</li>
</ul>
</li>
</ul>
<p><img src="/01/image-20220310133333392.png"></p>
<ul>
<li>取消模板显示<ul>
<li>按层次和组合选择</li>
<li>按层次选择：模板</li>
</ul>
</li>
</ul>
<h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><ul>
<li>选择模式：按组件类型选择</li>
<li>右键</li>
</ul>
<p><img src="/01/image-20220310133923965.png"></p>
<h2 id="属性编辑器"><a href="#属性编辑器" class="headerlink" title="属性编辑器"></a>属性编辑器</h2><p><img src="/01/image-20220310135216067.png"></p>
<h2 id="表面材质"><a href="#表面材质" class="headerlink" title="表面材质"></a>表面材质</h2><ul>
<li>菜单选中为<strong>渲染</strong></li>
<li>选中对象</li>
<li>照明&#x2F;着色 <code>-&gt;</code> 指定新材质</li>
</ul>
<p><img src="/01/image-20220310144315980.png"></p>
<p><img src="/01/image-20220310144747305.png"></p>
<ul>
<li>此时属性管理器中会出现 <code>blinn1</code></li>
</ul>
<p><img src="/01/image-20220310145102939.png"></p>
<h2 id="导出为-OBJ"><a href="#导出为-OBJ" class="headerlink" title="导出为 OBJ"></a>导出为 OBJ</h2><ul>
<li>文件 <code>-&gt;</code> 导出全部</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Warning: skipping Nurbs Surface.</span><br></pre></td></tr></table></figure>

<ul>
<li>此时 Nurbs 表面无法导出</li>
<li>需要先将 <strong>Nurbs 基本体</strong>转化为<strong>多边形基本体</strong></li>
</ul>
<p><img src="/01/image-20220310150926609.png"></p>
<ul>
<li>会有瑕疵，不如一开始就使用多边形基本体</li>
</ul>
<p><img src="/01/image-20220310151445053.png"></p>
<ul>
<li>左边为 maya 预览效果，右边为 win10 自带的查看器</li>
</ul>
<p><img src="/01/image-20220310151558552.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/03/10/software/maya/01/" data-id="cl9lj74br00lf64tz046v4opb" data-title="Maya 基础知识" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Maya/" rel="tag">Maya</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-software/vscode/01" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/03/01/software/vscode/01/" class="article-date">
  <time class="dt-published" datetime="2022-03-01T05:39:44.000Z" itemprop="datePublished">2022-03-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/software-vscode/">software.vscode</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/03/01/software/vscode/01/">vscode 添加预定义宏</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="vscode-添加预定义宏"><a href="#vscode-添加预定义宏" class="headerlink" title="vscode 添加预定义宏"></a>vscode 添加预定义宏</h1><h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/YxiaoqiR/article/details/113175871">参考</a></li>
<li>在使用 vscode 进行工程代码编辑的时候，有些宏是在<strong>编译</strong>的时候定义的，此时 vscode 无法识别，会报错，造成编写代码的时候的不便</li>
</ul>
<p><img src="/01/image-20220301133933353.png"></p>
<ul>
<li>定义的地方</li>
</ul>
<p><img src="/01/image-20220301134023695.png"></p>
<ul>
<li>使用上面的方法则显得很麻烦，每次编译都需要将其注释掉</li>
<li>解决方案是在 vscode 中添加预定义宏</li>
</ul>
<h2 id="添加预定义宏"><a href="#添加预定义宏" class="headerlink" title="添加预定义宏"></a>添加预定义宏</h2><ul>
<li><code>ctrl+shift+p</code> 设置，找到当前工程的配置文件</li>
</ul>
<p><img src="/01/image-20220301134233400.png"></p>
<ul>
<li>在 <code>defines</code> 项中添加即可</li>
</ul>
<p><img src="/01/image-20220301134430748.png"></p>
<ul>
<li>效果如下</li>
</ul>
<p><img src="/01/image-20220301134503547.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/03/01/software/vscode/01/" data-id="cl9lj74bp00l164tz7l7hey0i" data-title="vscode 添加预定义宏" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vscode/" rel="tag">vscode</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-CG/WHM-GAMES103/08" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/02/27/CG/WHM-GAMES103/08/" class="article-date">
  <time class="dt-published" datetime="2022-02-27T12:45:43.000Z" itemprop="datePublished">2022-02-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CG-GAMES103/">CG.GAMES103</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/02/27/CG/WHM-GAMES103/08/">GAMES103.王华民.08.Finite Element Method II</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ul>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV12Q4y1S73g">Bilibili 课程链接</a></li>
</ul>
<h1 id="有限元方法"><a href="#有限元方法" class="headerlink" title="有限元方法"></a>有限元方法</h1><ul>
<li>方法<ul>
<li>The linear finite element method (FEM)</li>
<li>The finite volume method (FVM)</li>
<li>Hyperelastic models</li>
</ul>
</li>
</ul>
<h2 id="FVM"><a href="#FVM" class="headerlink" title="FVM"></a>FVM</h2><ul>
<li>有限体积方法<ul>
<li>Finite Volumn Method</li>
</ul>
</li>
<li>对于四面体、三角形这种简单的、线性的 element 而言， 和之前的 FEM 方法是等价的</li>
<li>但是在推导和数学表示上，FVM 更清晰</li>
<li>FEM 用能量对顶点位置求导得到力，FVM 对 traction vector 积分得到力</li>
</ul>
<h3 id="traction"><a href="#traction" class="headerlink" title="traction"></a>traction</h3><ul>
<li>考虑一个弹性体，被划分为上下两个部分</li>
</ul>
<img src="08/image-20220307230711478.png" style="zoom:80%;" />

<ul>
<li>计算单位长度的力（traction）<ul>
<li>3D：单位面积</li>
</ul>
</li>
<li>那么合力就是积分</li>
</ul>
<img src="08/image-20220307232053043.png" style="zoom:80%;" />

<ul>
<li>定义 stress tensor<ul>
<li>$\sigma$</li>
<li>$\mathbf{n}$：法向</li>
</ul>
</li>
</ul>
<img src="08/image-20220307232253837.png" style="zoom:80%;" />



<h3 id="三角形"><a href="#三角形" class="headerlink" title="三角形"></a>三角形</h3><ul>
<li>假设：一个顶点代表的不是一个点，而是一个区域</li>
<li>那么这个顶点受到的力就是外轮廓的积分<ul>
<li>内力不对整体产生作用</li>
</ul>
</li>
</ul>
<img src="08/image-20220307232611573.png" style="zoom:80%;" />

<ul>
<li>绿色部分的力，绿色曲线上的积分</li>
</ul>
<img src="08/image-20220307232822404.png" style="zoom:80%;" />

<ul>
<li>如何定义绿色曲线？<ul>
<li>假设穿过边的<strong>中点</strong><ul>
<li>力对 3 个顶点的作用是平均的</li>
</ul>
</li>
<li><strong>中间无所谓</strong></li>
</ul>
</li>
<li>stress 在三角形内部是均匀的（线性 element 假设），于是有<ul>
<li><strong>封闭曲线上的法向量积分等于 0</strong></li>
</ul>
</li>
</ul>
<img src="08/image-20220307233150849.png" style="zoom:80%;" />

<ul>
<li>因此 $L$ 上的力如下<ul>
<li>直线上的法向相同</li>
</ul>
</li>
</ul>
<img src="08/image-20220307234850333.png" style="zoom:80%;" />

<ul>
<li>每个小三角形的 stress 不同，因此总的积分不为 0</li>
</ul>
<h3 id="3D"><a href="#3D" class="headerlink" title="3D"></a>3D</h3><ul>
<li>3 维的情况就是面积分<ul>
<li>对 3 个表面的积分（下图没有画出背面）</li>
</ul>
</li>
</ul>
<img src="08/image-20220309231411064.png" style="zoom:80%;" />

<ul>
<li>计算如下<ul>
<li>其中 $\dfrac{1}{3}$ 也是想让面上的力对 3 个顶点的作用一样</li>
</ul>
</li>
</ul>
<img src="08/image-20220309231622611.png" style="zoom:80%;" />



<h3 id="stress"><a href="#stress" class="headerlink" title="stress"></a>stress</h3><ul>
<li>如何计算 stress</li>
<li>这里的 stress 是将 normal 映射到 traction 的一个矩阵<ul>
<li>FEM：stress 是定义在 reference 状态（没有形变）下的</li>
<li>FVM：stress 是定义在 deformed 状态（有形变）下的</li>
</ul>
</li>
</ul>
<img src="08/image-20220309232224384.png" style="zoom:80%;" />

<ul>
<li>不同的 stress，根据 normal&#x2F;traction 定义在没有形变&#x2F;有形变的状态下分类</li>
</ul>
<img src="08/image-20220309232708529.png" style="zoom:80%;" />

<ul>
<li>可以通过 $\dfrac{\partial{W}}{\partial{G}}$ 求得 $\mathbf{S}$</li>
<li>通过 $\mathbf{FS}$ 求得 $\mathbf{P}$<ul>
<li>$\mathbf{P}&#x3D;\mathbf{FS}$</li>
</ul>
</li>
<li>如何求得 $\sigma$ ？<ul>
<li>如何表示形变前后的 normal 之间的关系？</li>
<li>结论：$\sigma&#x3D;\det^{-1}(\mathbf{F})\mathbf{P}\mathbf{F}^{\mathbf{T}}$<ul>
<li>$\sigma&#x3D;\det^{-1}(\mathbf{F})\mathbf{FS}\mathbf{F}^{\mathbf{T}}$</li>
</ul>
</li>
<li>推导如下</li>
</ul>
</li>
</ul>
<img src="08/image-20220309233440050.png" style="zoom:80%;" />

<img src="08/image-20220309233506410.png" style="zoom:80%;" />



<h3 id="stress-关系"><a href="#stress-关系" class="headerlink" title="stress 关系"></a>stress 关系</h3><ul>
<li><a target="_blank" rel="noopener" href="https://engcourses-uofa.ca/books/introduction-to-solid-mechanics/stress/first-and-second-piola-kirchhoff-stress-tensors/">参考</a></li>
</ul>
<h4 id="证明-1"><a href="#证明-1" class="headerlink" title="证明 1"></a>证明 1</h4><ul>
<li>如果 $M$ 满足如下式子，那么有 $\det(M)&#x3D;\mathbf{a}\cdot(\mathbf{b}\times\mathbf{c})$</li>
</ul>
<p>$$<br>M&#x3D;\det\begin{pmatrix}\mathbf{a}^\text{T}\\mathbf{b}^\text{T}\\mathbf{c}^\text{T}\end{pmatrix}<br>&#x3D;\det\begin{pmatrix}\mathbf{a}&amp;\mathbf{b}&amp;\mathbf{c}\end{pmatrix}<br>$$</p>
<ul>
<li>交换两行，行列式值改变符号</li>
</ul>
<p>$$<br>\mathbf{a}\cdot(\mathbf{b}\times\mathbf{c})<br>&#x3D;\mathbf{a}\cdot\det\begin{pmatrix}&amp;\mathbf{b}^\text{T}&amp;\&amp;\mathbf{c}^\text{T}&amp;\i&amp;j&amp;k\end{pmatrix}<br>&#x3D;\det\begin{pmatrix}\mathbf{b}^\text{T}\\mathbf{c}^\text{T}\\mathbf{a}^\text{T}\end{pmatrix}<br>&#x3D;\det\begin{pmatrix}\mathbf{a}^\text{T}\\mathbf{b}^\text{T}\\mathbf{c}^\text{T}\end{pmatrix}<br>$$</p>
<h4 id="证明-2"><a href="#证明-2" class="headerlink" title="证明 2"></a>证明 2</h4><ul>
<li>Nanson’s Formula</li>
<li>如果矩阵 $M\in\mathbb{R}^{3\times3}$ 可逆，而且 $u,v\in\mathbb{R}^{3}$，那么有如下式子成立</li>
</ul>
<p>$$<br>Mu\times Mv&#x3D;\det(M)M^{-T}(u\times v)<br>$$</p>
<ul>
<li>设 $w$ 是任意 $\mathbb{R}^{3}$ 向量，于是有</li>
</ul>
<p>$$<br>\begin{aligned}<br>Mw\cdot(Mu\times Mv)<br>&amp;&#x3D;\det\begin{pmatrix}Mw&amp;Mu&amp;Mv\end{pmatrix}\<br>&amp;&#x3D;\det(M)\det\begin{pmatrix}w&amp;u&amp;v\end{pmatrix}\<br>&amp;&#x3D;\det(M);w\cdot(u\times v)<br>\end{aligned}<br>$$</p>
<ul>
<li>于是</li>
</ul>
<p>$$<br>\begin{aligned}<br>w\cdot\det(M)(u\times v)<br>&amp;&#x3D;\det(M);w\cdot(u\times v)\<br>&amp;&#x3D;Mw\cdot(Mu\times Mv)\<br>&amp;&#x3D;w\cdot M^T(Mu\times Mv)\<br>\end{aligned}<br>$$</p>
<ul>
<li>由于 $w$ 的任意性，于是有</li>
</ul>
<p>$$<br>M^{-T}(Mu\times Mv)&#x3D;\det(M)(u\times v)<br>$$</p>
<ul>
<li>于是有</li>
</ul>
<p>$$<br>Mu\times Mv&#x3D;\det(M)M^{-T}(u\times v)<br>$$</p>
<h4 id="开始证明"><a href="#开始证明" class="headerlink" title="开始证明"></a>开始证明</h4><ul>
<li><p><strong>形变前&#x2F;形变后</strong></p>
<ul>
<li>面积：$A_{\text{ref}}&#x2F;A$</li>
<li>法线：$A_\text{ref}\mathbf{N}&#x2F;A\mathbf{n}$</li>
<li>边：$\mathbf{X}<em>{a0}&#x2F;\mathbf{x}</em>{a0},\mathbf{X}<em>{b0}&#x2F;\mathbf{x}</em>{b0}$</li>
</ul>
</li>
<li><p>根据不同 stress 的定义，我们有如下等式（都是计算形变后的受力）</p>
</li>
</ul>
<p>$$<br>\mathbf{P}(A_{\text{ref}})\mathbf{N}&#x3D;\sigma(A)\mathbf{n}<br>$$</p>
<ul>
<li>利用 Nanson’s Formula，可以得到</li>
</ul>
<p>$$<br>\begin{aligned}<br>(A)\mathbf{n}<br>&amp;&#x3D;\dfrac{A}{\Vert\mathbf{x}<em>{a0}\times\mathbf{x}</em>{b0}\Vert_2}(\mathbf{x}<em>{a0}\times\mathbf{x}</em>{b0})\<br>&amp;&#x3D;\dfrac{1}{2}(\mathbf{x}<em>{a0}\times\mathbf{x}</em>{b0})\<br>&amp;&#x3D;\dfrac{1}{2}(\mathbf{F}\mathbf{X}<em>{a0}\times\mathbf{F}\mathbf{X}</em>{b0})\<br>&amp;&#x3D;\dfrac{1}{2}\det(\mathbf{F})\mathbf{F}^{-\text{T}}(\mathbf{X}<em>{a0}\times\mathbf{X}</em>{b0})\<br>&amp;&#x3D;(A_{\text{ref}})\det(\mathbf{F})\mathbf{F}^{-\text{T}}\mathbf{N}\<br>\end{aligned}<br>$$</p>
<ul>
<li>类似的</li>
</ul>
<p>$$<br>\begin{aligned}<br>(A)\sigma\mathbf{n}<br>&amp;&#x3D;\dfrac{A}{\Vert\mathbf{x}<em>{a0}\times\mathbf{x}</em>{b0}\Vert_2}\sigma(\mathbf{x}<em>{a0}\times\mathbf{x}</em>{b0})\<br>&amp;&#x3D;\dfrac{1}{2}\sigma(\mathbf{x}<em>{a0}\times\mathbf{x}</em>{b0})\<br>&amp;&#x3D;\dfrac{1}{2}\sigma(\mathbf{F}\mathbf{X}<em>{a0}\times\mathbf{F}\mathbf{X}</em>{b0})\<br>&amp;&#x3D;\dfrac{1}{2}\sigma\det(\mathbf{F})\mathbf{F}^{-\text{T}}(\mathbf{X}<em>{a0}\times\mathbf{X}</em>{b0})\<br>&amp;&#x3D;(A_{\text{ref}})\det(\mathbf{F})\sigma\mathbf{F}^{-\text{T}}\mathbf{N}\<br>\end{aligned}<br>$$</p>
<ul>
<li>于是</li>
</ul>
<p>$$<br>\begin{aligned}<br>&amp;(A_{\text{ref}})\mathbf{PN}&#x3D;(A)\sigma\mathbf{n}\<br>\Longrightarrow;&amp;\mathbf{P}&#x3D;\det(\mathbf{F})\sigma\mathbf{F}^{-\text{T}}\<br>\end{aligned}<br>$$</p>
<ul>
<li>$\mathbf{S}$ 的定义</li>
</ul>
<p>$$<br>f2_{\mathbf{N}}&#x3D;\mathbf{S}(A_{\text{ref}})\mathbf{N}&#x3D;\mathbf{F}^{-1}f_{\mathbf{n}}&#x3D;\mathbf{F}^{-1}\sigma(A)\mathbf{n}<br>$$</p>
<ul>
<li>如下图示，$a$ 就表示 $A_\text{ref}$<ul>
<li>**<span style="color:red">定义</span>**：$\mathbf{F}f2_{\mathbf{N}}&#x3D;f_{\mathbf{n}}$</li>
</ul>
</li>
</ul>
<img src="08/Stresses.png" style="zoom: 80%;" />

<ul>
<li>根据</li>
</ul>
<p>$$<br>\mathbf{S}(A_{\text{ref}})\mathbf{N}&#x3D;\mathbf{F}^{-1}\sigma(A)\mathbf{n},(A_{\text{ref}})\mathbf{PN}&#x3D;(A)\sigma\mathbf{n}<br>$$</p>
<ul>
<li>能够得到</li>
</ul>
<p>$$<br>\mathbf{P}&#x3D;\mathbf{FS}<br>$$</p>
<p>$$<br>\mathbf{S}&#x3D;\det(\mathbf{F})\mathbf{F}^{-1}\sigma\mathbf{F}^{-\text{T}}<br>$$</p>
<h2 id="重新表示力"><a href="#重新表示力" class="headerlink" title="重新表示力"></a>重新表示力</h2><ul>
<li>第一行到第二行使用了两种不同的 stress 的表示方式<ul>
<li>第一行：Cauchy Stress</li>
<li>第二行：First Piola–Kirchhoff stress</li>
</ul>
</li>
<li>根据定义，两种表示都能计算得到力<ul>
<li>$\mathbf{b}_1$ 是简写</li>
</ul>
</li>
</ul>
<img src="08/image-20220309235834466.png" style="zoom:80%;" />

<ul>
<li>$\mathbf{b}_1$ 部分表示什么呢？</li>
<li>和三条边点乘<ul>
<li>第二个式子：$\mathbf{X}<em>{01}\times\mathbf{X}</em>{21}&#x3D;\mathbf{X}<em>{01}\times(\mathbf{X}</em>{20}+\mathbf{X}<em>{01})&#x3D;\mathbf{X}</em>{01}\times\mathbf{X}<em>{20}&#x3D;\mathbf{X}</em>{20}\times\mathbf{X}_{10}$</li>
</ul>
</li>
</ul>
<img src="08/image-20220317113642475.png" style="zoom:80%;" />

<ul>
<li>于是我们得到如下形式</li>
</ul>
<img src="08/image-20220317113943536.png" style="zoom:80%;" />

<h2 id="代码框架"><a href="#代码框架" class="headerlink" title="代码框架"></a>代码框架</h2><img src="08/image-20220317114137826.png" style="zoom:80%;" />

<ul>
<li>然后再用力去更新速度、更新位置</li>
<li>FEM、FVM 在一般情况下是不一样的，但是在简单的 linear element 是一样的</li>
</ul>
<h2 id="论文"><a href="#论文" class="headerlink" title="论文"></a>论文</h2><ul>
<li>Teran et al. 2003. <em>Finite Volume Methods for the Simulation of Skeleton Muscles</em>. SCA.</li>
<li>Volino et al. 2009. <em>A Simple Approach to Nonlinear Tensile Stiffness for Accurate Cloth Simulation</em>. TOG.</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/02/27/CG/WHM-GAMES103/08/" data-id="cl9lj749o007g64tz6h0oe73v" data-title="GAMES103.王华民.08.Finite Element Method II" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CG/" rel="tag">CG</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WHM/" rel="tag">WHM</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-CG/WHM-GAMES103/07-1" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/02/27/CG/WHM-GAMES103/07-1/" class="article-date">
  <time class="dt-published" datetime="2022-02-27T09:19:27.000Z" itemprop="datePublished">2022-02-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CG-GAMES103/">CG.GAMES103</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/02/27/CG/WHM-GAMES103/07-1/">GAMES103.王华民.07.Other Constrained Methods and Finite Element Method I(2)</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ul>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV12Q4y1S73g">Bilibili 课程链接</a></li>
</ul>
<h1 id="有限元方法"><a href="#有限元方法" class="headerlink" title="有限元方法"></a>有限元方法</h1><ul>
<li>方法<ul>
<li>The linear finite element method (FEM)</li>
<li>The finite volume method (FVM)</li>
<li>Hyperelastic models</li>
</ul>
</li>
<li>对于 linear element（三角形、四面体），FEM、FVM 是一样的</li>
</ul>
<h2 id="FEM"><a href="#FEM" class="headerlink" title="FEM"></a>FEM</h2><ul>
<li><strong><span style="color:red">这里的例子都是 2D 的</span></strong></li>
<li>Linear Finite Element Method</li>
<li>线性有限元：对于一个三角形，假定内部的形变是均匀的<ul>
<li>对于内部形变，可以使用一个统一的公式描述</li>
</ul>
</li>
</ul>
<p>$$<br>\mathbf{x}&#x3D;\mathbf{F}\mathbf{X}+\mathbf{c}<br>$$</p>
<img src="07-1/image-20220227193957313.png" style="zoom:80%;" />

<ul>
<li>对于</li>
<li>$\mathbf{F}$：表示形变和旋转<ul>
<li>形变梯度：$\mathbf{F}&#x3D;\partial{\mathbf{x}}&#x2F;\partial{\mathbf{X}}$</li>
</ul>
</li>
<li>$\mathbf{c}$：表示平移</li>
</ul>
<h3 id="形变梯度"><a href="#形变梯度" class="headerlink" title="形变梯度"></a>形变梯度</h3><h4 id="求解"><a href="#求解" class="headerlink" title="求解"></a>求解</h4><ul>
<li>如何求 $\mathbf{F}$？</li>
<li>对于一条边（两个点），我们有如下结论</li>
</ul>
<img src="07-1/image-20220227194926469.png" style="zoom:80%;" />

<ul>
<li>通过两条边联立方程组求解</li>
</ul>
<img src="07-1/image-20220227195222219.png" style="zoom:80%;" />

<ul>
<li>$\mathbf{F}$ 中还含有旋转成分，如何去掉旋转成分？</li>
</ul>
<h4 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h4><ul>
<li>形变过程：$\mathbf{F}&#x3D;\mathbf{U}\mathbf{D}\mathbf{V}^{\textbf{T}}$</li>
</ul>
<img src="07-1/image-20220227195644981.png" style="zoom:80%;" />

<ul>
<li>只有 $\mathbf{D}\mathbf{V}^{\textbf{T}}$ 这两个分量和形变相关<ul>
<li>$\mathbf{D}$：形变</li>
<li>$\mathbf{V}^{\textbf{T}}$：朝着哪个方向形变</li>
</ul>
</li>
<li>去掉和形变不相关的成分 $\mathbf{U}$？<ul>
<li>SVD 分解之后去除：麻烦、计算量大</li>
</ul>
</li>
<li>我们发现</li>
</ul>
<p>$$<br>\mathbf{F}^{\textbf{T}}\mathbf{F}<br>&#x3D;\mathbf{V}\mathbf{D}\mathbf{U}^{\textbf{T}}\mathbf{U}\mathbf{D}\mathbf{V}^{\textbf{T}}<br>&#x3D;\mathbf{V}\mathbf{D}^2\mathbf{V}^{\textbf{T}}<br>$$</p>
<ul>
<li>定义 Green Strain</li>
</ul>
<h4 id="Green-Strain"><a href="#Green-Strain" class="headerlink" title="Green Strain"></a>Green Strain</h4><img src="07-1/image-20220227200331316.png" style="zoom:80%;" />

<ul>
<li>strain：描述形变的一个量<ul>
<li>在没有形变的时候为 0</li>
<li>大小和形变的大小正相关</li>
</ul>
</li>
<li>$\mathbf{G}$ 是<strong>旋转无关</strong>的<ul>
<li>加上一个旋转变换 $\mathbf{RF}$，计算得到的 $\mathbf{G}$ 还是一样的</li>
<li><strong>对称矩阵</strong></li>
</ul>
</li>
</ul>
<h3 id="能量密度函数"><a href="#能量密度函数" class="headerlink" title="能量密度函数"></a>能量密度函数</h3><ul>
<li>利用形变（形变梯度 $\mathbf{F}$ ），定义能量密度 $\mathbf{W}(\mathbf{G})$</li>
<li>能量密度：单位面积的能量<ul>
<li>Strain Energy Density Function</li>
</ul>
</li>
<li>整个三角形的能量通过积分得到</li>
</ul>
<img src="07-1/image-20220227201051740.png" style="zoom:80%;" />

<ul>
<li>三角形内部的 $\mathbf{F}$ 相同，于是 $\mathbf{W}(\mathbf{G})$ 也相同</li>
</ul>
<h4 id="StVK"><a href="#StVK" class="headerlink" title="StVK"></a>StVK</h4><ul>
<li>Saint Venant-Kirchhoff Model</li>
</ul>
<img src="07-1/image-20220227201548944.png" style="zoom:80%;" />

<ul>
<li>物理模拟里面实际上用的并不是很多，图形学中用的多（因为简单）</li>
<li>求导</li>
</ul>
<img src="07-1/image-20220227201904641.png" style="zoom:80%;" />

<ul>
<li>$\mathbf{S}$：和力相关</li>
<li>问题：如果四面体反转了，没有办法翻回来</li>
</ul>
<h3 id="求力"><a href="#求力" class="headerlink" title="求力"></a>求力</h3><img src="07-1/image-20220227202450371.png" style="zoom:80%;" />

<ul>
<li>绿色部分能够算出来（上面的 $\mathbf{S}$ ）</li>
<li>需要求灰色部分</li>
<li>从定义出发，推导如下<ul>
<li>a,b,c,d 指代矩阵中的元素</li>
</ul>
</li>
</ul>
<img src="07-1/image-20220227202851256.png" style="zoom:80%;" />

<ul>
<li>上面很复杂！！！</li>
<li>但是可以简化成矩阵形式！！！</li>
</ul>
<img src="07-1/image-20220227203147601.png" style="zoom:80%;" />

<ul>
<li>另外一个点的力，可以通过合力为 0 求得</li>
</ul>
<p>$$<br>\mathbf{f}_0&#x3D;-\mathbf{f}_1-\mathbf{f}_2<br>$$</p>
<h3 id="泛化"><a href="#泛化" class="headerlink" title="泛化"></a>泛化</h3><ul>
<li>对于 linear element，推导思路都是一样的</li>
</ul>
<h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><ul>
<li>Volino et al. 2009. <em>A simple approach to nonlinear tensile stiffness for accurate cloth simulation</em>. TOG</li>
<li>如果对于四面体：所有东西都变为 3 维</li>
</ul>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ul>
<li>没有考虑内部的力</li>
<li>力是怎么来的？<ul>
<li>积分得到的，靠近顶点的一块区域里的积分得到，施加在顶点上</li>
</ul>
</li>
</ul>
<img src="07-1/image-20220227203741003.png" alt="image-20220227203741003" style="zoom:80%;" />

<ul>
<li>衣服的三维模拟，形变梯度是 $2\times3$ 的矩阵<ul>
<li>参考状态是二维的，实际状态是三维的</li>
</ul>
</li>
<li>目前主流的布料模拟方法<ul>
<li>弹簧系统 + 隐式积分 + 近似（高分辨率、高质量）</li>
<li>PBD（低分辨率）</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/02/27/CG/WHM-GAMES103/07-1/" data-id="cl9lj749n007a64tzaccr8byo" data-title="GAMES103.王华民.07.Other Constrained Methods and Finite Element Method I(2)" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CG/" rel="tag">CG</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WHM/" rel="tag">WHM</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-CG/WHM-GAMES103/07" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/02/27/CG/WHM-GAMES103/07/" class="article-date">
  <time class="dt-published" datetime="2022-02-27T06:59:19.000Z" itemprop="datePublished">2022-02-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CG-GAMES103/">CG.GAMES103</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/02/27/CG/WHM-GAMES103/07/">GAMES103.王华民.07.Other Constrained Methods and Finite Element Method I</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ul>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV12Q4y1S73g">Bilibili 课程链接</a></li>
</ul>
<h1 id="约束方法"><a href="#约束方法" class="headerlink" title="约束方法"></a>约束方法</h1><h2 id="Projective-Dynamics"><a href="#Projective-Dynamics" class="headerlink" title="Projective Dynamics"></a>Projective Dynamics</h2><ul>
<li>PBD 中使用投影函数直接改变顶点位置</li>
<li>PD 利用投影函数计算出来的新位置定义一个<strong>二次能量函数</strong>（而不是直接修改顶点位置），利用构造出来的能量函数进行模拟</li>
</ul>
<h3 id="三角形"><a href="#三角形" class="headerlink" title="三角形"></a>三角形</h3><img src="07/image-20220227153322024.png" style="zoom:80%;" />

<ul>
<li>利用 PBD 的投影函数，两个顶点之间的记录计算之后应该就是<strong>弹簧原长</strong>，进一步变形如下</li>
</ul>
<img src="07/image-20220227153835473.png" style="zoom:80%;" />

<ul>
<li><strong>化简之后发现和弹簧的能量表达形式相同</strong></li>
</ul>
<img src="07/image-20220227154107136.png" style="zoom:80%;" />

<img src="07/image-20220227154014434.png" style="zoom:80%;" />

<ul>
<li>能量对位置求负梯度得到力<ul>
<li><strong><span style="color:red">假设 $\mathbf{x}<em>{e,i}^{\textrm{new}}$ 和 $\mathbf{x}</em>{e}$ 无关</span></strong></li>
</ul>
</li>
</ul>
<img src="07/image-20220227154303774.png" style="zoom:80%;" />

<ul>
<li>根据投影函数</li>
</ul>
<img src="07/image-20220227154555020.png" style="zoom:80%;" />

<img src="07/image-20220227154625676.png" style="zoom:80%;" />

<ul>
<li><strong>力和弹簧的力也是一样的</strong></li>
<li>因此这个模型和正常弹簧系统的模拟是一样的，只不过引入了两个中间变量 $\mathbf{x}<em>{e,i}^{\textrm{new}},\mathbf{x}</em>{e,j}^{\textrm{new}}$</li>
<li>为什么使用这个模型而不是原来的弹簧模型？<ul>
<li><strong>Hessian 不一样</strong></li>
</ul>
</li>
</ul>
<h3 id="Hessian"><a href="#Hessian" class="headerlink" title="Hessian"></a>Hessian</h3><img src="07/image-20220227154942251.png" style="zoom:80%;" />

<ul>
<li>Hessian 的可以利用拓扑结构得到（和计算一致）<ul>
<li>对角线：从图上看相邻了几条边就是几</li>
<li>非对角线：存的是边，有就是 $-\mathbf{I}$，否则为 $\mathbf{0}$</li>
</ul>
</li>
</ul>
<h3 id="PD-的好处"><a href="#PD-的好处" class="headerlink" title="PD 的好处"></a>PD 的好处</h3><ul>
<li>利用上面的假设：**<span style="color:red">假设 $\mathbf{x}<em>{e,i}^{\textrm{new}}$ 和 $\mathbf{x}</em>{e}$ 无关</span>**</li>
<li>能够将 Hessian 简化为一个常数矩阵<ul>
<li>常数矩阵能够直接从<strong>拓扑结构</strong>中得到（和计算一致）</li>
</ul>
</li>
<li>Hessian 矩阵是常数之后能够带来大量的计算量上的减少<ul>
<li><a href="/2021/10/02/computation/pyr/03/#lu-%E5%88%86%E8%A7%A3">LU 分解</a>求解 $Ax&#x3D;b$<ul>
<li>在求解方程组的解的时候，需要进行分解操作（计算量很大）</li>
<li>如果是一个常数的话，对所有方程组求解的只需要<strong>分解一次</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="牛顿法"><a href="#牛顿法" class="headerlink" title="牛顿法"></a>牛顿法</h3><ul>
<li>算法流程和隐式积分差不多，但是在方程组求解的部分简化了计算量<ul>
<li>可以理解为就是在隐式积分的过程中，使用了一种方法对 Hessain 矩阵进行了近似</li>
</ul>
</li>
<li>PD 利用牛顿法求解如下</li>
</ul>
<img src="07/image-20220227160433512.png" style="zoom:80%;" />

<ul>
<li>对于弹簧系统而言，力的计算和弹簧的力相同，Hessain又是常数，因此投影这一步完全可以省略<ul>
<li>有些系统是需要保留投影计算这一步的</li>
</ul>
</li>
</ul>
<h3 id="Shape-Matching"><a href="#Shape-Matching" class="headerlink" title="Shape Matching"></a>Shape Matching</h3><ul>
<li>没讲</li>
</ul>
<img src="07/image-20220227162444348.png" style="zoom:80%;" />



<h3 id="可行性分析"><a href="#可行性分析" class="headerlink" title="可行性分析"></a>可行性分析</h3><ul>
<li>为什么这样对 Hessian 的计算也可以比较好的模拟？</li>
<li>本质上是对 Hessian 的一个合理近似</li>
<li>效率取决于对 Hessian 近似的好不好</li>
</ul>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ul>
<li>游戏中的布料模拟<ul>
<li>例如衣服，更多的是利用人体骨骼驱动，在加上 PBD 的方法</li>
<li>在实际游戏模拟过程中，主要开销是在<strong>内存访问</strong>上，计算开销并不大</li>
<li>PBD 对于内存的访问很少（只需要访问顶点位置），其他方法可能还有一些其他的物理变量需要访问</li>
<li>高性能的优化，内存访问是一个关键</li>
</ul>
</li>
</ul>
<h3 id="评价"><a href="#评价" class="headerlink" title="评价"></a>评价</h3><ul>
<li>红色：PD</li>
</ul>
<img src="07/image-20220227162531368.png" style="zoom:80%;" />



<h4 id="Pros"><a href="#Pros" class="headerlink" title="Pros"></a>Pros</h4><ul>
<li>和 PBD 相比，是有物理含义的</li>
<li>在 CPU 上，作为直接法求解，效率很高（只需要分解一次）</li>
<li>在前几次迭代过程中收敛很快</li>
</ul>
<h4 id="Cons"><a href="#Cons" class="headerlink" title="Cons"></a>Cons</h4><ul>
<li>GPU 上比较慢<ul>
<li>LU 分解在 GPU 上不太合适</li>
<li>直接法在 GPU 上支持的都不太好</li>
</ul>
</li>
<li>整体而言，收敛的比较慢（假设中没有考虑 projection 导致的 Hessian）</li>
<li>约束改变之后，修改起来比较麻烦（Hessain 矩阵需要修改）<ul>
<li>例如破碎 fracture</li>
</ul>
</li>
</ul>
<h3 id="论文"><a href="#论文" class="headerlink" title="论文"></a>论文</h3><ul>
<li>Bouaziz et al. 2014. <em>Projective Dynamics: Fusing Constraint Projections for Fast Simulation. TOG (SIGGRAPH)</em>.</li>
</ul>
<h2 id="Constrained-Dynamics"><a href="#Constrained-Dynamics" class="headerlink" title="Constrained Dynamics"></a>Constrained Dynamics</h2><ul>
<li>为了处理非常 stiff 的约束<ul>
<li>更多的用在刚体模拟</li>
<li>例如人体的约束，大臂和小臂连接点的限制（这个约束很强，必须要满足，否则很诡异）</li>
</ul>
</li>
<li>预先引入一个新的变量 $\mathbf{\lambda}$，这样能够处理非常 stiff 的情况</li>
</ul>
<h3 id="转换"><a href="#转换" class="headerlink" title="转换"></a>转换</h3><ul>
<li>约束还是一样</li>
</ul>
<img src="07/image-20220227164038504.png" style="zoom:80%;" />

<ul>
<li>能量写成矩阵形式，力也一样</li>
</ul>
<img src="07/image-20220227164106876.png" style="zoom:80%;" />

<ul>
<li>之前做隐式积分只有一个变量，现在有两个（$\mathbf{x}&#x2F;\mathbf{v},\mathbf{\lambda}$）</li>
<li>动量守恒：冲量 &#x3D; 动量的变化量</li>
</ul>
<img src="07/image-20220227164810005.png" style="zoom:80%;" />

<ul>
<li>近似<ul>
<li>泰勒展开</li>
<li>位置变化量 &#x3D; 速度 $\times$ 时间</li>
</ul>
</li>
</ul>
<img src="07/image-20220227164927403.png" style="zoom:80%;" />

<ul>
<li>把上面两个约束放到同一个矩阵中（一起更新）</li>
</ul>
<img src="07/image-20220227165239458.png" style="zoom:80%;" />



<h3 id="求解"><a href="#求解" class="headerlink" title="求解"></a>求解</h3><h4 id="Method-1"><a href="#Method-1" class="headerlink" title="Method 1"></a>Method 1</h4><ul>
<li>primal dual method：两个变量一起求解</li>
<li>直接求解矩阵</li>
</ul>
<img src="07/image-20220227165239458.png" style="zoom:80%;" />

<ul>
<li>系数矩阵不一定是正定的</li>
</ul>
<h4 id="Method-2"><a href="#Method-2" class="headerlink" title="Method 2"></a>Method 2</h4><ul>
<li>消元，先求解 $\mathbf{\lambda}^{\textrm{new}}$</li>
</ul>
<img src="07/image-20220227165527129.png" style="zoom:80%;" />

<ul>
<li>消元不一定很简单</li>
</ul>
<h3 id="好处"><a href="#好处" class="headerlink" title="好处"></a>好处</h3><ul>
<li>stiffness 很大的时候，$k\to\infty\Longrightarrow\mathbf{C}\to\mathbf{0}$</li>
<li>原来 $k\to\infty$ 不好模拟，但是 $\mathbf{C}\to\mathbf{0}$ 让模拟更简单了</li>
</ul>
<h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><ul>
<li>Articulated Rigid Bodies (<strong>ragdoll animation</strong>)<ul>
<li>假设人体是有很多刚体构成的，刚体和刚体之间有很多约束</li>
</ul>
</li>
</ul>
<h2 id="Stable-Constrained-Dynamics"><a href="#Stable-Constrained-Dynamics" class="headerlink" title="Stable Constrained Dynamics"></a>Stable Constrained Dynamics</h2><ul>
<li>没讲</li>
</ul>
<img src="07/image-20220227165239458.png" style="zoom:80%;" />

<ul>
<li>上面矩阵求解如果把 $mathbf{\lambda}$ 消去之后，则和隐式积分相同，但是 Hessian 有一部分消失了，如果把这部分加上去，模拟会更加稳定</li>
</ul>
<img src="07/image-20220227170954309.png" style="zoom:80%;" />



<h3 id="推导"><a href="#推导" class="headerlink" title="推导"></a>推导</h3><img src="07/image-20220227170805317.png" style="zoom:80%;" />

<img src="07/image-20220227170938428.png" style="zoom:80%;" />



<h3 id="论文-1"><a href="#论文-1" class="headerlink" title="论文"></a>论文</h3><ul>
<li>Tournier et al. 2015. <em>Stable Constrained Dynamics. TOG (SIGGRAPH)</em>.</li>
</ul>
<h2 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h2><img src="07/image-20220227171406617.png" style="zoom:80%;" />
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/02/27/CG/WHM-GAMES103/07/" data-id="cl9lj749n007e64tzew34h7n3" data-title="GAMES103.王华民.07.Other Constrained Methods and Finite Element Method I" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CG/" rel="tag">CG</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WHM/" rel="tag">WHM</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-CG/WHM-GAMES103/06-1" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/02/24/CG/WHM-GAMES103/06-1/" class="article-date">
  <time class="dt-published" datetime="2022-02-24T02:07:23.000Z" itemprop="datePublished">2022-02-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CG-GAMES103/">CG.GAMES103</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/02/24/CG/WHM-GAMES103/06-1/">GAMES103.王华民.06.Constrained Approaches(PBD, PD and others)(2)</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ul>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV12Q4y1S73g">Bilibili 课程链接</a></li>
</ul>
<h1 id="约束方法"><a href="#约束方法" class="headerlink" title="约束方法"></a>约束方法</h1><ul>
<li>在现实生活中，布料对于拉伸的抵抗比较强，只能有少量拉伸</li>
<li>简单的调大弹性系数 $k$ 会带来如下问题，导致<strong>计算量变得很大</strong><ul>
<li>显示积分不稳定</li>
<li>隐式积分中的线性系统会变成病态的（ill-conditioned）</li>
</ul>
</li>
<li>约束方法就是为了解决拉伸的问题而被提出的</li>
</ul>
<h2 id="一根弹簧"><a href="#一根弹簧" class="headerlink" title="一根弹簧"></a>一根弹簧</h2><ul>
<li>写出约束如下</li>
</ul>
<img src="06-1/image-20220223224102833.png" style="zoom:80%;" />

<ul>
<li><strong>投影函数</strong>需要让边趋向于原长（如下图），如何构造？</li>
</ul>
<img src="06-1/image-20220223224219294.png" style="zoom:80%;" />

<ul>
<li>投影问题描述如下<ul>
<li>两个点是 6 维的，看成 6 维空间中的一个点，我们需要将这个点移动到 6 维空间中的可行区域中，而且需要让移动距离<strong>尽可能小</strong></li>
</ul>
</li>
<li>图示</li>
</ul>
<img src="06-1/image-20220223224657159.png" style="zoom:80%;" />

<ul>
<li>数学描述如下</li>
</ul>
<img src="06-1/image-20220223224736350.png" style="zoom:80%;" />

<ul>
<li>投影函数，计算结果如下<ul>
<li>质心不变</li>
<li>点移动距离和质量反相关</li>
</ul>
</li>
</ul>
<img src="06-1/image-20220223230117179.png" style="zoom:80%;" />

<ul>
<li>代入验证，新位置满足约束条件</li>
<li>质量设置<ul>
<li>为了方便，一般设置为相同</li>
<li>固定点，质量设置为无穷大<ul>
<li>固定点直接不更新（作业）</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="多根弹簧"><a href="#多根弹簧" class="headerlink" title="多根弹簧"></a>多根弹簧</h2><h3 id="Gauss-Seidel-Approach"><a href="#Gauss-Seidel-Approach" class="headerlink" title="Gauss-Seidel Approach"></a>Gauss-Seidel Approach</h3><ul>
<li>高斯塞达尔方法（A Gauss-Seidel Approach）</li>
<li>分别处理每根弹簧<ul>
<li>因为处理完一根弹簧之后，会影响其他弹簧的位置，因此是一个反复迭代更新的过程</li>
</ul>
</li>
</ul>
<img src="06-1/image-20220223230608615.png" style="zoom:80%;" />

<ul>
<li>算法如下</li>
</ul>
<img src="06-1/image-20220223230800043.png" style="zoom:80%;" />

<ul>
<li>无法保证所有边都满足限制，但是迭代次数越多能够尽可能让更多边满足</li>
<li>循环的时候，边的顺序会影响计算结果<ul>
<li>可能会造成偏向性（artifact）</li>
<li>可能会影响收敛速度</li>
</ul>
</li>
</ul>
<h3 id="Jacobi-Approach"><a href="#Jacobi-Approach" class="headerlink" title="Jacobi Approach"></a>Jacobi Approach</h3><ul>
<li>两个目的<ul>
<li>减少由于边的顺序带来的 artifact</li>
<li>尽可能可以并行（更容易并行）</li>
</ul>
</li>
<li>思路：每条边计算得到的偏移量不直接更新，而是记录下来，最后计算完了再加权更新</li>
<li>算法如下</li>
</ul>
<img src="06-1/image-20220223232112020.png" style="zoom:80%;" />

<ul>
<li>问题：收敛率更低</li>
<li>同样的，迭代次数越多效果越好</li>
</ul>
<h2 id="PBD"><a href="#PBD" class="headerlink" title="PBD"></a>PBD</h2><ul>
<li>Position Based Dynamics</li>
<li>基于上面的投影函数提出的算法<ul>
<li>自由模拟 + 约束修正<ul>
<li>和刚体的 shape matching 思路一致</li>
</ul>
</li>
</ul>
</li>
</ul>
<img src="06-1/image-20220223232445662.png" style="zoom:80%;" />



<h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><ul>
<li>没有能量、力的概念<ul>
<li>弹性系数是由一些非物理因素控制的<ul>
<li>迭代次数：迭代次数越多，约束满足的越好，显得弹性系数很大（硬）</li>
<li>网格分辨率：顶点数量很少，则能够很快收敛，显得弹性系数很大（硬）</li>
</ul>
</li>
</ul>
</li>
<li>速度更新很重要<ul>
<li>为什么是 $v+$，因为需要考虑原始速度</li>
</ul>
</li>
<li>这样的方法还可以适用于其他约束<ul>
<li>形状约束、体积约束、碰撞约束</li>
</ul>
</li>
</ul>
<h3 id="评价"><a href="#评价" class="headerlink" title="评价"></a>评价</h3><h4 id="Pros"><a href="#Pros" class="headerlink" title="Pros"></a>Pros</h4><ul>
<li>很容易并行，适合于 GPU<ul>
<li>PhysX</li>
</ul>
</li>
<li>容易实现</li>
<li>低分辨率下运行很快<ul>
<li>1000 点以内可以满足实时性</li>
</ul>
</li>
<li>通用性很强</li>
</ul>
<h4 id="Cons"><a href="#Cons" class="headerlink" title="Cons"></a>Cons</h4><ul>
<li>没有什么物理含义，不是物理准确的<ul>
<li>弹性手网格分辨率、迭代次数影响，难控制</li>
</ul>
</li>
<li>高分辨率下运行慢<ul>
<li>层次结构<ul>
<li>Hierarchical approaches (can cause oscillation and other issues…)<ul>
<li>Muller. 2008. <em>Hierarchical Position Based Dynamics.</em> VRIPHYS.</li>
</ul>
</li>
</ul>
</li>
<li>加速方式（Chebyshev）</li>
</ul>
</li>
</ul>
<h4 id="评价-1"><a href="#评价-1" class="headerlink" title="评价"></a>评价</h4><ul>
<li>适合游戏开发中低分辨率的网格衣服的模拟</li>
<li><strong>低精度实时模拟</strong></li>
</ul>
<h2 id="Strain-Limiting"><a href="#Strain-Limiting" class="headerlink" title="Strain Limiting"></a>Strain Limiting</h2><ul>
<li>整个思想的提出比 PBD 要早</li>
<li>但是这个方法可以认为是 PBD 的改进版</li>
<li>和 PBD 类似，但是 Strain Limiting 只是使用 projection function 进行纠正</li>
</ul>
<img src="06-1/image-20220225143855278.png" style="zoom:80%;" />

<h3 id="弹簧"><a href="#弹簧" class="headerlink" title="弹簧"></a>弹簧</h3><ul>
<li>Spring Strain Limit<ul>
<li>strain：描述形变的量 $\sigma-1$</li>
</ul>
</li>
<li>定义拉伸比例（stretching  ratio）<ul>
<li>长度除以原长</li>
</ul>
</li>
</ul>
<img src="06-1/image-20220225144058559.png" style="zoom:80%;" />

<ul>
<li>可以认为是约束放宽了的 PBD</li>
<li>投影函数如下</li>
</ul>
<img src="06-1/image-20220225144418911.png" style="zoom:80%;" />

<ul>
<li>Why Strain Limiting？<ul>
<li>模拟很多面料在拉伸到一定程度之后变得很 stiff 的情况</li>
<li>让数值模拟的过程更稳定</li>
</ul>
</li>
</ul>
<h3 id="三角形面积"><a href="#三角形面积" class="headerlink" title="三角形面积"></a>三角形面积</h3><ul>
<li>Triangle Area Limit</li>
<li>思路和上面差不多<ul>
<li>质心不变，进行缩放</li>
</ul>
</li>
<li>约束条件</li>
</ul>
<img src="06-1/image-20220225145140917.png" style="zoom:80%;" />

<ul>
<li>目标函数</li>
</ul>
<img src="06-1/image-20220225145239226.png" style="zoom:80%;" />

<ul>
<li>质心不变<ul>
<li>数学上：三个顶点的运动量最小</li>
<li>物理上：没有新的动量，不会因为约束而产生奇怪的运动</li>
</ul>
</li>
</ul>
<h3 id="评价-2"><a href="#评价-2" class="headerlink" title="评价"></a>评价</h3><ul>
<li>可以保证在模拟的过程中不发生大形变<ul>
<li>更稳定</li>
<li>更少的 artifact</li>
</ul>
</li>
<li>可以模拟布料在形变比较小的时候可以被拉伸，拉伸到一定程度之后变得 stiff 的效果<ul>
<li>另外一种方式：形变比较小的时候使用上面的模型，比较大的时候使用 strain limiting</li>
</ul>
</li>
</ul>
<img src="06-1/image-20220225225157275.png" style="zoom:80%;" />

<ul>
<li>能够帮助解决 locking issue<ul>
<li>第一个阶段使用比较小的弹性系数进行模拟（减轻 locking issue）</li>
</ul>
</li>
</ul>
<h3 id="论文"><a href="#论文" class="headerlink" title="论文"></a>论文</h3><ul>
<li>Provot. 1995. <em>Deformation Constraints in a Mass-Spring Model to Describe Rigid Cloth Behavior.</em> Graphics Interface.(optional)</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/02/24/CG/WHM-GAMES103/06-1/" data-id="cl9lj749m007864tz0aqm4c19" data-title="GAMES103.王华民.06.Constrained Approaches(PBD, PD and others)(2)" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CG/" rel="tag">CG</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WHM/" rel="tag">WHM</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-CG/Papers/2018/geomlt" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/02/08/CG/Papers/2018/geomlt/" class="article-date">
  <time class="dt-published" datetime="2022-02-08T01:24:00.000Z" itemprop="datePublished">2022-02-08</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CG-Paper/">CG.Paper</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/02/08/CG/Papers/2018/geomlt/">(论文)[2018] Geometry-Aware Metropolis Light Transport</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="GeoMLT"><a href="#GeoMLT" class="headerlink" title="GeoMLT"></a>GeoMLT</h1><ul>
<li>Geometry-Aware Metropolis Light Transport</li>
<li>Hisanari Otsu, Johannes Hanika, Toshiya Hachisuka, and Carsten Dachsbacher. 2018. Geometry-Aware Metropolis Light Transport. <em>ACM Trans. Graph.</em> 37, 6, Article 278 (November 2018), 11 pages. <a target="_blank" rel="noopener" href="https://doi.org/10.1145/3272127.3275106">https://doi.org/10.1145/3272127.3275106</a></li>
</ul>
<h1 id="0-展示"><a href="#0-展示" class="headerlink" title="0. 展示"></a>0. 展示</h1><img src="geomlt/image-20220208092831418.png" style="zoom:80%;" />

<ul>
<li>30 分钟渲染的结果，光源在门外<ul>
<li>reference 是通过 BDPT 渲染收敛得到</li>
</ul>
</li>
<li>传统的 MLT 在边界、间隙的时候由于可见性的改变，变异得到的路径常常会被拒绝，我们的方法根据几何信息控制变异的大小<ul>
<li>adaptively controls the mutation size according to the geometry information surrounding each path segment</li>
</ul>
</li>
<li>我们的方法能够很好的避免由于可见性导致的零贡献样本（不可见）</li>
<li>通过估计最大的可见的圆锥顶角来限制突变步长，从而避免可见性问题<ul>
<li>在不降低采样质量的前提下，提高 MLT 突变的接受率</li>
</ul>
</li>
<li>直接估计代价较大，我们还提出了加速方式</li>
</ul>
<h1 id="1-INTRODUCTION"><a href="#1-INTRODUCTION" class="headerlink" title="1. INTRODUCTION"></a>1. INTRODUCTION</h1><ul>
<li>MCMC 渲染方式</li>
<li>高效的 MCMC 取决于如下因素<ul>
<li>the design of the transition kernel (path mutation)<ul>
<li>小步长的样本 $\to$ 和之前的样本比较像 $\to$ 较高的接受率</li>
</ul>
</li>
<li>the autocorrelation between states<ul>
<li>自相关程度高 $\to$ 样本附加信息少 $\to$ 样本质量低</li>
<li>步长大 $\to$ 容易被拒绝</li>
</ul>
</li>
</ul>
</li>
<li>通过局部结构来控制变化的步长</li>
<li>我们着重考虑因为<strong>可见性问题</strong>（不可见）导致的被拒绝的路径</li>
<li>如下图，蓝色范围表示突变核 kernel<ul>
<li>右边的 kernel 更好，左边可能会产生由于不可见而被拒绝的路径，右边不会</li>
</ul>
</li>
</ul>
<img src="geomlt/image-20220209102035507.png" style="zoom:80%;" />

<ul>
<li>现在的考虑可适应步长的方法没有考虑可见性问题<ul>
<li>Wenzel Jakob and Stephen Marschner. 2012. Manifold exploration: a Markov chain Monte Carlo technique for rendering scenes with difficult specular transport. ACM Transactions on Graphics (Proc. SIGGRAPH) 31, 4, Article 58 (2012).</li>
<li>Tzu-Mao Li, Jaakko Lehtinen, Ravi Ramamoorthi, Wenzel Jakob, and Frédo Durand. 2015. Anisotropic Gaussian Mutations for Metropolis Light Transport Through Hessian-Hamiltonian Dynamics. ACM Transactions on Graphics (Proc. SIGGRAPH Asia) 34, 6 (2015), 209:1–209:13.</li>
</ul>
</li>
<li><strong>我们第一次在 MCMC 中考虑了可见性因素</strong></li>
<li>文章的贡献<ul>
<li>第一次在 MCMC 中考虑了可见性因素</li>
<li>如上图所示，给出了一种快速估计最大的圆锥顶角的算法</li>
<li>很容易集成到现有的 MLT 算法中，我们给出了实现</li>
</ul>
</li>
</ul>
<h1 id="2-BACKGROUND-AND-PREVIOUS-WORK"><a href="#2-BACKGROUND-AND-PREVIOUS-WORK" class="headerlink" title="2. BACKGROUND AND PREVIOUS WORK"></a>2. BACKGROUND AND PREVIOUS WORK</h1><h2 id="2-1-Light-Transport-Simulation"><a href="#2-1-Light-Transport-Simulation" class="headerlink" title="2.1 Light Transport Simulation"></a>2.1 Light Transport Simulation</h2><ul>
<li>intensity $I_j$ of the $j$-th pixel<ul>
<li><strong><span style="color:red">论文中之后把 $f_j$ 简写为 $f$</span></strong></li>
</ul>
</li>
</ul>
<p>$$<br>I_j&#x3D;\int_{\Omega}f_j(\bar{x});\mathrm{d}\mu(\bar{x})<br>$$</p>
<ul>
<li>$\Omega$：任意长度、所有可能的路径空间</li>
</ul>
<p>$$<br>\Omega&#x3D;\bigcup_{k&#x3D;2}^{\infty}\Omega_{k}<br>$$</p>
<ul>
<li>$\Omega_{k}$：结点数为 $k$ 的路径空间</li>
<li>$\bar{x}$：路径<ul>
<li>$\bar{x}&#x3D;(\mathrm{x}_1,\cdots,\mathrm{x}_k)\in\Omega$</li>
</ul>
</li>
<li>$\mathcal{M}$：场景表面集合<ul>
<li>$\mathrm{x}_i\in\mathcal{M},;i&#x3D;1,\cdots,k$</li>
</ul>
</li>
<li>采样算法<ul>
<li>Path Tracing：Kajiya 1986</li>
<li>Light Tracing：Arvo 1986</li>
<li>BDPT：Lafortune and Willems 1993; Veach and Guibas 1994</li>
</ul>
</li>
</ul>
<h2 id="2-2-MCMC-Rendering"><a href="#2-2-MCMC-Rendering" class="headerlink" title="2.2 MCMC Rendering"></a>2.2 MCMC Rendering</h2><ul>
<li><p>论文这一段是对 MLT 的介绍</p>
</li>
<li><p>MCMC：MLT</p>
<ul>
<li>Veach and Guibas 1997</li>
<li>把 $f$ 作为目标分布的时候，最终路径的分布会趋近于 $f&#x2F;b$（归一化后的分布）</li>
</ul>
<p>  $$<br>  b&#x3D;\int_{\Omega}f(\bar{x});\mathrm{d}\mu(\bar{x})<br>  $$</p>
</li>
<li><p>Metropolis-Hastings (MH) algorithm</p>
<ul>
<li>Hastings 1970; Metropolis et al. 1953</li>
</ul>
</li>
</ul>
<h3 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h3><ul>
<li>生成一系列的路径样本，新样本 $y$ 的生成只依赖于上一个样本 $x$，转移核 $T$</li>
</ul>
<p>$$<br>\bar{y}\sim T(\bar{x}\to\bar{y})<br>$$</p>
<ul>
<li>新样本以一定概率被接受</li>
</ul>
<img src="geomlt/image-20220213085003715.png" style="zoom:80%;" />

<ul>
<li>最后一部分等式推导</li>
</ul>
<p>$$<br>R(\bar{x}_i\to\bar{y})\equiv f (\bar{y})&#x2F;T(\bar{x}_i\to\bar{y})<br>$$</p>
<ul>
<li>$f^{\ast}$：the scalar contribution function, which typically is the <strong>luminance</strong> of $f$</li>
</ul>
<img src="geomlt/image-20220213085323853.png" style="zoom:80%;" />



<h3 id="变异策略"><a href="#变异策略" class="headerlink" title="变异策略"></a>变异策略</h3><ul>
<li>变异策略基于状态空间<ul>
<li>PSSMLT：Kelemen et al. [2002]</li>
<li>MMLT：Hachisuka et al. [2014]<ul>
<li>利用 MIS 将 PSSMLT 和 BDPT 结合在一起</li>
</ul>
</li>
<li>Three recent works by Pantaleoni [2017], Otsu et al. [2017], and Bitterli et al. [2017] concurrently proposed techniques to combine the different state spaces by using an <strong>inverse mapping</strong> from the primary sample space to the path space.</li>
</ul>
</li>
</ul>
<h2 id="2-3-Path-Space-Perturbations"><a href="#2-3-Path-Space-Perturbations" class="headerlink" title="2.3 Path Space Perturbations"></a>2.3 Path Space Perturbations</h2><ul>
<li>Our geometry-aware mutation technique is based on the <strong>lens</strong>, <strong>caustic</strong>, and <strong>multi-chain perturbations operating</strong> in the path space [Veach and Guibas 1997].</li>
<li>对于一条 subpath，我们对其的扰动为改变它的出射方向（<strong>局部球面坐标系</strong>）<ul>
<li>例如扰动从 lens 出发的 subpath，我们改变其出射方向，追踪这条光线，直到停在 diffuse 的表面</li>
</ul>
</li>
</ul>
<img src="geomlt/image-20220213095748652.png" style="zoom:80%;" />

<ul>
<li>以出射方向为<strong>上方向</strong>，$\theta$ 指数分布，$\phi$ 均匀分布<ul>
<li>Veach and Guibas [1997]</li>
</ul>
</li>
</ul>
<img src="geomlt/image-20220213101711000.png" style="zoom:80%;" />

<ul>
<li>采样得到的 $\theta\in[r_{\min},r_{\max}]$</li>
<li>$U$：$[0,1]$ 均匀分布</li>
<li>推导得到 pdf 如下</li>
</ul>
<img src="geomlt/image-20220213102115165.png" style="zoom:80%;" />

<ul>
<li>如何设置步长（也就是设置 $r_{\max},r_{\min}$）对于渲染结果影响很大<ul>
<li>自相关性 vs 收敛速度</li>
</ul>
</li>
</ul>
<h2 id="2-4-Adaptive-Step-Sizes"><a href="#2-4-Adaptive-Step-Sizes" class="headerlink" title="2.4 Adaptive Step Sizes"></a>2.4 Adaptive Step Sizes</h2><ul>
<li>有些研究根据目标函数的某些特征实现可适应步长<ul>
<li>Li et al. [2015] utilized local information obtained from <strong>analytic derivatives</strong> to adaptively control the shape of the transition kernels based the idea of <strong>Hamiltonian Monte Carlo</strong> [Duane et al. 1987].</li>
<li>Jakob and Marschner [2012]<ul>
<li>specular 表面，将路径空间限制在低维度中</li>
</ul>
</li>
<li>Kaplanyan et al. [2014] and Hanika et al. [2015]<ul>
<li>泛化上面的方法，使用半角向量表示路径空间</li>
</ul>
</li>
</ul>
</li>
<li>之前的方法都没有考虑可见性的问题，因为可见性函数的微分包含狄拉克函数成分 $Dirac$</li>
</ul>
<h2 id="2-5-Cones-in-Rendering"><a href="#2-5-Cones-in-Rendering" class="headerlink" title="2.5 Cones in Rendering"></a>2.5 Cones in Rendering</h2><ul>
<li>Cone tracing [Amanatides 1984]<ul>
<li>使用 cone 代替了 ray 和场景求交</li>
<li>有效的实现了 AA</li>
</ul>
</li>
<li>Roger et al. [2007]<ul>
<li><strong>使用 cone 表示一组 ray，从而实现了一组相关的光线和场景的快速求交</strong><ul>
<li><strong><span style="color:red">可能有用</span></strong></li>
</ul>
</li>
</ul>
</li>
<li>Mora [2011]<ul>
<li>utilized <strong>cones as ray packets</strong> in the context of <strong>divide-and-conquer ray tracing</strong>.</li>
</ul>
</li>
<li>Crassin et al. [2011]<ul>
<li><strong>voxelized</strong> scene geometries</li>
</ul>
</li>
<li>我们在一条出射光线的周围放置一个 cone，找到最大的不和场景相交的 cone</li>
</ul>
<h1 id="3-OVERVIEW"><a href="#3-OVERVIEW" class="headerlink" title="3 OVERVIEW"></a>3 OVERVIEW</h1><ul>
<li>3 个问题<ul>
<li>如何找到最大的张角？</li>
<li>如何加速？</li>
<li>如何集成到 MLT 中？</li>
</ul>
</li>
</ul>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><ul>
<li>引导性的例子 MLT vs GeoMLT（场景与测试结果）</li>
</ul>
<img src="geomlt/image-20220213111443167.png" style="zoom:80%;" />

<img src="geomlt/image-20220213112055131.png" style="zoom:80%;" />

<ul>
<li>如上，<strong>黑点</strong>表示被拒绝的样本，<strong>橙点</strong>表示接受的样本</li>
<li>限制路径长度为 1，<strong>被拒绝的原因只有可见性</strong></li>
<li>上面的图示表示 GeoMLT 的适应性步长有比较好的效果</li>
</ul>
<h1 id="4-GEOMETRY-AWARE-PERTURBATION-SIZE"><a href="#4-GEOMETRY-AWARE-PERTURBATION-SIZE" class="headerlink" title="4 GEOMETRY-AWARE PERTURBATION SIZE"></a>4 GEOMETRY-AWARE PERTURBATION SIZE</h1><ul>
<li>让变异范围内的光线都不会因为可见性原因而被拒绝</li>
<li>如何计算 cone 的最大张角 $r_{\max}$<ul>
<li>通过用户定义的一个参数 $\alpha$ 求得 $r_{\min}&#x3D;\alpha r_{\max}$</li>
</ul>
</li>
<li>path segment：$\mathrm{x}_1\mathrm{x}_2$</li>
<li>点 $\mathrm{x}_1$ 不动，扰动出射方向</li>
</ul>
<h2 id="truncated-cone"><a href="#truncated-cone" class="headerlink" title="truncated cone"></a>truncated cone</h2><ul>
<li>引入 truncated cone 的概念</li>
</ul>
<img src="geomlt/image-20220213114638556.png" style="zoom:80%;" />

<ul>
<li>两个截断平面<ul>
<li>避免自相交、和点 $\mathrm{x}_2$ 比较近的几何体的相交</li>
<li>The truncation of the cone’s apex and the base is used to avoid <strong>self-intersections close to $\mathrm{x}_1$</strong> and to avoid <strong>unnecessary small cone angles due to geometry close to $\mathrm{x}_2$</strong></li>
</ul>
</li>
</ul>
<img src="geomlt/image-20220213120522157.png" style="zoom:80%;" />

<ul>
<li>$t_2$ 截断平面不一定和圆锥的轴垂直<ul>
<li>更好的考虑倾斜的几何体</li>
<li>使用交点 $\mathrm{x}_2$ 的法线作为平面的法线</li>
</ul>
</li>
<li>$t_1$ 需要垂直</li>
<li>$\mathcal{C}(\theta)$：所有在上面的 truncated cone 之间的点的集合</li>
<li>场景表面集合：$\mathcal{M}$</li>
<li>则最大的张角如下</li>
</ul>
<p>$$<br>\theta_{\max}&#x3D;\sup{\theta\vert\mathcal{M}\cap\mathcal{C}(\theta)&#x3D;\emptyset}<br>$$</p>
<ul>
<li>准确计算十分耗时<ul>
<li>一种方法是二分的进行 cone-scene intersection test</li>
</ul>
</li>
</ul>
<h1 id="5-APPROXIMATE-CONE-ANGLE"><a href="#5-APPROXIMATE-CONE-ANGLE" class="headerlink" title="5. APPROXIMATE CONE ANGLE"></a>5. APPROXIMATE CONE ANGLE</h1><ul>
<li>粗略估计</li>
<li>使用 AABB 包围盒代替几何体进行 $\theta_{\max}$ 的计算</li>
</ul>
<h2 id="5-1-Estimating-the-Cone-Angle-for-a-Single-AABB"><a href="#5-1-Estimating-the-Cone-Angle-for-a-Single-AABB" class="headerlink" title="5.1 Estimating the Cone Angle for a Single AABB"></a>5.1 Estimating the Cone Angle for a Single AABB</h2><ul>
<li>计算一个 path segment 和一个 AABB 的 $\theta_{\max}$</li>
<li>求出相交的最小夹角，<strong>算法</strong>如下<ul>
<li>如果某个顶点 $\mathrm{p}_i$ 在 $[t_1,t_2]$ 之间，计算夹角 $\langle \mathrm{x}_1\mathrm{p}_i,\mathrm{x}_1\mathrm{x}_2\rangle$</li>
<li>对于 AABB 的每一条边，我们求出到 $\mathrm{x}_1\mathrm{x}_2$ 最近的点，如果这个点落在 $[t_1,t_2]$ 之间，用它更新夹角</li>
<li>$t_2$ 平面和 AABB 求交（得到一个凸多边形），求这个凸多边形到 $\mathrm{x}_1\mathrm{x}_2$ 最近的点，更新夹角</li>
</ul>
</li>
<li>如下图<ul>
<li>$\mathrm{p}_1,\mathrm{p}_2$ 的投影在区间 $[t_1,t_2]$ 内部，需要考虑</li>
<li>$\mathrm{p}_3,\mathrm{p}_4$ 的投影在区间 $[t_1,t_2]$ 外部，不需要考虑</li>
</ul>
</li>
</ul>
<img src="geomlt/image-20220213142936290.png" style="zoom:80%;" />



<h2 id="5-2-Cone-Estimation-using-a-BVH-Cut"><a href="#5-2-Cone-Estimation-using-a-BVH-Cut" class="headerlink" title="5.2 Cone Estimation using a BVH-Cut"></a>5.2 Cone Estimation using a BVH-Cut</h2><ul>
<li>首先计算 initial cut，里面包含如下的结点<ul>
<li>他们的父结点和 $\mathrm{x}_1\mathrm{x}_2$ 相交，但是他自己没有和 $\mathrm{x}_1\mathrm{x}_2$ 相交</li>
<li>如下的红色结点</li>
</ul>
</li>
</ul>
<img src="geomlt/image-20220213150615178.png" style="zoom:80%;" />

<ul>
<li>实现如下</li>
</ul>
<img src="geomlt/image-20220213150741855.png" style="zoom:80%;" />

<ul>
<li>此时 initial cut 里面包含着一堆绕着 $\mathrm{x}_1\mathrm{x}_2$ 的 AABB，但是他们都不和 $\mathrm{x}_1\mathrm{x}_2$ 相交</li>
<li>这也可以避免角度变成 0（和空的 AABB 相交）<ul>
<li>会被排除</li>
</ul>
</li>
<li>此时可以使用 5.1 的方法对每一个 AABB 进行求解<ul>
<li>如此得到的 $\theta_{\max}$ 总是会偏小</li>
</ul>
</li>
</ul>
<img src="geomlt/image-20220213151753388.png" style="zoom:80%;" />

<ul>
<li>优化策略：将所有的 AABB 展开，直到结点个数达到设定值 $N_{\max}$<ul>
<li>优先队列 $Q$，夹角最小的在根结点</li>
</ul>
</li>
</ul>
<img src="geomlt/image-20220213161002331.png" style="zoom:80%;" />

<ul>
<li>展开每个结点，直到限制夹角的结点为叶子结点（此时已经是最大）或者达到数量限制（考虑效率）</li>
</ul>
<h2 id="5-3-Trading-Accuracy-for-Speed"><a href="#5-3-Trading-Accuracy-for-Speed" class="headerlink" title="5.3 Trading Accuracy for Speed"></a>5.3 Trading Accuracy for Speed</h2><ul>
<li>更快但是牺牲了准确率</li>
<li>一种策略：只进行 5.1 部分的第一个测试（<strong>顶点</strong>），而且不进行 cut refinement</li>
</ul>
<h1 id="6-GEOMETRY-AWARE-METROPOLIS-LIGHT-TRANSPORT"><a href="#6-GEOMETRY-AWARE-METROPOLIS-LIGHT-TRANSPORT" class="headerlink" title="6. GEOMETRY-AWARE METROPOLIS LIGHT TRANSPORT"></a>6. GEOMETRY-AWARE METROPOLIS LIGHT TRANSPORT</h1><ul>
<li>扰动策略<ul>
<li>a geometry-aware extension of the <strong>multi-chain perturbation</strong></li>
</ul>
</li>
<li>可以类似的迁移到其他的扰动策略上<ul>
<li>lens or caustic perturbation</li>
</ul>
</li>
</ul>
<h2 id="变异策略-1"><a href="#变异策略-1" class="headerlink" title="变异策略"></a>变异策略</h2><ul>
<li>当前路径：$\bar{x}&#x3D;\mathrm{x}_1\mathrm{x}_2\cdots\mathrm{x}_k$</li>
<li>依次对这样的 path segment 进行扰动，直到遇见两个连续的非镜面顶点<ul>
<li>$\mathrm{x}<em>i\mathrm{x}</em>{i+1}$：出发自非镜面，终止在镜面</li>
<li>突变从 $\mathrm{x}_k$ （光圈）开始，突变策略就是上面讲的</li>
<li>保证结点的表面类型、结点数量不变</li>
<li>结果为 $\bar{y}&#x3D;\mathrm{x}_1\mathrm{x}_2\cdots\mathrm{x}<em>s\mathrm{y}</em>{s+1}\cdots\mathrm{y}_k$</li>
</ul>
</li>
<li>优化<ul>
<li>如果 $\mathrm{x}<em>{i+1}$ 是非镜面或者光圈，我们扰动原始的方向（$\omega_0&#x3D;\mathrm{x}</em>{i+1}\to\mathrm{x}_i$），此时下一个顶点 $\mathrm{y}<em>i$ 通过朝着新的方向 $\omega$ 射出一条光线计算得到，不使用方向 $\mathrm{y}</em>{i+1}\to\mathrm{x}_i$，因为这样在计算接受率的时候需要额外对这段路径进行可见性测试</li>
<li>如果 $\mathrm{x}_{i+1}$ 是镜面，则根据确定的方向计算得到 $\mathrm{y}_i$</li>
</ul>
</li>
</ul>
<h2 id="计算接收率"><a href="#计算接收率" class="headerlink" title="计算接收率"></a>计算接收率</h2><ul>
<li>化简，消去公共项（前面一段相同）</li>
</ul>
<img src="geomlt/image-20220213190644235.png" style="zoom:80%;" />

<img src="geomlt/image-20220213190723401.png" style="zoom:80%;" />

<ul>
<li>只需要计算不同的项</li>
</ul>
<img src="geomlt/image-20220213191100768.png" style="zoom:80%;" />



<h1 id="7-RESULTS"><a href="#7-RESULTS" class="headerlink" title="7. RESULTS"></a>7. RESULTS</h1><ul>
<li>MLT：$r_{\max}&#x3D;0.5,r_{\min}&#x3D;0.05$</li>
<li>GeoMLT：$N_{\max}&#x3D;10,\alpha&#x3D;0.1$</li>
<li>算法<ul>
<li>the bidirectional mutation for global exploration</li>
<li>and the multi-chain perturbations for local exploration with equal selection probability.</li>
</ul>
</li>
</ul>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><ul>
<li><p>Clamping the Estimated Cone Angle</p>
<ul>
<li>如果光线掠过一个几何体的表面，可能会导致计算得到的 $\theta$ 很小（几乎为 0），我们将计算得到的 $\theta$ clamp 到用户指定的范围内</li>
<li>实验为 $[0.01,0.5]$</li>
</ul>
</li>
<li><p>Avoiding Unnecessary Cone Angle Underestimation</p>
<ul>
<li>$t_2$ 设置得距离 $\mathrm{x}_2$ 不能太近</li>
<li>实验：$t_1&#x3D;10^{-4},t_2&#x3D;0.99\Vert\mathrm{x}_1-\mathrm{x_2}\Vert$</li>
</ul>
</li>
<li><p>Equal-Time Comparisons</p>
<ul>
<li>我们的方法不对出发于镜面的顶点进行估计，因此在这种情况下会有问题</li>
</ul>
</li>
<li><p>Accuracy of the BVHCut Approximation</p>
<ul>
<li>BVHcut 估计的顶角范围基本准确</li>
<li>算法能够适应不同场景（场景旋转不同角度，AABB 改变）</li>
</ul>
</li>
<li><p>Quality of Exploration</p>
<ul>
<li>评估：$\text{MCMC-SE}&#x3D;\sqrt{\dfrac{\text{Var}}{\text{ESS}}}$</li>
</ul>
</li>
</ul>
<img src="geomlt/image-20220213194431214.png" style="zoom:80%;" />

<ul>
<li>Differently-Sized Geometry<ul>
<li>场景中同时有不同尺度的几何体</li>
<li>树干和树枝</li>
<li>背景中含有一个很大的 diffuse reflector 时，我们看到 GeoMLT 增益不大<ul>
<li>因为可以跳过这个遮挡的树枝，从另外的一个间隙中过来，因此 $\theta$ 之外其实也还有很多可行的光路</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="8-DISCUSSION"><a href="#8-DISCUSSION" class="headerlink" title="8. DISCUSSION"></a>8. DISCUSSION</h1><ul>
<li>Parameters<ul>
<li>有些人为设置的参数，会影响渲染结果</li>
</ul>
</li>
<li>Cone Angle Estimation<ul>
<li>BVHCut：相对精确</li>
<li>FastApprox：很宽松</li>
<li>更好的方法：TODO</li>
</ul>
</li>
<li>Limitations<ul>
<li>两个顶点都是镜面材质</li>
<li>不连续结构</li>
<li>最大张角很大（大于等于人为设置的最大值），此时 BVHCut 白做了</li>
</ul>
</li>
<li>Reusing Acceleration Structure<ul>
<li>同时进行，方便</li>
</ul>
</li>
<li>Future work<ul>
<li>各向异性的 cone</li>
<li>现在只支持表面渲染，推广到参与介质的渲染（participating media）</li>
<li>designing geometry-aware mutations in primary sample space</li>
</ul>
</li>
</ul>
<h1 id="9-CONCLUSION"><a href="#9-CONCLUSION" class="headerlink" title="9. CONCLUSION"></a>9. CONCLUSION</h1><ul>
<li>We presented a mutation strategy which adaptively changes the mutation step size according to the geometry of the scene. Our method restricts perturbations of path segments such that nearby geometry is not intersected, as this would always result in rejected proposals. We introduced fast, approximate algorithms to estimate the maximum perturbation angle, which reuse the very same acceleration structure which is already present for ray casting.We demonstrated that our approach can greatly improve the exploration performance of a Markov chain. Our perturbation strategy has been designed with small geometric features in mind, such as door slits or keyholes where the light shines through. However, as our results show, it also reduces noise near geometric edges, such as the one between the floor and the back wall in the Ajar door scene. We believe that using information about geometric visibility has great potential and can be used to ameliorate many other cases of inefficient mutations due to geometric constraints.</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/02/08/CG/Papers/2018/geomlt/" data-id="cl9lj74bv00m664tz45gv6r16" data-title="(论文)[2018] Geometry-Aware Metropolis Light Transport" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CG/" rel="tag">CG</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Paper/" rel="tag">Paper</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/occlusion/" rel="tag">occlusion</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/26/">26</a><a class="extend next" rel="next" href="/page/4/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/0/">0</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Algebra/">Algebra</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/C-Kits/">C++.Kits</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG/">CG</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-Algorithm/">CG.Algorithm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-GAMES101/">CG.GAMES101</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-GAMES102/">CG.GAMES102</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-GAMES103/">CG.GAMES103</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-GAMES104/">CG.GAMES104</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-GAMES202/">CG.GAMES202</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-GAMES203/">CG.GAMES203</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-Kits/">CG.Kits</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-LS/">CG.LS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-PBRT/">CG.PBRT</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CG-Paper/">CG.Paper</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CV/">CV</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Code/">Code</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/DB-CLJ/">DB.CLJ</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/DB-MySQL/">DB.MySQL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/DB-SQLServer/">DB.SQLServer</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/DSA/">DSA</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kits/">Kits</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Math/">Math</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/OS-CXQ/">OS.CXQ</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/OS-OSTEP/">OS.OSTEP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/OS-xv6-labs/">OS.xv6-labs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/OS-xv6-source-code/">OS.xv6-source-code</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/TODO/">TODO</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/book-directory/">book.directory</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/computation-pyr/">computation.pyr</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/csharp-kits/">csharp.kits</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/csharp-tds/">csharp.tds</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/images/">images</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/installation/">installation</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mitsuba/">mitsuba</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/nothing/">nothing</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/software-Maya/">software.Maya</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/software-ps/">software.ps</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/software-vscode/">software.vscode</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/win/">win</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algebra/" rel="tag">Algebra</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BFS/" rel="tag">BFS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BST/" rel="tag">BST</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BVH/" rel="tag">BVH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CG/" rel="tag">CG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CG-Algorithm/" rel="tag">CG-Algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CV/" rel="tag">CV</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Code/" rel="tag">Code</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DB/" rel="tag">DB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DFS/" rel="tag">DFS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DP/" rel="tag">DP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DSA/" rel="tag">DSA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dijkstra/" rel="tag">Dijkstra</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EG/" rel="tag">EG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Floyd/" rel="tag">Floyd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GI/" rel="tag">GI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Glints/" rel="tag">Glints</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HDR/" rel="tag">HDR</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HQX/" rel="tag">HQX</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Heap/" rel="tag">Heap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kits/" rel="tag">Kits</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LCA/" rel="tag">LCA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LLG/" rel="tag">LLG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MCMC/" rel="tag">MCMC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MIS/" rel="tag">MIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MLT/" rel="tag">MLT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Maya/" rel="tag">Maya</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NEE/" rel="tag">NEE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OS/" rel="tag">OS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PBRT/" rel="tag">PBRT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Paper/" rel="tag">Paper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Radiometry/" rel="tag">Radiometry</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RayTracing/" rel="tag">RayTracing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SAH/" rel="tag">SAH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SDF/" rel="tag">SDF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SGJ/" rel="tag">SGJ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/" rel="tag">SQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQLServer/" rel="tag">SQLServer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/STL/" rel="tag">STL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Shadow/" rel="tag">Shadow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WHM/" rel="tag">WHM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WX/" rel="tag">WX</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/YLQ/" rel="tag">YLQ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/book/" rel="tag">book</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/computation/" rel="tag">computation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/csharp/" rel="tag">csharp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/images/" rel="tag">images</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/installation/" rel="tag">installation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/" rel="tag">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/" rel="tag">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mitsuba/" rel="tag">mitsuba</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mobaxterm/" rel="tag">mobaxterm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nothing/" rel="tag">nothing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/obs/" rel="tag">obs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/occlusion/" rel="tag">occlusion</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ps/" rel="tag">ps</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/software/" rel="tag">software</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/test/" rel="tag">test</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tree/" rel="tag">tree</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vscode/" rel="tag">vscode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/win/" rel="tag">win</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xv6/" rel="tag">xv6</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%8C%E5%88%86/" rel="tag">二分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%83%E5%AE%87%E5%AE%99/" rel="tag">元宇宙</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%87%A0%E4%BD%95/" rel="tag">几何</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8F%AF%E8%A7%81%E6%80%A7/" rel="tag">可见性</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%B6%E6%9F%A5%E9%9B%86/" rel="tag">并查集</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/" rel="tag">拓扑排序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8E%92%E5%BA%8F/" rel="tag">排序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%99%AE%E5%90%95%E5%85%8B%E5%9D%90%E6%A0%87/" rel="tag">普吕克坐标</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/" rel="tag">最小生成树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF/" rel="tag">最短路</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/" rel="tag">线段树</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Algebra/" style="font-size: 10px;">Algebra</a> <a href="/tags/BFS/" style="font-size: 10px;">BFS</a> <a href="/tags/BST/" style="font-size: 10px;">BST</a> <a href="/tags/BVH/" style="font-size: 12.5px;">BVH</a> <a href="/tags/C/" style="font-size: 10px;">C++</a> <a href="/tags/CG/" style="font-size: 20px;">CG</a> <a href="/tags/CG-Algorithm/" style="font-size: 10px;">CG-Algorithm</a> <a href="/tags/CV/" style="font-size: 10.63px;">CV</a> <a href="/tags/Code/" style="font-size: 14.38px;">Code</a> <a href="/tags/DB/" style="font-size: 19.38px;">DB</a> <a href="/tags/DFS/" style="font-size: 12.5px;">DFS</a> <a href="/tags/DP/" style="font-size: 13.13px;">DP</a> <a href="/tags/DSA/" style="font-size: 11.25px;">DSA</a> <a href="/tags/Dijkstra/" style="font-size: 10px;">Dijkstra</a> <a href="/tags/EG/" style="font-size: 12.5px;">EG</a> <a href="/tags/Floyd/" style="font-size: 10.63px;">Floyd</a> <a href="/tags/GI/" style="font-size: 11.25px;">GI</a> <a href="/tags/Glints/" style="font-size: 10px;">Glints</a> <a href="/tags/HDR/" style="font-size: 10px;">HDR</a> <a href="/tags/HQX/" style="font-size: 10px;">HQX</a> <a href="/tags/Heap/" style="font-size: 10px;">Heap</a> <a href="/tags/Kits/" style="font-size: 13.75px;">Kits</a> <a href="/tags/LCA/" style="font-size: 10px;">LCA</a> <a href="/tags/LLG/" style="font-size: 12.5px;">LLG</a> <a href="/tags/MCMC/" style="font-size: 10.63px;">MCMC</a> <a href="/tags/MIS/" style="font-size: 10px;">MIS</a> <a href="/tags/MLT/" style="font-size: 10px;">MLT</a> <a href="/tags/Maya/" style="font-size: 10px;">Maya</a> <a href="/tags/MySQL/" style="font-size: 11.88px;">MySQL</a> <a href="/tags/NEE/" style="font-size: 10px;">NEE</a> <a href="/tags/OS/" style="font-size: 17.5px;">OS</a> <a href="/tags/PBRT/" style="font-size: 10px;">PBRT</a> <a href="/tags/Paper/" style="font-size: 15.63px;">Paper</a> <a href="/tags/Radiometry/" style="font-size: 10px;">Radiometry</a> <a href="/tags/RayTracing/" style="font-size: 10px;">RayTracing</a> <a href="/tags/SAH/" style="font-size: 10px;">SAH</a> <a href="/tags/SDF/" style="font-size: 10px;">SDF</a> <a href="/tags/SGJ/" style="font-size: 10.63px;">SGJ</a> <a href="/tags/SQL/" style="font-size: 13.13px;">SQL</a> <a href="/tags/SQLServer/" style="font-size: 10.63px;">SQLServer</a> <a href="/tags/STL/" style="font-size: 11.25px;">STL</a> <a href="/tags/Shadow/" style="font-size: 10px;">Shadow</a> <a href="/tags/WHM/" style="font-size: 16.88px;">WHM</a> <a href="/tags/WX/" style="font-size: 11.88px;">WX</a> <a href="/tags/YLQ/" style="font-size: 18.13px;">YLQ</a> <a href="/tags/book/" style="font-size: 10.63px;">book</a> <a href="/tags/computation/" style="font-size: 18.75px;">computation</a> <a href="/tags/csharp/" style="font-size: 16.25px;">csharp</a> <a href="/tags/images/" style="font-size: 10px;">images</a> <a href="/tags/installation/" style="font-size: 11.88px;">installation</a> <a href="/tags/js/" style="font-size: 10px;">js</a> <a href="/tags/linux/" style="font-size: 11.25px;">linux</a> <a href="/tags/math/" style="font-size: 10px;">math</a> <a href="/tags/mitsuba/" style="font-size: 11.88px;">mitsuba</a> <a href="/tags/mobaxterm/" style="font-size: 10px;">mobaxterm</a> <a href="/tags/nothing/" style="font-size: 10.63px;">nothing</a> <a href="/tags/obs/" style="font-size: 10px;">obs</a> <a href="/tags/occlusion/" style="font-size: 15px;">occlusion</a> <a href="/tags/ps/" style="font-size: 10px;">ps</a> <a href="/tags/software/" style="font-size: 10px;">software</a> <a href="/tags/test/" style="font-size: 10px;">test</a> <a href="/tags/tree/" style="font-size: 11.25px;">tree</a> <a href="/tags/vscode/" style="font-size: 10.63px;">vscode</a> <a href="/tags/win/" style="font-size: 10.63px;">win</a> <a href="/tags/xv6/" style="font-size: 16.25px;">xv6</a> <a href="/tags/%E4%BA%8C%E5%88%86/" style="font-size: 10.63px;">二分</a> <a href="/tags/%E5%85%83%E5%AE%87%E5%AE%99/" style="font-size: 10.63px;">元宇宙</a> <a href="/tags/%E5%87%A0%E4%BD%95/" style="font-size: 10px;">几何</a> <a href="/tags/%E5%8F%AF%E8%A7%81%E6%80%A7/" style="font-size: 11.88px;">可见性</a> <a href="/tags/%E5%B9%B6%E6%9F%A5%E9%9B%86/" style="font-size: 10.63px;">并查集</a> <a href="/tags/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/" style="font-size: 10px;">拓扑排序</a> <a href="/tags/%E6%8E%92%E5%BA%8F/" style="font-size: 10px;">排序</a> <a href="/tags/%E6%99%AE%E5%90%95%E5%85%8B%E5%9D%90%E6%A0%87/" style="font-size: 10px;">普吕克坐标</a> <a href="/tags/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/" style="font-size: 10px;">最小生成树</a> <a href="/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF/" style="font-size: 13.13px;">最短路</a> <a href="/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/" style="font-size: 10px;">线段树</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/10/23/CG/WHM-GAMES103/11/">GAMES103.王华民.11.Incompressible Fluid Dynamics and Eulerian Fluids</a>
          </li>
        
          <li>
            <a href="/2022/10/23/CG/Papers/2021/bvh-survey-3/">(论文)[2021] A Survey on Bounding Volume Hierarchies for Ray Tracing(4)</a>
          </li>
        
          <li>
            <a href="/2022/04/28/CG/Kits/MIS-NEE/">NEE、MIS(多重重要性采样)</a>
          </li>
        
          <li>
            <a href="/2022/04/18/CG/WHM-GAMES103/10/">GAMES103.王华民.10.Surface Waves</a>
          </li>
        
          <li>
            <a href="/2022/04/17/CG/WHM-GAMES103/09-1/">GAMES103.王华民.09.Collision Handling(1)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>