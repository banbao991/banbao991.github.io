<svg width="600" height="400" xmlns="http://www.w3.org/2000/svg">
  <!-- 标题 -->
  <text x="50%" y="20" text-anchor="middle" font-size="20" font-family="Arial">Policy Gradient Training Loop</text>

  <!-- 步骤1 -->
  <rect x="50" y="50" width="200" height="50" fill="lightblue" />
  <text x="125" y="80" text-anchor="middle" font-size="16" font-family="Arial">Collect an Episode</text>

  <!-- 步骤2 -->
  <rect x="50" y="120" width="200" height="50" fill="lightblue" />
  <text x="125" y="150" text-anchor="middle" font-size="16" font-family="Arial">Calculate the Return</text>

  <!-- 步骤3 -->
  <rect x="50" y="190" width="200" height="50" fill="lightblue" />
  <text x="125" y="220" text-anchor="middle" font-size="16" font-family="Arial">Update the Weights</text>

  <!-- 步骤3的子步骤 -->
  <rect x="50" y="260" width="200" height="50" fill="lightgray" />
  <text x="125" y="290" text-anchor="middle" font-size="14" font-family="Arial">If positive return → Increase</text>
  <rect x="50" y="320" width="200" height="50" fill="lightgray" />
  <text x="125" y="350" text-anchor="middle" font-size="14" font-family="Arial">If negative return → Decrease</text>

  <!-- 连接线 -->
  <line x1="250" y1="75" x2="300" y2="75" stroke="black" stroke-width="2" />
  <line x1="250" y1="145" x2="300" y2="145" stroke="black" stroke-width="2" />
  <line x1="250" y1="215" x2="300" y2="215" stroke="black" stroke-width="2" />
</svg>